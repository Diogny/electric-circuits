!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=47)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createClass=e.addClassX=e.union=e.unique=e.range=e.getParentAttr=e.condClass=e.toggleClass=e.removeClass=e.addClass=e.hasClass=e.aCld=e.dP=e.rEL=e.aEL=e.propDescriptor=e.attr=e.css=e.defEnum=e.clone=e.obj=e.pojo=e.isElement=e.inherit=e.copy=e.extend=e.splat=e.round=e.clamp=e.pInt=e.isInt=e.isNumeric=e.isNum=e.isArr=e.isObj=e.isStr=e.dfnd=e.isFn=e.typeOf=e.empty=e.ts=e.consts=void 0;var i={s:"string",o:"object",b:"boolean",i:"integer",n:"number",a:"array",fn:"function",sp:"super",c:"color",t:"type",d:"defaut",u:"undefined",v:"value",svgNs:"http://www.w3.org/2000/svg"};e.consts=i;var r=function(t){return{}.toString.call(t)};e.ts=r;var o=function(t){return null==typeof t||!t||a(t)&&null!==t.match(/^ *$/)};e.empty=o,e.typeOf=function(t){return r(t).slice(8,-1).toLowerCase()},e.isFn=function(t){return typeof t===i.fn};var s=function(t){return null!=t};e.dfnd=s;var a=function(t){return typeof t===i.s};e.isStr=a,e.isObj=function(t){return typeof t===i.o};var u=function(t){return Array.isArray(t)};e.isArr=u,e.isNum=function(t){return typeof t===i.n},e.isNumeric=function(t){return!isNaN(t)&&(0|(t=parseInt(t)))===t},e.isInt=function(t){return parseFloat(t)==parseInt(t)&&!isNaN(t)},e.pInt=function(t,e){return parseInt(t,e||10)},e.clamp=function(t,e,n){return t<=e?e:t>=n?n:t},e.round=function(t,e){return e|=0,Number(Math.round(Number(t+"e"+e))+"e-"+e)},e.splat=function(t){return u(t)?t:s(t)?[t]:[]},e.extend=function(t,e){
//!obj && (obj = {});
return c(e)&&Object.keys(e).forEach((function(n){t[n]=e[n]})),t},e.copy=function(t,e){return c(e)&&Object.keys(t).forEach((function(n){var i=e[n];s(i)&&(t[n]=i)})),t},e.inherit=function(t,e){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},e.isElement=function(t){return t instanceof Element||t instanceof HTMLDocument};var c=function(t){if(null==t||"object"!=typeof t)return!1;var e=Object.getPrototypeOf(t);return!e||"Object"===e.constructor.name};e.pojo=c;var p=function(t){if(!c(t))return t;var e=Object.create(null);for(var n in t)if(!t.hasOwnProperty||t.hasOwnProperty(n)){var i=t[n];e[n]=c(i)?p(i):i}return e};e.obj=p,e.clone=function(t){return JSON.parse(JSON.stringify(t))},e.defEnum=function(t){for(var e in t)t[t[e]]=e;return t},e.css=function(t,e){if(a(e))return t.style[e];for(var n in e)t.style[n]=e[n];return t},e.attr=function(t,e){if(a(e))return t.getAttribute(e);for(var n in e)t.setAttribute(n,e[n]);return t},e.propDescriptor=function(t,e){var n;do{n=Object.getOwnPropertyDescriptor(t,e)}while(!n&&(t=Object.getPrototypeOf(t)));return n},e.aEL=function(t,e,n,i){return t.addEventListener(e,n,i)},e.rEL=function(t,e,n,i){return t.removeEventListener(e,n,i)},e.dP=function(t,e,n){return Object.defineProperty(t,e,n)},e.aCld=function(t,e){return t.appendChild(e)},e.hasClass=function(t,e){return t.classList.contains(e)};var h=function(t,e){return t.classList.add(e)};e.addClass=h;var l=function(t,e){return t.classList.remove(e)};e.removeClass=l,e.toggleClass=function(t,e){return t.classList.toggle(e)},e.condClass=function(t,e,n){return n&&(h(t,e),1)||l(t,e)},e.getParentAttr=function(t,e){for(;t&&!t.hasAttribute(e);)t=t.parentElement;return t},e.range=function(t,e){return Array.from("x".repeat(e-t),(function(e,n){return t+n}))};var d=function(t){return t.filter((function(e,n){return t.indexOf(e)===n}))};e.unique=d;var f=function(t,e){return d(t.concat(e))};e.union=f,e.addClassX=function(t,e){var n;return(n=t.classList).add.apply(n,(e||"").split(" ").filter((function(t){return!o(t)}))),t},e.createClass=function(t,e){var n=function(t){return t.split(" ")},i=n(t||""),r=n(e||"");return f(i,r).join(" ")}},function(t,e){(function(){t.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.basePath=e.gEId=e.qSA=e.qS=e.ready=e.prop=e.filterArray=e.filter=e.map=e.each=e.html=e.svg=e.tag=e.pad=e.exec=e.templatesDOM=e.templatesUrl=void 0;var i=n(49),r=n(0);e.templatesUrl=function(t,n){return i.default.get(t,n||{responseType:"json"}).then((function(t){var n,i=/<script.*?id\s*=\s*['"]([^'|^"]*)['"].*?>([\s\S]*?)<\/script>/gim,o={};if(r.isObj(t))e.each(t.result,(function(t,e){o[e]=function(t,e){var n=/<script[^\>]*>([\s\S]*?)<\/script>/gi.exec(e);return n?n[1].replace(/\r|\n/g,"").trim():""}(0,t.text)}));else for(;n=i.exec(t);)o[n[1]]=n[2].replace(/\r|\n/g,"").trim();return o}))},e.templatesDOM=function(t){return new Promise((function(e,n){var i={};(Array.isArray(t)?t:t.split("|")).forEach((function(t){var e=o("#"+t),n=e?e.innerHTML.replace(/\r|\n/g,"").trim():void 0;e&&(i[t]=n)})),e(i)}))},e.exec=function(t,e){var n={};try{n.result=t()}catch(t){n.error=t,r.isFn(e)&&e(n)}return n},e.pad=function(t,e,n){return new Array((e||2)+1-String(t).length).join(n||"0")+t},e.tag=function(t,e,n){return e&&(n.id=e),r.attr(document.createElementNS(r.consts.svgNs,t),n)},e.svg=function(t){var e=document.createElementNS(r.consts.svgNs,"template");return e.innerHTML=t,e.children[0]},e.html=function(t){var e=document.createElement("template");return e.innerHTML=t,e.content.firstChild},e.each=function(t,e){if(r.isFn(e)&&t){var n=0;for(var i in t)t.hasOwnProperty&&!t.hasOwnProperty(i)||e(t[i],i,n++)}},e.map=function(t,n){var i=[];return e.each(t,(function(t,e,r){i.push(n(t,e,r))})),i},e.filter=function(t,n){var i={};return e.each(t,(function(t,e,r){n(t,e,r)&&(i[e]=t)})),i},e.filterArray=function(t,n){var i=[];return e.each(t,(function(t,e,o){var s=n(t,e,o);!0===s?i.push(t):r.pojo(s)&&i.push(s)})),i},e.prop=function(t,e,n){for(var i,r=e.split(".").map((function(t){return t.trim()})),o=r.pop(),s=0;t&&s<r.length;s++)t=t[r[s]];return i=t&&o&&t[o],null==n?i:null!=i&&(t[o]=n,!0)},e.ready=function(t){return!!r.isFn(t)&&("loading"!=document.readyState?(t(),!0):(document.addEventListener?r.aEL(document,"DOMContentLoaded",t,!1):document.attachEvent("onreadystatechange",(function(){"complete"==document.readyState&&t()})),!0))};var o=function(t){return document.querySelector(t)};e.qS=o,e.qSA=function(t){return document.querySelectorAll(t)},e.gEId=function(t){return document.getElementById(t)},e.basePath=function(){var t=o('meta[name="base"]');return t?t.getAttribute("content"):""}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},t.prototype.add=function(t,e){return this.x+=Math.round(t),this.y+=Math.round(e),this},t.prototype.toString=function(t){var e=0!=(4&(t|=0)),n=0!=(2&t);return(n?"":"(")+(e?"":"x: ")+i.round(this.x,1)+", "+(e?"":"y: ")+i.round(this.y,1)+(n?"":")")},t.prototype.rotateBy=function(e,n,i){var r=Math.PI/180*i,o=Math.cos(r),s=Math.sin(r);return new t(o*(this.x-e)+s*(this.y-n)+e,o*(this.y-n)-s*(this.x-e)+n)},t.validateRotation=function(t){return(t=(0|t)%360)<0&&(t+=360),t},Object.defineProperty(t,"origin",{get:function(){return new t(0,0)},enumerable:!1,configurable:!0}),t.create=function(e){return new t(e.x,e.y)},t.parse=function(e){var n=e.split(",");if(2==n.length&&i.isNumeric(n[0])&&i.isNumeric(n[1]))return new t(parseInt(n[0]),parseInt(n[1]))},t.distance=function(t,e){return t.distance(e)},t.scale=function(e,n){return new t(n*e.x,n*e.y)},t.translateBy=function(e,n,i){return new t(e.x+n,e.y+i)},t.times=function(e,n,i){return new t(e.x*n,e.y*i)},t.minus=function(e,n){return new t(e.x-n.x,e.y-n.y)},t.plus=function(e,n){return new t(e.x+n.x,e.y+n.y)},t.inside=function(t,e){return t.x>=0&&t.x<=e.width&&t.y>=0&&t.y<=e.height},t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TypedClass=e.Type=void 0,function(t){t[t.UNDEFINED=0]="UNDEFINED",t[t.EC=1]="EC",t[t.WIRE=2]="WIRE",t[t.BOND=3]="BOND",t[t.LABEL=4]="LABEL",t[t.WIN=5]="WIN",t[t.TOOLTIP=6]="TOOLTIP",t[t.HIGHLIGHT=7]="HIGHLIGHT"}(e.Type||(e.Type={}));var i=function(){};e.TypedClass=i},function(t,e,n){(function(){var e,i,r,o,s,a,u,c,p,h,l,d,f,y,m,g,b,v={}.hasOwnProperty;b=n(6),g=b.isObject,m=b.isFunction,y=b.isEmpty,f=b.getValue,c=null,r=null,o=null,s=null,a=null,l=null,d=null,h=null,u=null,i=null,p=null,e=null,t.exports=function(){function t(t){this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,c||(c=n(19),r=n(21),o=n(22),s=n(23),a=n(24),l=n(29),d=n(30),h=n(31),u=n(43),i=n(1),p=n(72),n(20),e=n(73))}return Object.defineProperty(t.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new p(this.children)),this.childNodeList}}),Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(t.prototype,"previousSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t-1]||null}}),Object.defineProperty(t.prototype,"nextSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t+1]||null}}),Object.defineProperty(t.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(t.prototype,"textContent",{get:function(){var t,e,n,r,o;if(this.nodeType===i.Element||this.nodeType===i.DocumentFragment){for(o="",e=0,n=(r=this.children).length;e<n;e++)(t=r[e]).textContent&&(o+=t.textContent);return o}return null},set:function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),t.prototype.setParent=function(t){var e,n,i,r,o;for(this.parent=t,t&&(this.options=t.options,this.stringify=t.stringify),o=[],n=0,i=(r=this.children).length;n<i;n++)e=r[n],o.push(e.setParent(this));return o},t.prototype.element=function(t,e,n){var i,r,o,s,a,u,c,p,h,l,d;if(u=null,null===e&&null==n&&(e=(h=[{},null])[0],n=h[1]),null==e&&(e={}),e=f(e),g(e)||(n=(l=[e,n])[0],e=l[1]),null!=t&&(t=f(t)),Array.isArray(t))for(o=0,c=t.length;o<c;o++)r=t[o],u=this.element(r);else if(m(t))u=this.element(t.apply());else if(g(t)){for(a in t)if(v.call(t,a))if(d=t[a],m(d)&&(d=d.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===a.indexOf(this.stringify.convertAttKey))u=this.attribute(a.substr(this.stringify.convertAttKey.length),d);else if(!this.options.separateArrayItems&&Array.isArray(d)&&y(d))u=this.dummy();else if(g(d)&&y(d))u=this.element(a);else if(this.options.keepNullNodes||null!=d)if(!this.options.separateArrayItems&&Array.isArray(d))for(s=0,p=d.length;s<p;s++)r=d[s],(i={})[a]=r,u=this.element(i);else g(d)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?u=this.element(d):(u=this.element(a)).element(d):u=this.element(a,d);else u=this.dummy()}else u=this.options.keepNullNodes||null!==n?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===t.indexOf(this.stringify.convertTextKey)?this.text(n):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===t.indexOf(this.stringify.convertCDataKey)?this.cdata(n):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===t.indexOf(this.stringify.convertCommentKey)?this.comment(n):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===t.indexOf(this.stringify.convertRawKey)?this.raw(n):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===t.indexOf(this.stringify.convertPIKey)?this.instruction(t.substr(this.stringify.convertPIKey.length),n):this.node(t,e,n):this.dummy();if(null==u)throw new Error("Could not create any elements with: "+t+". "+this.debugInfo());return u},t.prototype.insertBefore=function(t,e,n){var i,r,o,s,a;if(null!=t?t.type:void 0)return s=e,(o=t).setParent(this),s?(r=children.indexOf(s),a=children.splice(r),children.push(o),Array.prototype.push.apply(children,a)):children.push(o),o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return r=this.parent.children.indexOf(this),a=this.parent.children.splice(r),i=this.parent.element(t,e,n),Array.prototype.push.apply(this.parent.children,a),i},t.prototype.insertAfter=function(t,e,n){var i,r,o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return r=this.parent.children.indexOf(this),o=this.parent.children.splice(r+1),i=this.parent.element(t,e,n),Array.prototype.push.apply(this.parent.children,o),i},t.prototype.remove=function(){var t;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return t=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[t,t-t+1].concat([])),this.parent},t.prototype.node=function(t,e,n){var i,r;return null!=t&&(t=f(t)),e||(e={}),e=f(e),g(e)||(n=(r=[e,n])[0],e=r[1]),i=new c(this,t,e),null!=n&&i.text(n),this.children.push(i),i},t.prototype.text=function(t){var e;return g(t)&&this.element(t),e=new d(this,t),this.children.push(e),this},t.prototype.cdata=function(t){var e;return e=new r(this,t),this.children.push(e),this},t.prototype.comment=function(t){var e;return e=new o(this,t),this.children.push(e),this},t.prototype.commentBefore=function(t){var e,n;return e=this.parent.children.indexOf(this),n=this.parent.children.splice(e),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,n),this},t.prototype.commentAfter=function(t){var e,n;return e=this.parent.children.indexOf(this),n=this.parent.children.splice(e+1),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,n),this},t.prototype.raw=function(t){var e;return e=new l(this,t),this.children.push(e),this},t.prototype.dummy=function(){return new u(this)},t.prototype.instruction=function(t,e){var n,i,r,o,s;if(null!=t&&(t=f(t)),null!=e&&(e=f(e)),Array.isArray(t))for(o=0,s=t.length;o<s;o++)n=t[o],this.instruction(n);else if(g(t))for(n in t)v.call(t,n)&&(i=t[n],this.instruction(n,i));else m(e)&&(e=e.apply()),r=new h(this,t,e),this.children.push(r);return this},t.prototype.instructionBefore=function(t,e){var n,i;return n=this.parent.children.indexOf(this),i=this.parent.children.splice(n),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.instructionAfter=function(t,e){var n,i;return n=this.parent.children.indexOf(this),i=this.parent.children.splice(n+1),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,i),this},t.prototype.declaration=function(t,e,n){var r,o;return r=this.document(),o=new s(r,t,e,n),0===r.children.length?r.children.unshift(o):r.children[0].type===i.Declaration?r.children[0]=o:r.children.unshift(o),r.root()||r},t.prototype.dtd=function(t,e){var n,r,o,s,u,c,p,h,l;for(n=this.document(),r=new a(n,t,e),o=s=0,c=(h=n.children).length;s<c;o=++s)if(h[o].type===i.DocType)return n.children[o]=r,r;for(o=u=0,p=(l=n.children).length;u<p;o=++u)if(l[o].isRoot)return n.children.splice(o,0,r),r;return n.children.push(r),r},t.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},t.prototype.root=function(){var t;for(t=this;t;){if(t.type===i.Document)return t.rootObject;if(t.isRoot)return t;t=t.parent}},t.prototype.document=function(){var t;for(t=this;t;){if(t.type===i.Document)return t;t=t.parent}},t.prototype.end=function(t){return this.document().end(t)},t.prototype.prev=function(){var t;if((t=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[t-1]},t.prototype.next=function(){var t;if(-1===(t=this.parent.children.indexOf(this))||t===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[t+1]},t.prototype.importDocument=function(t){var e;return(e=t.root().clone()).parent=this,e.isRoot=!1,this.children.push(e),this},t.prototype.debugInfo=function(t){var e,n;return null!=(t=t||this.name)||(null!=(e=this.parent)?e.name:void 0)?null==t?"parent: <"+this.parent.name+">":(null!=(n=this.parent)?n.name:void 0)?"node: <"+t+">, parent: <"+this.parent.name+">":"node: <"+t+">":""},t.prototype.ele=function(t,e,n){return this.element(t,e,n)},t.prototype.nod=function(t,e,n){return this.node(t,e,n)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.doc=function(){return this.document()},t.prototype.dec=function(t,e,n){return this.declaration(t,e,n)},t.prototype.e=function(t,e,n){return this.element(t,e,n)},t.prototype.n=function(t,e,n){return this.node(t,e,n)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.u=function(){return this.up()},t.prototype.importXMLBuilder=function(t){return this.importDocument(t)},t.prototype.replaceChild=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.removeChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.appendChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.hasChildNodes=function(){return 0!==this.children.length},t.prototype.cloneNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isSupported=function(t,e){return!0},t.prototype.hasAttributes=function(){return 0!==this.attribs.length},t.prototype.compareDocumentPosition=function(t){var n;return this,this===t?0:this.document()!==t.document()?(n=e.Disconnected|e.ImplementationSpecific,Math.random()<.5?n|=e.Preceding:n|=e.Following,n):this.isAncestor(t)?e.Contains|e.Preceding:this.isDescendant(t)?e.Contains|e.Following:this.isPreceding(t)?e.Preceding:e.Following},t.prototype.isSameNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupPrefix=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isDefaultNamespace=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.lookupNamespaceURI=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isEqualNode=function(t){var e,n,i;if(t.nodeType!==this.nodeType)return!1;if(t.children.length!==this.children.length)return!1;for(e=n=0,i=this.children.length-1;0<=i?n<=i:n>=i;e=0<=i?++n:--n)if(!this.children[e].isEqualNode(t.children[e]))return!1;return!0},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.setUserData=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.getUserData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.contains=function(t){return!!t&&(t===this||this.isDescendant(t))},t.prototype.isDescendant=function(t){var e,n,i,r;for(n=0,i=(r=this.children).length;n<i;n++){if(t===(e=r[n]))return!0;if(e.isDescendant(t))return!0}return!1},t.prototype.isAncestor=function(t){return t.isDescendant(this)},t.prototype.isPreceding=function(t){var e,n;return e=this.treePosition(t),n=this.treePosition(this),-1!==e&&-1!==n&&e<n},t.prototype.isFollowing=function(t){var e,n;return e=this.treePosition(t),n=this.treePosition(this),-1!==e&&-1!==n&&e>n},t.prototype.treePosition=function(t){var e,n;return n=0,e=!1,this.foreachTreeNode(this.document(),(function(i){if(n++,!e&&i===t)return e=!0})),e?n:-1},t.prototype.foreachTreeNode=function(t,e){var n,i,r,o,s;for(t||(t=this.document()),i=0,r=(o=t.children).length;i<r;i++){if(s=e(n=o[i]))return s;if(s=this.foreachTreeNode(n,e))return s}},t}()}).call(this)},function(t,e){(function(){var e,n,i,r,o,s,a,u=[].slice,c={}.hasOwnProperty;e=function(){var t,e,n,i,r,s;if(s=arguments[0],r=2<=arguments.length?u.call(arguments,1):[],o(Object.assign))Object.assign.apply(null,arguments);else for(t=0,n=r.length;t<n;t++)if(null!=(i=r[t]))for(e in i)c.call(i,e)&&(s[e]=i[e]);return s},o=function(t){return!!t&&"[object Function]"===Object.prototype.toString.call(t)},s=function(t){var e;return!!t&&("function"==(e=typeof t)||"object"===e)},i=function(t){return o(Array.isArray)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},r=function(t){var e;if(i(t))return!t.length;for(e in t)if(c.call(t,e))return!1;return!0},a=function(t){var e,n;return s(t)&&(n=Object.getPrototypeOf(t))&&(e=n.constructor)&&"function"==typeof e&&e instanceof e&&Function.prototype.toString.call(e)===Function.prototype.toString.call(Object)},n=function(t){return o(t.valueOf)?t.valueOf():t},t.exports.assign=e,t.exports.isFunction=o,t.exports.isObject=s,t.exports.isArray=i,t.exports.isEmpty=r,t.exports.isPlainObject=a,t.exports.getValue=n}).call(this)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i}return Object.defineProperty(t.prototype,"empty",{get:function(){return this.width<0||this.height<0},enumerable:!1,configurable:!0}),t.prototype.inside=function(t){return t.x>=this.x&&t.y>=this.y&&t.x<=this.x+this.width&&t.y<=this.y+this.height},t.prototype.intersect=function(t){var e=Math.max(this.x,t.x),n=Math.max(this.y,t.y);return t.width=Math.min(this.x+this.width,t.x+t.width)-e,t.height=Math.min(this.y+this.height,t.y+t.height)-n,t.x=e,t.y=n,!t.empty},t.prototype.clone=function(){return t.create(this)},t.prototype.contains=function(t){return t.x>=this.x&&t.y>=this.y&&t.x+t.width<=this.x+this.width&&t.y+t.height<=this.y+this.height},t.prototype.add=function(t){var e=Math.min(this.x,t.x),n=Math.min(this.y,t.y);this.x=e,this.y=n,this.width=Math.max(this.x+this.width,t.x+t.width)-e,this.height=Math.max(this.y+this.height,t.y+t.height)-n},t.prototype.move=function(t,e){this.x=0|t,this.y=0|e},t.prototype.grow=function(t,e){this.x-=t|=0,this.y-=e|=0,this.width+=2*t,this.height+=2*e},t.create=function(e){return new t(e.x,e.y,e.width,e.height)},t.empty=function(){return new t(0,0,0,0)},t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DialogType=e.ActionType=e.StateType=void 0,function(t){t[t.WINDOW=1]="WINDOW",t[t.DEFAULT=2]="DEFAULT",t[t.BOARD=3]="BOARD",t[t.EC_NODE=4]="EC_NODE",t[t.EC_DRAG=5]="EC_DRAG",t[t.EC_BODY=6]="EC_BODY",t[t.WIRE_NODE=7]="WIRE_NODE",t[t.WIRE_NODE_DRAG=8]="WIRE_NODE_DRAG",t[t.WIRE_LINE=9]="WIRE_LINE",t[t.WIRE_LINE_DRAG=10]="WIRE_LINE_DRAG",t[t.NEW_WIRE_FROM_EC=11]="NEW_WIRE_FROM_EC"}(e.StateType||(e.StateType={})),function(t){t[t.DEFAULT=1]="DEFAULT",t[t.OVER=2]="OVER",t[t.OUT=3]="OUT",t[t.MOVE=4]="MOVE",t[t.DOWN=5]="DOWN",t[t.UP=6]="UP",t[t.ENTER=7]="ENTER",t[t.LEAVE=8]="LEAVE",t[t.START=14]="START",t[t.RESUME=15]="RESUME",t[t.STOP=16]="STOP",t[t.HIDE_NODE=17]="HIDE_NODE",t[t.FORWARD_OVER=18]="FORWARD_OVER",t[t.KEY=40]="KEY",t[t.SELECT=100]="SELECT",t[t.TOGGLE_SELECT=102]="TOGGLE_SELECT",t[t.SELECT_ALL=103]="SELECT_ALL",t[t.UNSELECT_ALL=104]="UNSELECT_ALL",t[t.DELETE=110]="DELETE",t[t.DELETE_SELECTED=111]="DELETE_SELECTED",t[t.DELETE_ALL=112]="DELETE_ALL",t[t.DELETE_WIRE_NODE=113]="DELETE_WIRE_NODE",t[t.DELETE_THIS_LINE=114]="DELETE_THIS_LINE",t[t.AFTER_DELETE=115]="AFTER_DELETE",t[t.SPLIT_THIS_LINE=120]="SPLIT_THIS_LINE",t[t.SHOW_PROPERTIES=200]="SHOW_PROPERTIES",t[t.BRING_TO_FRONT=201]="BRING_TO_FRONT",t[t.ROTATE_45_CLOCKWISE=202]="ROTATE_45_CLOCKWISE",t[t.ROTATE_45_COUNTER_CLOCKWISE=203]="ROTATE_45_COUNTER_CLOCKWISE",t[t.ROTATE_90_CLOCKWISE=204]="ROTATE_90_CLOCKWISE",t[t.ROTATE_90_COUNTER_CLOCKWISE=205]="ROTATE_90_COUNTER_CLOCKWISE",t[t.UNBOND=206]="UNBOND",t[t.RESUME_EDIT=207]="RESUME_EDIT"}(e.ActionType||(e.ActionType={})),function(t){t[t.Save=0]="Save",t[t.Cancel=1]="Cancel",t[t.Loaded=3]="Loaded",t[t.Saved=4]="Saved",t[t.Error=5]="Error"}(e.DialogType||(e.DialogType={}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.XML=e.Templates=void 0;var i=function(){function t(){}return t.get=function(e){return t.map.get(e)},t.set=function(e,n){t.map.set(e,n)},Object.defineProperty(t,"size",{get:function(){return t.map.size},enumerable:!1,configurable:!0}),t.register=function(e){for(var n in e)t.set(n,e[n])},t.nano=function(e,n){return t.get(e).replace(/\{\{\s*([\w\.]*)\s*\}\}/g,(function(t,e){for(var i=e.split("."),r=n[i.shift()],o=0,s=i.length;r&&s>o;o++)r=r[i[o]];return null!=r?r:"null"}))},t.parse=function(e,n,i){var o=r.parse(t.get(e),"text/html"),s=new Map,a=function(t,e){for(var n=t.split("."),i=e[n.shift()],r=0,o=n.length;i&&o>r;r++)i=i[n[r]];return i},u=function(t){var e=s.get(t);return!e&&s.set(t,e=a(t,n)),e},c=function(t,e,n,i){for(var r=!1,o=Array.from(t.attributes),s=function(t){for(var o,s=/\{\{\s*([\w\.]*)\s*\}\}/g,c="",p=0;o=s.exec(t);)c+=t.substr(p,o.index-p),r=!0,e==o[1]?c+=n[i]:e&&o[1].startsWith(e+".")?c+=a(o[1].substr(e.length+1),n[i]):c+=u(o[1]),p=o.index+o[0].length;return c+=t.substr(p,t.length-p)},c=0;c<o.length;c++){var p=o[c],l=p.name,d="d-for-ndx"==l,f=l.endsWith("?"),y=void 0;r=!1,d?(l=p.value,y=i):(y=s(p.value),f&&(l=l.substr(0,l.length-1))),f||d?(t.removeAttribute(p.name),"undefined"!=y&&t.setAttribute(l,y)):r&&(p.value=y)}t.children.length?h(t,e,n,i):t.firstChild&&(t.firstChild.nodeValue=s(t.firstChild.nodeValue))},p=function(t,e,i,r){var o,s=t.getAttribute("d-for");if(s){if(e)throw"nested @for not supported";t.removeAttribute("d-for");var a=s.match(/(\w*)\s+in\s+(\w*)/),u=a?n[a[2]]:void 0;if(!u)throw"invalid %for template";return u.forEach((function(e,n){var i,r=t.cloneNode(!0);null===(i=t.parentElement)||void 0===i||i.insertBefore(r,t),c(r,a[1],u,n)})),null===(o=t.parentElement)||void 0===o||o.removeChild(t),u.length}return c(t,e,i,r),1},h=function(t,e,n,i){for(var r=0,o=t.children[r];r<t.children.length;o=t.children[r])r+=p(o,e,n,i)};return h(o.body,void 0,void 0,void 0),i?r.prettify(o.body.firstChild):o.body.innerHTML},t.map=new Map,t}();e.Templates=i;var r={parse:function(t,e){return void 0===e&&(e="text/xml"),(new DOMParser).parseFromString(t,e)},stringify:function(t){return(new XMLSerializer).serializeToString(t)},transform:function(t,e){var n=new XSLTProcessor;n.importStylesheet("string"==typeof e?r.parse(e):e);var i=n.transformToFragment("string"==typeof t?r.parse(t):t,document);return"string"==typeof t?r.stringify(i):i},minify:function(t){return r.toString(t,!1)},prettify:function(t){return r.toString(t,!0)},toString:function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=!1),"string"==typeof t&&(t=r.parse(t));var o=e?Array(n+1).fill("").join("\t"):"",s=e?"\n":"";if(3==t.nodeType){var a=(i?"":o)+t.textContent.trim();return a.trim()?a+(i?"":s):""}if(!t.tagName)return r.toString(t.firstChild,e);for(var u=o+"<"+t.tagName,c=0;c<t.attributes.length;c++)u+=" "+t.attributes[c].name+'="'+t.attributes[c].value+'"';if(0==t.childNodes.length)return u+" />"+s;u+=">";var p=1==t.childNodes.length&&3==t.childNodes[0].nodeType;p||(u+=s);for(c=0;c<t.childNodes.length;c++)u+=r.toString(t.childNodes[c],e,n+1,p);return u+(p?"":o)+"</"+t.tagName+">"+s}};e.XML=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(8),r=n(4),o=function(){function t(t){this.app=t}return t.create=function(e){if(s)throw"cannot create duplicated manager";return s=new t(e)},Object.defineProperty(t,"$",{get:function(){return s},enumerable:!1,configurable:!0}),t.prototype.transition=function(t,e,n,i){return this.app.sm.transition(t,e,n,i)},t.prototype.execute=function(t,e){var n=e.split("::"),o=this.app.circuit.get(n.shift()),s=(n.shift(),n.shift(),parseInt(n.shift())),a=n.shift(),u=!1;switch(t){case i.ActionType.TOGGLE_SELECT:(u=!o)||o.type!=r.Type.EC||(this.app.circuit.toggleSelect(o),this.app.refreshRotation(this.app.circuit.ec),this.app.circuit.ec&&(this.app.winProps.load(this.app.circuit.ec),1)||this.app.winProps.clear(),this.app.circuit.ec&&(window.ec=this.app.circuit.ec));break;case i.ActionType.SELECT:(u=!o)||o.type!=r.Type.EC||(this.app.circuit.selectThis(o),this.app.refreshRotation(o),t==i.ActionType.SELECT&&(this.app.winProps.load(o),1)||this.app.winProps.clear(),window.ec=this.app.circuit.ec);break;case i.ActionType.SELECT_ALL:this.app.circuit.selectAll(!0),this.app.refreshRotation(),this.app.winProps.clear(),window.ec=void 0;break;case i.ActionType.UNSELECT_ALL:this.app.circuit.selectAll(!1),this.app.refreshRotation(),this.app.winProps.clear(),window.ec=void 0;break;case i.ActionType.DELETE_SELECTED:var c=this.app.circuit.selectedComponents.length,p=this.app.circuit.deleteSelected();this.app.refreshRotation(),this.app.winProps.clear().setVisible(!1),this.app.tooltip.setVisible(!1),this.app.updateCircuitLabel(),c!=p&&console.log("["+p+"] components of ["+c+"]"),window.ec=void 0;break;case i.ActionType.DELETE:(u=!o)||this.app.circuit.delete(o)&&(this.app.refreshRotation(),this.app.winProps.clear().setVisible(!1),this.app.tooltip.setVisible(!1),this.app.updateCircuitLabel(),this.app.sm.send(i.ActionType.AFTER_DELETE,o.id)),window.ec=void 0;break;case i.ActionType.DELETE_THIS_LINE:(u=!o)||(o.deleteLine(s),this.app.winProps.refresh(),this.app.updateCircuitLabel());break;case i.ActionType.DELETE_WIRE_NODE:(u=!o)||(o.deleteNode(s),this.app.winProps.refresh(),this.app.updateCircuitLabel());break;case i.ActionType.SPLIT_THIS_LINE:(u=!o)||(o.insertNode(s,this.app.rightClick.offset),this.app.winProps.refresh(),this.app.updateCircuitLabel());break;case i.ActionType.SHOW_PROPERTIES:!(u=!o)&&this.app.winProps.load(o);break;case i.ActionType.ROTATE_45_CLOCKWISE:case i.ActionType.ROTATE_45_COUNTER_CLOCKWISE:case i.ActionType.ROTATE_90_CLOCKWISE:case i.ActionType.ROTATE_90_COUNTER_CLOCKWISE:!(u=!o)&&a&&this.app.rotateComponentBy(0|a,o)}u&&console.log("invalid trigger: "+e)},t}(),s=void 0;e.default=o},function(t,e,n){(function(){var e,i={}.hasOwnProperty;e=n(5),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t),this.value=""}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(e.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.substringData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.appendData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.insertData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.deleteData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.replaceData=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isEqualNode=function(t){return!!e.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.data===this.data},e}(e)}).call(this)},function(t,e){(function(){t.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},function(t,e){t.exports=require("electron")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=function(t){return{name:t,comp:{name:t,type:t,meta:{nameTmpl:"{base.comp.name}-{base.count}",nodes:[]}}}},o=function(){function t(e){var n=this,r=e.tmpl;if(delete e.tmpl,this.settings=i.obj(e),r){var o=t.find(r.name);this.settings.data=o.data,this.settings.meta=JSON.parse(JSON.stringify(o.meta)),r.label&&(this.settings.meta.label=i.obj(r.label)),r.nodeLabels.forEach((function(t,e){n.settings.meta.nodes.list[e].label=t}))}if(!this.settings.meta.nameTmpl&&(this.settings.meta.nameTmpl="{base.comp.name}-{base.count}"),!t.store(this.settings.name,this))throw"duplicated: "+this.settings.name}return Object.defineProperty(t.prototype,"name",{get:function(){return this.settings.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.settings.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this.settings.data},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"props",{get:function(){return this.settings.properties},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"meta",{get:function(){return this.settings.meta},enumerable:!1,configurable:!0}),t.initializeComponents=function(e){var n=t.baseComps;return null==n&&(n=new Map),e.forEach((function(t){n.set(t.name,t.comp)})),n},t.baseComps=t.initializeComponents([r("tooltip"),r("wire")]),t.register=function(e){return new t(e)},t.store=function(e,n){return!t.baseComps.has(e)&&(t.baseComps.set(e,n),!0)},t.has=function(e){return t.baseComps.has(e)},t.find=function(e){return t.baseComps.get(e)},t}();e.default=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=function(){function t(t,e){this.width=parseFloat(t),this.height=parseFloat(e)}return t.prototype.clone=function(){return new t(this.width,this.height)},t.prototype.round=function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this},t.create=function(e){return new t(e.width,e.height)},t.prototype.toString=function(t){var e=0!=(4&(t|=0)),n=0!=(2&t);return(n?"":"(")+(e?"":"w: ")+i.round(this.width,1)+", "+(e?"":"h: ")+i.round(this.height,1)+(n?"":")")},t.empty=new t(0,0),t}();e.default=r},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(2),a=n(36),u=n(7),c=n(3),p=function(t){function e(e){var n=t.call(this,e)||this,i=o.isStr(n.class)?n.class.split(" "):[];return!n.settings.visible&&i.push("hide"),n.settings.g=s.tag("g",n.settings.id,{class:n.settings.class=i.join(" ")}),n}return r(e,t),Object.defineProperty(e.prototype,"g",{get:function(){return this.settings.g},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ClientRect",{get:function(){var t=this.g.getBoundingClientRect();return o.obj({width:0|t.width,height:0|t.height})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this.g.getBBox()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"origin",{get:function(){var t=this.box;return new c.default(t.x+t.width/2|0,t.y+t.height/2|0)},enumerable:!1,configurable:!0}),e.prototype.rect=function(){return new u.default(this.p.x,this.p.y,this.box.width,this.box.height)},e.prototype.setVisible=function(e){return t.prototype.setVisible.call(this,e),this.visible?o.removeClass(this.g,"hide"):o.addClass(this.g,"hide"),this},e.prototype.remove=function(){var t;null===(t=this.g.parentNode)||void 0===t||t.removeChild(this.g)},e.prototype.afterDOMinserted=function(){},e}(a.default);e.default=p},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.BondsInjector=e.IdInjector=e.StringInjector=e.PositionInjector=e.PointInjector=e.PropertyInjector=e.ItemBoard=void 0;var o=n(0),s=n(64),a=n(16),u=n(14),c=n(2),p=n(3),h=n(4),l=function(t){function e(e,n){var i=t.call(this,n)||this;i.circuit=e;var r=u.default.find(i.name);if(!r||!e)throw"cannot create component";return i.settings.props=o.obj(r.props),o.attr(i.g,{id:i.id,"svg-comp":i.base.type}),i}return r(e,t),Object.defineProperty(e.prototype,"base",{get:function(){return this.settings.base},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onProp",{get:function(){return this.settings.onProp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selected",{get:function(){return this.settings.selected},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bonds",{get:function(){return this.settings.bonds},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return this.settings.label},enumerable:!1,configurable:!0}),e.prototype.select=function(t){return this.selected!=t&&(this.settings.selected=t,o.condClass(this.g,"selected",this.selected),this.onProp&&this.onProp({id:"#"+this.id,value:this.selected,prop:"selected",where:1})),this},e.prototype.move=function(e,n){return t.prototype.move.call(this,e,n),this.onProp&&this.onProp({id:"#"+this.id,args:{x:this.x,y:this.y},method:"move",where:1}),this},e.prototype.setOnProp=function(t){return o.isFn(t)&&(this.settings.onProp=t),this},e.prototype.windowProperties=function(){return["id","p","bonds"]},e.prototype.properties=function(){return this.windowProperties().concat(c.map(this.settings.props,(function(t,e){return e})))},e.prototype.prop=function(t){switch(t){case"id":return new g(this);case"p":return new y(this);case"bonds":return new b(this)}return this.settings.props[t]},e.prototype.bond=function(t,e,n){var i=this.nodeBonds(t);return!(!e||i&&i.has(e.id)||!e.valid(n))&&(i?i.add(e,n)||console.log("Oooopsie!"):this.settings.bonds[t]=i=new s.Bond(this,e,n,t),this.settings.bondsCount++,this.nodeRefresh(t),!(!(i=e.nodeBonds(n))||!i.has(this.id))||e.bond(n,this,t))},e.prototype.nodeBonds=function(t){return this.bonds[t]},e.prototype.unbond=function(t,e){var n=this.nodeBonds(t),i=null==n?null:n.remove(e);if(null!=i){0==n.count&&(delete this.settings.bonds[t],0==--this.settings.bondsCount&&(this.settings.bonds=[])),this.nodeRefresh(t);var r=this.circuit.get(e);r&&r.unbond(i.ndx,this.id)}},e.prototype.unbondNode=function(t){var e,n=this.nodeBonds(t),i=void 0;if(n){for(var r=0,o=n.to.length;r<o;r++)i=n.to[r],null===(e=this.circuit.get(i.id))||void 0===e||e.unbond(i.ndx,n.from.id);delete this.settings.bonds[t],0==--this.settings.bondsCount&&(this.settings.bonds=[])}},e.prototype.disconnect=function(){for(var t=0;t<this.count;t++)this.unbondNode(t)},e.prototype.propertyDefaults=function(){return o.extend(t.prototype.propertyDefaults.call(this),{selected:!1,onProp:void 0,bonds:[],bondsCount:0})},e.connectedWiresTo=function(t){var e,n=[],i=t.map((function(t){return t.id})),r=null===(e=t[0])||void 0===e?void 0:e.circuit,o=[];return r&&(t.forEach((function(t){t.bonds.forEach((function(t){t.to.filter((function(t){return!n.find((function(e){return e.id==t.id}))})).forEach((function(t){var e,s,a=r.get(t.id),u=a.nodeBonds((e=t.ndx,s=a.last,0==e?s:e==s?0:e));u.to[0].type==h.Type.EC?i.includes(u.to[0].id)&&n.push(a):n.find((function(t){return t.id==u.to[0].id}))?n.push(a):o.push({wire:a,toId:u.to[0].id})}))}))})),o.forEach((function(t){return n.find((function(e){return e.id==t.toId}))&&n.push(t.wire)}))),n},e.wireConnections=function(t){for(var e=[t],n=[],i=[],r=t.circuit,o=function(t){t.to.forEach((function(t){var o=r.get(t.id);if(!o)throw"Invalid bond connections";switch(t.type){case h.Type.WIRE:n.some((function(e){return e==t.id}))||(n.push(o.id),e.push(o),i.push({it:o,p:p.default.create(o.getNode(t.ndx)),n:t.ndx}));break;case h.Type.EC:i.push({it:o,p:o.getNodeRealXY(t.ndx),n:t.ndx})}}))};e.length;){var s=e.shift();n.push(s.id),s.bonds.forEach(o)}return i},e}(a.default);e.ItemBoard=l;var d=function(){function t(t,e,n){if(this.ec=t,this.name=e,this.readonly=n,!this.ec||!(this.name in this.ec))throw"invalid property "+this.name;this.class=""}return Object.defineProperty(t.prototype,"valueType",{get:function(){return"string"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isProperty",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"label",{get:function(){return this.name},enumerable:!1,configurable:!0}),t}();e.PropertyInjector=d;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"point"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.ec[this.name].toString(6)},enumerable:!1,configurable:!0}),e}(d);e.PointInjector=f;var y=function(t){function e(e){var n=t.call(this,e,"p",!1)||this;return n.ec=e,n}return r(e,t),Object.defineProperty(e.prototype,"label",{get:function(){return"position"},enumerable:!1,configurable:!0}),e.prototype.setValue=function(t){var e=p.default.parse(t);return e&&(this.ec.move(e.x,e.y),!0)},e}(f);e.PositionInjector=y;var m=function(t){function e(e,n,i){return t.call(this,e,n,i)||this}return r(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"string"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.ec[this.name]},enumerable:!1,configurable:!0}),e.prototype.setValue=function(t){return!this.readonly&&(this.ec[this.name]=t,!0)},e}(d);e.StringInjector=m;var g=function(t){function e(e){return t.call(this,e,"id",!0)||this}return r(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.ec[this.name]},enumerable:!1,configurable:!0}),e.prototype.setValue=function(t){return!1},e}(m);e.IdInjector=g;var b=function(t){function e(e){var n=t.call(this,e,"bonds",!0)||this;return n.class="simple",n}return r(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.ec.bonds.map((function(t){return t.link})).filter((function(t){return!!t})).join(", ")},enumerable:!1,configurable:!0}),e.prototype.setValue=function(t){return!1},e}(m);e.BondsInjector=b},function(t,e){(function(){e.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},function(t,e,n){(function(){var e,i,r,o,s,a,u,c,p={}.hasOwnProperty;c=n(6),u=c.isObject,a=c.isFunction,s=c.getValue,o=n(5),e=n(1),i=n(42),r=n(20),t.exports=function(t){function n(t,i,r){var o,s,a,u;if(n.__super__.constructor.call(this,t),null==i)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(i),this.type=e.Element,this.attribs={},this.schemaTypeInfo=null,null!=r&&this.attribute(r),t.type===e.Document&&(this.isRoot=!0,this.documentObject=t,t.rootObject=this,t.children))for(s=0,a=(u=t.children).length;s<a;s++)if((o=u[s]).type===e.DocType){o.name=this.name;break}}return function(t,e){for(var n in e)p.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),Object.defineProperty(n.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(n.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(n.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(n.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(n.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(n.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(n.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(n.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new r(this.attribs)),this.attributeMap}}),n.prototype.clone=function(){var t,e,n,i;for(e in(n=Object.create(this)).isRoot&&(n.documentObject=null),n.attribs={},i=this.attribs)p.call(i,e)&&(t=i[e],n.attribs[e]=t.clone());return n.children=[],this.children.forEach((function(t){var e;return(e=t.clone()).parent=n,n.children.push(e)})),n},n.prototype.attribute=function(t,e){var n,r;if(null!=t&&(t=s(t)),u(t))for(n in t)p.call(t,n)&&(r=t[n],this.attribute(n,r));else a(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.attribs[t]=new i(this,t,""):null!=e&&(this.attribs[t]=new i(this,t,e));return this},n.prototype.removeAttribute=function(t){var e,n,i;if(null==t)throw new Error("Missing attribute name. "+this.debugInfo());if(t=s(t),Array.isArray(t))for(n=0,i=t.length;n<i;n++)e=t[n],delete this.attribs[e];else delete this.attribs[t];return this},n.prototype.toString=function(t){return this.options.writer.element(this,this.options.writer.filterOptions(t))},n.prototype.att=function(t,e){return this.attribute(t,e)},n.prototype.a=function(t,e){return this.attribute(t,e)},n.prototype.getAttribute=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t].value:null},n.prototype.setAttribute=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getAttributeNode=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t]:null},n.prototype.setAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.removeAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.setAttributeNS=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.removeAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getAttributeNodeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.setAttributeNodeNS=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.hasAttribute=function(t){return this.attribs.hasOwnProperty(t)},n.prototype.hasAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.setIdAttribute=function(t,e){return this.attribs.hasOwnProperty(t)?this.attribs[t].isId:e},n.prototype.setIdAttributeNS=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.setIdAttributeNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.isEqualNode=function(t){var e,i,r;if(!n.__super__.isEqualNode.apply(this,arguments).isEqualNode(t))return!1;if(t.namespaceURI!==this.namespaceURI)return!1;if(t.prefix!==this.prefix)return!1;if(t.localName!==this.localName)return!1;if(t.attribs.length!==this.attribs.length)return!1;for(e=i=0,r=this.attribs.length-1;0<=r?i<=r:i>=r;e=0<=r?++i:--i)if(!this.attribs[e].isEqualNode(t.attribs[e]))return!1;return!0},n}(o)}).call(this)},function(t,e){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.getNamedItem=function(t){return this.nodes[t]},t.prototype.setNamedItem=function(t){var e;return e=this.nodes[t.nodeName],this.nodes[t.nodeName]=t,e||null},t.prototype.removeNamedItem=function(t){var e;return e=this.nodes[t],delete this.nodes[t],e||null},t.prototype.item=function(t){return this.nodes[Object.keys(this.nodes)[t]]||null},t.prototype.getNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t.prototype.setNamedItemNS=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.removeNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},function(t,e,n){(function(){var e,i,r={}.hasOwnProperty;e=n(1),i=n(11),t.exports=function(t){function n(t,i){if(n.__super__.constructor.call(this,t),null==i)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=e.CData,this.value=this.stringify.cdata(i)}return function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(t){return this.options.writer.cdata(this,this.options.writer.filterOptions(t))},n}(i)}).call(this)},function(t,e,n){(function(){var e,i,r={}.hasOwnProperty;e=n(1),i=n(11),t.exports=function(t){function n(t,i){if(n.__super__.constructor.call(this,t),null==i)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=e.Comment,this.value=this.stringify.comment(i)}return function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(t){return this.options.writer.comment(this,this.options.writer.filterOptions(t))},n}(i)}).call(this)},function(t,e,n){(function(){var e,i,r,o={}.hasOwnProperty;r=n(6).isObject,i=n(5),e=n(1),t.exports=function(t){function n(t,i,o,s){var a;n.__super__.constructor.call(this,t),r(i)&&(i=(a=i).version,o=a.encoding,s=a.standalone),i||(i="1.0"),this.type=e.Declaration,this.version=this.stringify.xmlVersion(i),null!=o&&(this.encoding=this.stringify.xmlEncoding(o)),null!=s&&(this.standalone=this.stringify.xmlStandalone(s))}return function(t,e){for(var n in e)o.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),n.prototype.toString=function(t){return this.options.writer.declaration(this,this.options.writer.filterOptions(t))},n}(i)}).call(this)},function(t,e,n){(function(){var e,i,r,o,s,a,u,c,p={}.hasOwnProperty;c=n(6).isObject,u=n(5),e=n(1),i=n(25),o=n(26),r=n(27),s=n(28),a=n(20),t.exports=function(t){function n(t,i,r){var o,s,a,u,p,h;if(n.__super__.constructor.call(this,t),this.type=e.DocType,t.children)for(s=0,a=(u=t.children).length;s<a;s++)if((o=u[s]).type===e.Element){this.name=o.name;break}this.documentObject=t,c(i)&&(i=(p=i).pubID,r=p.sysID),null==r&&(r=(h=[i,r])[0],i=h[1]),null!=i&&(this.pubID=this.stringify.dtdPubID(i)),null!=r&&(this.sysID=this.stringify.dtdSysID(r))}return function(t,e){for(var n in e)p.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),Object.defineProperty(n.prototype,"entities",{get:function(){var t,n,i,r,o;for(r={},n=0,i=(o=this.children).length;n<i;n++)(t=o[n]).type!==e.EntityDeclaration||t.pe||(r[t.name]=t);return new a(r)}}),Object.defineProperty(n.prototype,"notations",{get:function(){var t,n,i,r,o;for(r={},n=0,i=(o=this.children).length;n<i;n++)(t=o[n]).type===e.NotationDeclaration&&(r[t.name]=t);return new a(r)}}),Object.defineProperty(n.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(n.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(n.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),n.prototype.element=function(t,e){var n;return n=new r(this,t,e),this.children.push(n),this},n.prototype.attList=function(t,e,n,r,o){var s;return s=new i(this,t,e,n,r,o),this.children.push(s),this},n.prototype.entity=function(t,e){var n;return n=new o(this,!1,t,e),this.children.push(n),this},n.prototype.pEntity=function(t,e){var n;return n=new o(this,!0,t,e),this.children.push(n),this},n.prototype.notation=function(t,e){var n;return n=new s(this,t,e),this.children.push(n),this},n.prototype.toString=function(t){return this.options.writer.docType(this,this.options.writer.filterOptions(t))},n.prototype.ele=function(t,e){return this.element(t,e)},n.prototype.att=function(t,e,n,i,r){return this.attList(t,e,n,i,r)},n.prototype.ent=function(t,e){return this.entity(t,e)},n.prototype.pent=function(t,e){return this.pEntity(t,e)},n.prototype.not=function(t,e){return this.notation(t,e)},n.prototype.up=function(){return this.root()||this.documentObject},n.prototype.isEqualNode=function(t){return!!n.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&(t.name===this.name&&(t.publicId===this.publicId&&t.systemId===this.systemId))},n}(u)}).call(this)},function(t,e,n){(function(){var e,i,r={}.hasOwnProperty;i=n(5),e=n(1),t.exports=function(t){function n(t,i,r,o,s,a){if(n.__super__.constructor.call(this,t),null==i)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==r)throw new Error("Missing DTD attribute name. "+this.debugInfo(i));if(!o)throw new Error("Missing DTD attribute type. "+this.debugInfo(i));if(!s)throw new Error("Missing DTD attribute default. "+this.debugInfo(i));if(0!==s.indexOf("#")&&(s="#"+s),!s.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(i));if(a&&!s.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(i));this.elementName=this.stringify.name(i),this.type=e.AttributeDeclaration,this.attributeName=this.stringify.name(r),this.attributeType=this.stringify.dtdAttType(o),a&&(this.defaultValue=this.stringify.dtdAttDefault(a)),this.defaultValueType=s}return function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),n.prototype.toString=function(t){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(t))},n}(i)}).call(this)},function(t,e,n){(function(){var e,i,r,o={}.hasOwnProperty;r=n(6).isObject,i=n(5),e=n(1),t.exports=function(t){function n(t,i,o,s){if(n.__super__.constructor.call(this,t),null==o)throw new Error("Missing DTD entity name. "+this.debugInfo(o));if(null==s)throw new Error("Missing DTD entity value. "+this.debugInfo(o));if(this.pe=!!i,this.name=this.stringify.name(o),this.type=e.EntityDeclaration,r(s)){if(!s.pubID&&!s.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(o));if(s.pubID&&!s.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(o));if(this.internal=!1,null!=s.pubID&&(this.pubID=this.stringify.dtdPubID(s.pubID)),null!=s.sysID&&(this.sysID=this.stringify.dtdSysID(s.sysID)),null!=s.nData&&(this.nData=this.stringify.dtdNData(s.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(o))}else this.value=this.stringify.dtdEntityValue(s),this.internal=!0}return function(t,e){for(var n in e)o.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),Object.defineProperty(n.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(n.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(n.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(n.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(n.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(n.prototype,"xmlVersion",{get:function(){return null}}),n.prototype.toString=function(t){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(t))},n}(i)}).call(this)},function(t,e,n){(function(){var e,i,r={}.hasOwnProperty;i=n(5),e=n(1),t.exports=function(t){function n(t,i,r){if(n.__super__.constructor.call(this,t),null==i)throw new Error("Missing DTD element name. "+this.debugInfo());r||(r="(#PCDATA)"),Array.isArray(r)&&(r="("+r.join(",")+")"),this.name=this.stringify.name(i),this.type=e.ElementDeclaration,this.value=this.stringify.dtdElementValue(r)}return function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),n.prototype.toString=function(t){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(t))},n}(i)}).call(this)},function(t,e,n){(function(){var e,i,r={}.hasOwnProperty;i=n(5),e=n(1),t.exports=function(t){function n(t,i,r){if(n.__super__.constructor.call(this,t),null==i)throw new Error("Missing DTD notation name. "+this.debugInfo(i));if(!r.pubID&&!r.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(i));this.name=this.stringify.name(i),this.type=e.NotationDeclaration,null!=r.pubID&&(this.pubID=this.stringify.dtdPubID(r.pubID)),null!=r.sysID&&(this.sysID=this.stringify.dtdSysID(r.sysID))}return function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),Object.defineProperty(n.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(n.prototype,"systemId",{get:function(){return this.sysID}}),n.prototype.toString=function(t){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(t))},n}(i)}).call(this)},function(t,e,n){(function(){var e,i,r={}.hasOwnProperty;e=n(1),i=n(5),t.exports=function(t){function n(t,i){if(n.__super__.constructor.call(this,t),null==i)throw new Error("Missing raw text. "+this.debugInfo());this.type=e.Raw,this.value=this.stringify.raw(i)}return function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(t){return this.options.writer.raw(this,this.options.writer.filterOptions(t))},n}(i)}).call(this)},function(t,e,n){(function(){var e,i,r={}.hasOwnProperty;e=n(1),i=n(11),t.exports=function(t){function n(t,i){if(n.__super__.constructor.call(this,t),null==i)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=e.Text,this.value=this.stringify.text(i)}return function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),Object.defineProperty(n.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(n.prototype,"wholeText",{get:function(){var t,e,n;for(n="",e=this.previousSibling;e;)n=e.data+n,e=e.previousSibling;for(n+=this.data,t=this.nextSibling;t;)n+=t.data,t=t.nextSibling;return n}}),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(t){return this.options.writer.text(this,this.options.writer.filterOptions(t))},n.prototype.splitText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.replaceWholeText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n}(i)}).call(this)},function(t,e,n){(function(){var e,i,r={}.hasOwnProperty;e=n(1),i=n(11),t.exports=function(t){function n(t,i,r){if(n.__super__.constructor.call(this,t),null==i)throw new Error("Missing instruction target. "+this.debugInfo());this.type=e.ProcessingInstruction,this.target=this.stringify.insTarget(i),this.name=this.target,r&&(this.value=this.stringify.insValue(r))}return function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(t){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(t))},n.prototype.isEqualNode=function(t){return!!n.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.target===this.target},n}(i)}).call(this)},function(t,e,n){(function(){var e,i={}.hasOwnProperty;e=n(45),t.exports=function(t){function e(t){e.__super__.constructor.call(this,t)}return function(t,e){for(var n in e)i.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(e,t),e.prototype.document=function(t,e){var n,i,r,o,s;for(e=this.filterOptions(e),o="",i=0,r=(s=t.children).length;i<r;i++)n=s[i],o+=this.writeChildNode(n,e,0);return e.pretty&&o.slice(-e.newline.length)===e.newline&&(o=o.slice(0,-e.newline.length)),o},e}(e)}).call(this)},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("path")},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Label=void 0;var o=n(16),s=n(4),a=n(0),u=n(2),c=function(t){function e(e){var n=this;return e.visible=!1,(n=t.call(this,e)||this).text="",n.t=u.tag("text","",{}),a.aCld(n.g,n.t),n}return r(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return s.Type.LABEL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var t=this.t.getBBox();return a.obj({width:Math.round(t.width),height:Math.round(t.height)})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.settings.fontSize},enumerable:!1,configurable:!0}),e.prototype.move=function(e,n){return t.prototype.move.call(this,e,n),a.attr(this.g,{transform:"translate("+this.x+" "+this.y+")"}),this},e.prototype.setFontSize=function(t){return this.settings.fontSize=t,this.build()},e.prototype.build=function(){return a.attr(this.t,{"font-size":this.fontSize,x:0,y:0}),this},e.prototype.setText=function(t){return this.t.innerHTML=this.text=t,this.build()},e.prototype.propertyDefaults=function(){return a.extend(t.prototype.propertyDefaults.call(this),{name:"label",class:"label",fontSize:50})},e}(o.default);e.Label=c},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),s=n(0),a=function(t){function e(e){var n=t.call(this)||this,i=e.class||"";return delete e.class,n.settings=s.obj(s.copy(n.propertyDefaults(),e)),n.settings.class=s.unique((n.class+" "+i).split(" ")).join(" "),n.settings.x=n.settings.x||0,n.settings.y=n.settings.y||0,n}return r(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this.settings.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.settings.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.settings.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.settings.y},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"p",{get:function(){return new o.default(this.x,this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"class",{get:function(){return this.settings.class},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this.settings.visible},enumerable:!1,configurable:!0}),e.prototype.setVisible=function(t){return this.settings.visible=!!t,this},e.prototype.move=function(t,e){return this.settings.x=0|t,this.settings.y=0|e,this},e.prototype.movePoint=function(t){return this.move(t.x,t.y)},e.prototype.translate=function(t,e){return this.move(this.x+(0|t),this.y+(0|e))},e.prototype.propertyDefaults=function(){return{id:"",name:"",x:0,y:0,class:"",visible:!0,base:void 0,label:""}},e}(n(4).TypedClass);e.default=a},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(38),s=n(0),a=function(t){function e(e){var n=t.call(this,e)||this;n.size=n.settings.size;var i=n;return s.aEL(n.win,"mouseenter",(function(t){return i.onMouseEnter.call(i,t)}),!1),s.aEL(n.win,"mouseleave",(function(t){return i.onMouseLeave.call(i,t)}),!1),n}return r(e,t),Object.defineProperty(e.prototype,"size",{get:function(){return this.settings.size},set:function(t){this.settings.size={width:Math.max(e.minWidth,0|t.width),height:Math.max(e.minHeight,0|t.height)},this.win.style.width=this.size.width+"px",!this.settings.ignoreHeight&&(this.win.style.height=this.size.height+"px")},enumerable:!1,configurable:!0}),e.prototype.onMouseEnter=function(t){},e.prototype.onMouseLeave=function(t){},e.prototype.setVisible=function(e){return t.prototype.setVisible.call(this,e).visible?s.removeClass(this.win,"hide"):s.addClass(this.win,"hide"),this},e.prototype.move=function(e,n){return t.prototype.move.call(this,e,n),s.css(this.win,{top:this.y+"px",left:this.x+"px"}),this},e.prototype.dispose=function(){},e.prototype.propertyDefaults=function(){return s.extend(t.prototype.propertyDefaults.call(this),{size:{width:120,height:150}})},e.minWidth=200,e.minHeight=100,e}(o.default);e.default=a},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(36),s=n(4),a=n(0),u=n(2),c=n(9),p=function(t){function e(e){var n=t.call(this,e)||this;return n.settings.win=u.html(c.Templates.nano(n.settings.templateName,{id:n.id,class:n.class})),n.move(n.x,n.y),n.setVisible(!!n.settings.visible),n}return r(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return s.Type.WIN},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"win",{get:function(){return this.settings.win},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this.settings.title},enumerable:!1,configurable:!0}),e.prototype.setTitle=function(t){return this.settings.title=t,this},Object.defineProperty(e.prototype,"ClientRect",{get:function(){var t=this.win.getBoundingClientRect();return a.obj({width:0|t.width,height:0|t.height})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this.win.getBBox()},enumerable:!1,configurable:!0}),e.prototype.clear=function(){return this.win.innerHTML="",this},e.prototype.propertyDefaults=function(){return a.extend(t.prototype.propertyDefaults.call(this),{visible:!1,ignoreHeight:!1,title:"",templateName:"baseWin01"})},e}(o.default);e.default=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Circuit=void 0;var i=n(62),r=n(65),o=n(4),s=n(7),a=n(0),u=n(13),c=n(66),p=n(33),h=n(34),l=n(3),d=n(14),f=n(9),y=function(){function t(e){this.compMap=new Map,this.ecMap=new Map,this.wireMap=new Map,this.selectedComponents=[],this.uniqueCounters={},this.version=e.version||"1.1.5",this.__zoom=t.validZoom(e.zoom)?e.zoom:t.defaultZoom,this.name=e.name,this.description=e.description,this.filePath=e.filePath,this.__modified=!1,this.view=new l.default(0,0)}return t.prototype.rootComponent=function(t){return this.compMap.get(t)},Object.defineProperty(t.prototype,"zoom",{get:function(){return this.__zoom},set:function(e){t.validZoom(e)&&this.__zoom!=e&&(this.__zoom=e)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"zoomMultipliers",{get:function(){return Array.from([8,4,2,1,.75,.5,.33,.25,.166,.125])},enumerable:!1,configurable:!0}),Object.defineProperty(t,"zoomFactors",{get:function(){return Array.from(["1/8X","1/4X","1/2X","1X","1 1/2X","2X","3X","4X","6X","8X"])},enumerable:!1,configurable:!0}),t.validZoom=function(e){return!(isNaN(e)||!t.zoomMultipliers.some((function(t){return t==e})))},Object.defineProperty(t.prototype,"modified",{get:function(){return this.__modified},set:function(t){t!=this.__modified&&(this.__modified=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ecList",{get:function(){return Array.from(this.ecMap.values())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wireList",{get:function(){return Array.from(this.wireMap.values())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return!(this.wireMap.size||this.ecMap.size)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"components",{get:function(){return this.ecList.concat(this.wireList)},enumerable:!1,configurable:!0}),t.prototype.get=function(t){return this.ecMap.get(t)||this.wireMap.get(t)},Object.defineProperty(t.prototype,"ec",{get:function(){return this.selectedComponents.length?this.selectedComponents[0]:void 0},enumerable:!1,configurable:!0}),t.prototype.hasComponent=function(t){return this.ecMap.has(t)},t.prototype.selectAll=function(t){return this.selectedComponents=Array.from(this.ecMap.values()).filter((function(e){return e.select(t),t}))},t.prototype.toggleSelect=function(t){t.select(!t.selected),this.selectedComponents=this.ecList.filter((function(t){return t.selected}))},t.prototype.selectThis=function(t){return t&&(this.selectAll(!1).push(t.select(!0)),!0)},t.prototype.selectRect=function(t){(this.selectedComponents=this.ecList.filter((function(e){return t.intersect(e.rect())}))).forEach((function(t){return t.select(!0)}))},t.prototype.deleteSelected=function(){var t=this,e=0;return this.selectedComponents=this.selectedComponents.filter((function(n){return!t.delete(n)||(e++,!1)})),e},t.prototype.delete=function(t){return!!(t.type==o.Type.WIRE?this.wireMap.delete(t.id):this.ecMap.delete(t.id))&&(t.disconnect(),t.remove(),this.modified=!0,!0)},t.prototype.add=function(t){var e;return"wire"==name&&(t.points=t.points,1)||(t.x=t.x,t.y=t.y),e=m.call(this,t),this.modified=!0,e},t.load=function(e){var n=new t({filePath:e.filePath,name:"",zoom:0,version:""});return g.call(n,e.data),n},t.prototype.save=function(){var t=this;return new Promise((function(e,n){var i=0;if(t.filePath)p.writeFileSync(t.filePath,v.call(t),"utf-8"),t.modified=!1;else{var r=u.ipcRenderer.sendSync("saveFile",{data:v.call(t)});r.canceled?i=1:r.error?(console.log(r),i=5):(t.filePath=r.filePath,t.modified=!1)}e(i)}))},t.circuitProperties=function(t){return[{label:"name",value:(null==t?void 0:t.name)||"",required:!0,placeHolder:"Name",visible:!0},{label:"version",value:(null==t?void 0:t.version)||"1.1.5",readonly:!0,visible:!0},{label:"description",value:(null==t?void 0:t.description)||"",placeHolder:"Description",visible:!0},{label:"filename",value:h.basename((null==t?void 0:t.filePath)||""),readonly:!0,visible:!0},{label:"path",value:(null==t?void 0:t.filePath)||"",readonly:!0,visible:!0}]},t.prototype.destroy=function(){var t=this;this.ecList.forEach((function(e){return t.delete(e)})),this.wireList.forEach((function(e){return t.delete(e)})),this.compMap=void 0,this.ecMap=void 0,this.wireMap=void 0,this.selectedComponents=void 0,this.__modified=!1,this.filePath=void 0},t.prototype.boundariesRect=function(){var t=this.components,e=t.shift(),n=e?e.rect():s.default.empty();return t.forEach((function(t){return n.add(t.rect())})),n.grow(20,20),n},t.defaultZoom=.5,t}();function m(t){var e=this,n=(null==t?void 0:t.name)||"",o=e.rootComponent(n),s=!o,u=void 0;if(!o&&(o={comp:d.default.find(n),count:0}),!o.comp)throw"unregistered component: "+n;s&&(o.count=0|o.comp.meta.countStart,e.compMap.set(n,o)),t.base=o.comp,t.id||(t.id=n+"-"+o.count);var c=o.comp.meta.nameTmpl.replace(/(?:{([^}]+?)})+/g,(function(t,n){for(var i,r=n.split("."),s=r.shift()||"",u=function(t){switch(t){case"base":return o;case"Circuit":return e.uniqueCounters}}(s),c=r.pop(),p=function(){return"Circuit"==s};u&&r.length;)u=u[r.shift()];if(null==u||null==(i=u[c])&&(!p()||(i=u[c]=0|o.comp.meta.countStart,0)))throw"invalid label template";return p()&&a.isNum(i)&&(u[c]=i+1),i}));if(t.label&&c!=t.label)throw"invalid label";switch(t.label=c,o.count++,n){case"wire":if(u=new r.default(e,t),e.wireMap.has(u.id))throw"duplicated id: "+u.id;e.wireMap.set(u.id,u);break;default:if(!t.onProp&&(t.onProp=function(){}),u=new i.default(e,t),e.ecMap.has(u.id))throw"duplicated id: "+u.id;e.ecMap.set(u.id,u)}return u}function g(t){var e=this;c.parseString(t,{trim:!0,explicitArray:!1},(function(t,n){if(t)console.log(t);else{var i=n.circuit||n.CIRCUIT,r=i.$,o=function(t){return t&&"string"!=typeof t?t.$?[t]:t:[]},s=function(t){switch(t){case"ecs":return o(i.ecs?i.ecs.ec:i.ECS.EC);case"wires":return o(i.wires?i.wires.wire:i.WIRES.WIRE);case"bonds":return o(i.bonds?i.bonds.bond:i.BONDS.BOND)}return[]},a=s("ecs"),u=s("wires"),c=s("bonds"),p=(r.view||"").split(",");e.version=r.version,!y.validZoom(e.zoom=parseFloat(r.zoom))&&(e.zoom=y.defaultZoom),e.name=r.name,e.description=r.description,e.view=new l.default(0|parseInt(p[0]),0|parseInt(p[1])),a.forEach((function(t){m.call(e,{id:t.$.id,name:t.$.name,x:parseInt(t.$.x),y:parseInt(t.$.y),rotation:parseInt(t.$.rot),label:t.$.label},!1)})),u.forEach((function(t){var n={id:t.$.id,name:"wire",label:t.$.label,points:t.$.points.split("|").map((function(t){return l.default.parse(t)}))};if(n.points.some((function(t){return!t})))throw"invalid wire points";m.call(e,n,!1)})),c.forEach((function(t){var n=t.split(","),i=e.get(n.shift()),r=parseInt(n.shift()),o=e.get(n.shift()),s=parseInt(n.shift());if(n.length||!i||!o||!i.getNode(r)||!o.getNode(s))throw"invalid bond";i.bond(r,o,s)}))}}))}function b(){var t=[],e=new Set,n=function(n){var i=n.from.id+","+n.from.ndx;n.to.forEach((function(n){var r=n.id+","+n.ndx,o=i+","+r;e.has(o)||(e.add(o).add(r+","+i),t.push(o))}))};return this.components.forEach((function(t){return t.bonds.forEach(n)})),t}function v(){return'<?xml version="1.0" encoding="utf-8"?>\n'+f.Templates.parse("circuitXml",{version:this.version,name:this.name,zoom:this.zoom,description:this.description,view:this.view,ecList:this.ecList,wireList:this.wireList.map((function(t){return{id:t.id,label:t.label,points:t.points.map((function(t){return f.Templates.nano("simplePoint",t)})).join("|")}})),bonds:b.call(this)},!0)}e.Circuit=y},function(t,e){(function(){t.exports=function(){function t(){}return t.prototype.hasFeature=function(t,e){return!0},t.prototype.createDocumentType=function(t,e,n){throw new Error("This DOM method is not implemented.")},t.prototype.createDocument=function(t,e,n){throw new Error("This DOM method is not implemented.")},t.prototype.createHTMLDocument=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}).call(this)},function(t,e,n){(function(){var e,i,r,o,s,a,u,c={}.hasOwnProperty;u=n(6).isPlainObject,r=n(40),i=n(69),o=n(5),e=n(1),a=n(44),s=n(32),t.exports=function(t){function n(t){n.__super__.constructor.call(this,null),this.name="#document",this.type=e.Document,this.documentURI=null,this.domConfig=new i,t||(t={}),t.writer||(t.writer=new s),this.options=t,this.stringify=new a(t)}return function(t,e){for(var n in e)c.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),Object.defineProperty(n.prototype,"implementation",{value:new r}),Object.defineProperty(n.prototype,"doctype",{get:function(){var t,n,i,r;for(n=0,i=(r=this.children).length;n<i;n++)if((t=r[n]).type===e.DocType)return t;return null}}),Object.defineProperty(n.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(n.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(n.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(n.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].encoding:null}}),Object.defineProperty(n.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(n.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===e.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(n.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(n.prototype,"origin",{get:function(){return null}}),Object.defineProperty(n.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(n.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(n.prototype,"contentType",{get:function(){return null}}),n.prototype.end=function(t){var e;return e={},t?u(t)&&(e=t,t=this.options.writer):t=this.options.writer,t.document(this,t.filterOptions(e))},n.prototype.toString=function(t){return this.options.writer.document(this,this.options.writer.filterOptions(t))},n.prototype.createElement=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createTextNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createComment=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createCDATASection=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createProcessingInstruction=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createAttribute=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createEntityReference=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.importNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createElementNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementById=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.adoptNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.renameNode=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createEvent=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createNodeIterator=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.createTreeWalker=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},n}(o)}).call(this)},function(t,e,n){(function(){var e;e=n(1),n(5),t.exports=function(){function t(t,n,i){if(this.parent=t,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==n)throw new Error("Missing attribute name. "+this.debugInfo(n));this.name=this.stringify.name(n),this.value=this.stringify.attValue(i),this.type=e.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(t.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(t.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(t.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(t.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(t.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(t.prototype,"specified",{get:function(){return!0}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(t){return this.options.writer.attribute(this,this.options.writer.filterOptions(t))},t.prototype.debugInfo=function(t){return null==(t=t||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+t+"}, parent: <"+this.parent.name+">"},t.prototype.isEqualNode=function(t){return t.namespaceURI===this.namespaceURI&&(t.prefix===this.prefix&&(t.localName===this.localName&&t.value===this.value))},t}()}).call(this)},function(t,e,n){(function(){var e,i,r={}.hasOwnProperty;i=n(5),e=n(1),t.exports=function(t){function n(t){n.__super__.constructor.call(this,t),this.type=e.Dummy}return function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(t){return""},n}(i)}).call(this)},function(t,e){(function(){var e=function(t,e){return function(){return t.apply(e,arguments)}},n={}.hasOwnProperty;t.exports=function(){function t(t){var i,r,o;for(i in this.assertLegalName=e(this.assertLegalName,this),this.assertLegalChar=e(this.assertLegalChar,this),t||(t={}),this.options=t,this.options.version||(this.options.version="1.0"),r=t.stringify||{})n.call(r,i)&&(o=r[i],this[i]=o)}return t.prototype.name=function(t){return this.options.noValidation?t:this.assertLegalName(""+t||"")},t.prototype.text=function(t){return this.options.noValidation?t:this.assertLegalChar(this.textEscape(""+t||""))},t.prototype.cdata=function(t){return this.options.noValidation?t:(t=(t=""+t||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(t))},t.prototype.comment=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return this.assertLegalChar(t)},t.prototype.raw=function(t){return this.options.noValidation?t:""+t||""},t.prototype.attValue=function(t){return this.options.noValidation?t:this.assertLegalChar(this.attEscape(t=""+t||""))},t.prototype.insTarget=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.insValue=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+t);return this.assertLegalChar(t)},t.prototype.xmlVersion=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+t);return t},t.prototype.xmlEncoding=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+t);return this.assertLegalChar(t)},t.prototype.xmlStandalone=function(t){return this.options.noValidation?t:t?"yes":"no"},t.prototype.dtdPubID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdSysID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdElementValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttType=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdAttDefault=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdEntityValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.dtdNData=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t.prototype.assertLegalChar=function(t){var e,n;if(this.options.noValidation)return t;if(e="","1.0"===this.options.version){if(e=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,n=t.match(e))throw new Error("Invalid character in string: "+t+" at index "+n.index)}else if("1.1"===this.options.version&&(e=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,n=t.match(e)))throw new Error("Invalid character in string: "+t+" at index "+n.index);return t},t.prototype.assertLegalName=function(t){var e;if(this.options.noValidation)return t;if(this.assertLegalChar(t),e=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!t.match(e))throw new Error("Invalid character in name");return t},t.prototype.textEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},t.prototype.attEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},t}()}).call(this)},function(t,e,n){(function(){var e,i,r,o={}.hasOwnProperty;r=n(6).assign,e=n(1),n(23),n(24),n(21),n(22),n(19),n(29),n(30),n(31),n(43),n(25),n(27),n(26),n(28),i=n(12),t.exports=function(){function t(t){var e,n,i;for(e in t||(t={}),this.options=t,n=t.writer||{})o.call(n,e)&&(i=n[e],this["_"+e]=this[e],this[e]=i)}return t.prototype.filterOptions=function(t){var e,n,o,s,a,u,c,p;return t||(t={}),t=r({},this.options,t),(e={writer:this}).pretty=t.pretty||!1,e.allowEmpty=t.allowEmpty||!1,e.indent=null!=(n=t.indent)?n:"  ",e.newline=null!=(o=t.newline)?o:"\n",e.offset=null!=(s=t.offset)?s:0,e.dontPrettyTextNodes=null!=(a=null!=(u=t.dontPrettyTextNodes)?u:t.dontprettytextnodes)?a:0,e.spaceBeforeSlash=null!=(c=null!=(p=t.spaceBeforeSlash)?p:t.spacebeforeslash)?c:"",!0===e.spaceBeforeSlash&&(e.spaceBeforeSlash=" "),e.suppressPrettyCount=0,e.user={},e.state=i.None,e},t.prototype.indent=function(t,e,n){var i;return!e.pretty||e.suppressPrettyCount?"":e.pretty&&(i=(n||0)+e.offset+1)>0?new Array(i).join(e.indent):""},t.prototype.endline=function(t,e,n){return!e.pretty||e.suppressPrettyCount?"":e.newline},t.prototype.attribute=function(t,e,n){var i;return this.openAttribute(t,e,n),i=" "+t.name+'="'+t.value+'"',this.closeAttribute(t,e,n),i},t.prototype.cdata=function(t,e,n){var r;return this.openNode(t,e,n),e.state=i.OpenTag,r=this.indent(t,e,n)+"<![CDATA[",e.state=i.InsideTag,r+=t.value,e.state=i.CloseTag,r+="]]>"+this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),r},t.prototype.comment=function(t,e,n){var r;return this.openNode(t,e,n),e.state=i.OpenTag,r=this.indent(t,e,n)+"\x3c!-- ",e.state=i.InsideTag,r+=t.value,e.state=i.CloseTag,r+=" --\x3e"+this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),r},t.prototype.declaration=function(t,e,n){var r;return this.openNode(t,e,n),e.state=i.OpenTag,r=this.indent(t,e,n)+"<?xml",e.state=i.InsideTag,r+=' version="'+t.version+'"',null!=t.encoding&&(r+=' encoding="'+t.encoding+'"'),null!=t.standalone&&(r+=' standalone="'+t.standalone+'"'),e.state=i.CloseTag,r+=e.spaceBeforeSlash+"?>",r+=this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),r},t.prototype.docType=function(t,e,n){var r,o,s,a,u;if(n||(n=0),this.openNode(t,e,n),e.state=i.OpenTag,a=this.indent(t,e,n),a+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?a+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(a+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(a+=" [",a+=this.endline(t,e,n),e.state=i.InsideTag,o=0,s=(u=t.children).length;o<s;o++)r=u[o],a+=this.writeChildNode(r,e,n+1);e.state=i.CloseTag,a+="]"}return e.state=i.CloseTag,a+=e.spaceBeforeSlash+">",a+=this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),a},t.prototype.element=function(t,n,r){var s,a,u,c,p,h,l,d,f,y,m,g,b,v;for(f in r||(r=0),y=!1,m="",this.openNode(t,n,r),n.state=i.OpenTag,m+=this.indent(t,n,r)+"<"+t.name,g=t.attribs)o.call(g,f)&&(s=g[f],m+=this.attribute(s,n,r));if(c=0===(u=t.children.length)?null:t.children[0],0===u||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))n.allowEmpty?(m+=">",n.state=i.CloseTag,m+="</"+t.name+">"+this.endline(t,n,r)):(n.state=i.CloseTag,m+=n.spaceBeforeSlash+"/>"+this.endline(t,n,r));else if(!n.pretty||1!==u||c.type!==e.Text&&c.type!==e.Raw||null==c.value){if(n.dontPrettyTextNodes)for(p=0,l=(b=t.children).length;p<l;p++)if(((a=b[p]).type===e.Text||a.type===e.Raw)&&null!=a.value){n.suppressPrettyCount++,y=!0;break}for(m+=">"+this.endline(t,n,r),n.state=i.InsideTag,h=0,d=(v=t.children).length;h<d;h++)a=v[h],m+=this.writeChildNode(a,n,r+1);n.state=i.CloseTag,m+=this.indent(t,n,r)+"</"+t.name+">",y&&n.suppressPrettyCount--,m+=this.endline(t,n,r),n.state=i.None}else m+=">",n.state=i.InsideTag,n.suppressPrettyCount++,y=!0,m+=this.writeChildNode(c,n,r+1),n.suppressPrettyCount--,y=!1,n.state=i.CloseTag,m+="</"+t.name+">"+this.endline(t,n,r);return this.closeNode(t,n,r),m},t.prototype.writeChildNode=function(t,n,i){switch(t.type){case e.CData:return this.cdata(t,n,i);case e.Comment:return this.comment(t,n,i);case e.Element:return this.element(t,n,i);case e.Raw:return this.raw(t,n,i);case e.Text:return this.text(t,n,i);case e.ProcessingInstruction:return this.processingInstruction(t,n,i);case e.Dummy:return"";case e.Declaration:return this.declaration(t,n,i);case e.DocType:return this.docType(t,n,i);case e.AttributeDeclaration:return this.dtdAttList(t,n,i);case e.ElementDeclaration:return this.dtdElement(t,n,i);case e.EntityDeclaration:return this.dtdEntity(t,n,i);case e.NotationDeclaration:return this.dtdNotation(t,n,i);default:throw new Error("Unknown XML node type: "+t.constructor.name)}},t.prototype.processingInstruction=function(t,e,n){var r;return this.openNode(t,e,n),e.state=i.OpenTag,r=this.indent(t,e,n)+"<?",e.state=i.InsideTag,r+=t.target,t.value&&(r+=" "+t.value),e.state=i.CloseTag,r+=e.spaceBeforeSlash+"?>",r+=this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),r},t.prototype.raw=function(t,e,n){var r;return this.openNode(t,e,n),e.state=i.OpenTag,r=this.indent(t,e,n),e.state=i.InsideTag,r+=t.value,e.state=i.CloseTag,r+=this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),r},t.prototype.text=function(t,e,n){var r;return this.openNode(t,e,n),e.state=i.OpenTag,r=this.indent(t,e,n),e.state=i.InsideTag,r+=t.value,e.state=i.CloseTag,r+=this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),r},t.prototype.dtdAttList=function(t,e,n){var r;return this.openNode(t,e,n),e.state=i.OpenTag,r=this.indent(t,e,n)+"<!ATTLIST",e.state=i.InsideTag,r+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,"#DEFAULT"!==t.defaultValueType&&(r+=" "+t.defaultValueType),t.defaultValue&&(r+=' "'+t.defaultValue+'"'),e.state=i.CloseTag,r+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),r},t.prototype.dtdElement=function(t,e,n){var r;return this.openNode(t,e,n),e.state=i.OpenTag,r=this.indent(t,e,n)+"<!ELEMENT",e.state=i.InsideTag,r+=" "+t.name+" "+t.value,e.state=i.CloseTag,r+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),r},t.prototype.dtdEntity=function(t,e,n){var r;return this.openNode(t,e,n),e.state=i.OpenTag,r=this.indent(t,e,n)+"<!ENTITY",e.state=i.InsideTag,t.pe&&(r+=" %"),r+=" "+t.name,t.value?r+=' "'+t.value+'"':(t.pubID&&t.sysID?r+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(r+=' SYSTEM "'+t.sysID+'"'),t.nData&&(r+=" NDATA "+t.nData)),e.state=i.CloseTag,r+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),r},t.prototype.dtdNotation=function(t,e,n){var r;return this.openNode(t,e,n),e.state=i.OpenTag,r=this.indent(t,e,n)+"<!NOTATION",e.state=i.InsideTag,r+=" "+t.name,t.pubID&&t.sysID?r+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?r+=' PUBLIC "'+t.pubID+'"':t.sysID&&(r+=' SYSTEM "'+t.sysID+'"'),e.state=i.CloseTag,r+=e.spaceBeforeSlash+">"+this.endline(t,e,n),e.state=i.None,this.closeNode(t,e,n),r},t.prototype.openNode=function(t,e,n){},t.prototype.closeNode=function(t,e,n){},t.prototype.openAttribute=function(t,e,n){},t.prototype.closeAttribute=function(t,e,n){},t}()}).call(this)},function(t,e){(function(){"use strict";var t;t=new RegExp(/(?!xmlns)^.*:/),e.normalize=function(t){return t.toLowerCase()},e.firstCharLowerCase=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},e.stripPrefix=function(e){return e.replace(t,"")},e.parseNumbers=function(t){return isNaN(t)||(t=t%1==0?parseInt(t,10):parseFloat(t)),t},e.parseBooleans=function(t){return/^(?:true|false)$/i.test(t)&&(t="true"===t.toLowerCase()),t}}).call(this)},function(t,e,n){n(48),n(85),n(86),t.exports=n(87)},function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{u(i.next(t))}catch(t){o(t)}}function a(t){try{u(i.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}u((i=i.apply(t,e||[])).next())}))},r=this&&this.__generator||function(t,e){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var o,s=n(13),a=n(2),u=n(33),c=n(34),p=n(8),h=n(14),l=n(50),d=n(0),f=n(3),y=n(4),m=n(17),g=n(15),b=n(7),v=n(39),w=n(9),T=n(10),E="",O=function(t,e){var n=f.default.translateBy(t,o.tooltipOfs,o.tooltipOfs);o.tooltip.setVisible(!0).move(n.x,n.y).setFontSize(o.tooltipFontSize()).setText(e)},_=function(){o.sm.data.showWireConnections=!1,o.highlight.hide()},x={ArrowLeft:{x:-1,y:0},ArrowUp:{x:0,y:-1},ArrowRight:{x:1,y:0},ArrowDown:{x:0,y:1}},N=function(){o.sm.transition(p.StateType.WINDOW,p.ActionType.START),o.loadCircuit().finally((function(){o.sm.transition(p.StateType.BOARD,p.ActionType.RESUME)}))},D=function(){o.sm.transition(p.StateType.WINDOW,p.ActionType.START),o.saveCircuit(!1).finally((function(){o.sm.transition(p.StateType.BOARD,p.ActionType.RESUME)}))},I=function(t){var e,n;switch(o.tooltip.setVisible(!1),o.highlight.setVisible(!1),t){case"CtrlKeyA":T.default.$.execute(p.ActionType.SELECT_ALL,"");break;case"CtrlKeyU":T.default.$.execute(p.ActionType.UNSELECT_ALL,"");break;case"CtrlKeyS":D();break;case"CtrlKeyL":N();break;case"CtrlKeyN":o.sm.transition(p.StateType.WINDOW,p.ActionType.START),o.newCircuit().finally((function(){o.sm.transition(p.StateType.BOARD,p.ActionType.RESUME)}));break;case"CtrlKeyP":var i=o.svgBoard.cloneNode(!0),r=o.svgBoard.getBoundingClientRect(),a=o.circuit.boundariesRect();console.log(s.ipcRenderer.sendSync("print-circuit",[{width:r.width,height:r.height+20},i.outerHTML,o.getViewBoxRects(a)]));break;case"CtrlKeyH":case"F1":s.ipcRenderer.sendSync("help-circuit");break;case"Delete":T.default.$.execute(p.ActionType.DELETE_SELECTED,"");break;case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":var u=x[t];o.circuit.selectedComponents.forEach((function(t){return t.move(t.x+u.x,t.y+u.y)})),o.circuit.modified=!0,o.updateCircuitLabel(),(null===(e=o.circuit.ec)||void 0===e?void 0:e.id)==o.winProps.compId&&(null===(n=o.winProps.property("p"))||void 0===n||n.refresh())}};function C(){o.sm.register({key:p.StateType.EC_DRAG,overType:"deny",actions:{MOVE:function(t){var e,n;this.data.dragging.forEach((function(e){var n=f.default.minus(t.offset,e.offset);e.ec.move(n.x,n.y)})),o.sm.data.wires&&o.sm.data.wires.forEach((function(t){var e=t.wire.getNode(0),n=new f.default(e.x-t.start.x,e.y-t.start.y);t.wire.translate(n.x,n.y),t.start=e})),(null===(e=o.circuit.ec)||void 0===e?void 0:e.id)==o.winProps.compId&&(null===(n=o.winProps.property("p"))||void 0===n||n.refresh())},OUT:function(){},UP:function(t){d.removeClass(o.svgBoard,this.data.className),o.sm.transition(p.StateType.EC_BODY,p.ActionType.START,t,{it:o.sm.data.it})},START:function(t){var e=this.data.it,n=t.it;if(!n)throw"EC_DRAG on undefined EC";!o.circuit.selectedComponents.some((function(t){return t.id==n.id}))&&T.default.$.execute(p.ActionType.SELECT,n.id+"::"+n.name+"::body"),this.data={it:e,className:"dragging",dragging:o.circuit.selectedComponents.map((function(e){return{ec:e,offset:f.default.minus(t.offset,e.p)}}))},t.shiftKey&&(this.data.wires=m.ItemBoard.connectedWiresTo(o.circuit.selectedComponents).map((function(t){return{wire:t,start:t.points[0]}}))),o.circuit.modified=!0,o.updateCircuitLabel(),d.addClass(o.svgBoard,this.data.className),o.highlight.hide(),o.tooltip.setVisible(!1),o.rightClick.setVisible(!1)}}})}function P(){o.sm.register({key:p.StateType.WIRE_LINE,overType:"deny",actions:{KEY:I,OUT:function(t){t.it&&-1!=o.sm.data.node||(o.highlight.hide(),o.tooltip.setVisible(!1),o.sm.transition(p.StateType.BOARD,p.ActionType.RESUME),o.sm.data.showWireConnections&&_())},MOVE:function(t){if(!o.sm.data.wiringFromNode){var e=o.sm.data.it,n=t.over.line;if(o.sm.data.showWireConnections&&_(),o.sm.data.mouseDown&&0==t.button)return o.sm.data.node>=0?o.sm.transition(p.StateType.WIRE_NODE_DRAG,p.ActionType.START,t,{it:o.sm.data.it,node:o.sm.data.node}):1==n&&e.nodeBonds(0)||n==e.lastLine&&e.nodeBonds(e.last)?o.sm.transition(p.StateType.BOARD,p.ActionType.RESUME):o.sm.transition(p.StateType.WIRE_LINE_DRAG,p.ActionType.START,t,{it:o.sm.data.it,line:n}),void(o.sm.data.mouseDown=!1);o.sm.data.mouseDown=!1;var i=e.overNode(t.offset,t.over.line),r=e.getNode(i);if(r&&!(0==i&&e.nodeBonds(0)||i==e.last&&e.nodeBonds(e.last)))o.sm.data.node=i,o.highlight.show(r.x,r.y,e.id,i);else{var s=f.default.translateBy(t.offset,o.tooltipOfs,o.tooltipOfs);!o.tooltip.move(s.x,s.y).visible&&o.tooltip.setVisible(!0)}}},DOWN:function(t){if(o.tooltip.setVisible(!1),t.ctrlKey){var e=o.sm.data.it;o.sm.data.node>0&&o.sm.data.node<e.last?o.sm.data.wiringFromNode=!0:function(t){o.sm.data.showWireConnections=!0,o.highlight.showConnections(m.ItemBoard.wireConnections(t).map((function(t){return t.p})))}(e)}else o.sm.data.mouseDown=!0;window.wire=o.sm.data.it},UP:function(t){o.sm.data.wiringFromNode?o.sm.transition(p.StateType.NEW_WIRE_FROM_EC,p.ActionType.START,t,{start:{it:o.sm.data.it,node:o.sm.data.node,fromWire:!0}}):(o.rightClick.setVisible(!1),0==t.button&&o.sm.data.mouseDown&&(o.sm.data.mouseDown=!1,T.default.$.execute(t.ctrlKey?p.ActionType.TOGGLE_SELECT:p.ActionType.SELECT,[o.sm.data.it.id,o.sm.data.it.name,"body"].join("::"))),o.sm.data.showWireConnections&&_(),O(t.offset,o.sm.data.it.id))},START:function(t){o.sm.data.node=-1,o.sm.data.mouseDown=!1,o.sm.data.showWireConnections=!1,o.sm.data.wiringFromNode=!1,O(t.offset,o.sm.data.it.id)}}})}function A(t){var e=u.readFileSync(t);return JSON.parse(e.toString().replace(/[\t\r\n]*/g,""))}function S(t){a.qS("body").style.height=t.height+"px";var e=a.qS("body").offsetHeight-a.qS("body>header").offsetHeight-a.qS("body>footer").offsetHeight;a.qS("body>main").style.height=e+"px",o.board.style.height=e+"px",o.size=new g.default(t.width,t.height),o.contentHeight=e,o.updateViewBox(o.circuit.zoom)}window.addEventListener("DOMContentLoaded",(function(){s.ipcRenderer.invoke("shared-data",["app.basePath"]).then((function(t){E=t,a.templatesDOM("viewBox01|size01|point01|baseWin01|ctxWin01|ctxItem01|propWin01|dialogWin01|formWin01|formFieldWinSpan|formFieldWinInput|circuitXml").then((function(t){return i(void 0,void 0,void 0,(function(){var e;return r(this,(function(n){return(e=A(c.join(E,"data/library-circuits.v2.json"))).forEach((function(t){h.default.register(t)})),e=A(c.join(E,"data/context-menu.json")),w.Templates.register(t),w.Templates.set("circuitName",'<span class="{{ class }}">*</span><span>{{ name }}</span>'),w.Templates.set("simplePoint","{{ x }},{{ y }}"),o=new l.MyApp({includePropsInThis:!0,props:{rot_lbl:{tag:"#rot-lbl"},comp_option:{tag:"#comp-option",onChange:function(t,e){}},cons_log:{tag:"#cons-log",onChange:function(t,e){o.sm.log=t}},theme_select:{tag:'select[tool="theme-select"]',onChange:function(t,e){1==e&&document.body.className!=t&&(document.body.className=t)}}},list:e}),T.default.create(o),S(s.ipcRenderer.sendSync("get-win-size","")),o.board.appendChild(o.winProps.win),o.board.appendChild(o.rightClick.win),o.svgBoard.append(o.dash.g),o.svgBoard.append(o.selection.g),o.svgBoard.append(o.tooltip.g),o.svgBoard.append(o.highlight.g),a.qS("body>footer").insertAdjacentElement("afterend",o.dialog.win),a.qS("body>footer").insertAdjacentElement("afterend",o.form.win),a.qSA(".bar-item[data-scale]").forEach((function(t){d.aEL(t,"click",(function(t){var e=d.getParentAttr(t.target,"data-scale"),n=d.attr(e,"data-scale"),i=parseFloat(n);o.circuit.zoom!=i&&(o.circuit.modified=!0),o.updateCircuitLabel(),o.setBoardZoom(o.circuit.zoom=i)}),!1)})),d.aEL(a.qS('.bar-item[rot-dir="left"]'),"click",(function(){return o.rotateEC(-45)}),!1),d.aEL(a.qS('.bar-item[rot-dir="right"]'),"click",(function(){return o.rotateEC(45)}),!1),d.aEL(a.qS('.bar-item[action="comp-create"]'),"click",(function(){var t=o.circuit.add({name:o.prop("comp_option").value,x:o.center.x,y:o.center.y});t&&(o.addToDOM(t),o.updateCircuitLabel())}),!1),d.aEL(a.qS('.bar-item[tool="vb-focus"]'),"click",(function(){return o.updateViewBox(o.circuit.zoom,0,0)}),!1),d.aEL(a.qS('.bar-item[file="open"]'),"click",(function(){return N()}),!1),d.aEL(a.qS('.bar-item[file="save"]'),"click",(function(){return D()}),!1),d.aEL(o.circuitName,"click",(function(){var t=v.Circuit.circuitProperties(o.circuit);o.form.showDialog("Circuit Properties",t).then((function(e){0==e&&t.filter((function(t){if(!t.readonly){var e=o.circuit[t.label];return t.value!=e&&(o.circuit[t.label]=t.value,!0)}})).length&&(o.circuit.modified=!0,o.updateCircuitLabel())}))}),!1),o.sm.register({key:p.StateType.WINDOW,overType:"deny",actions:{DEFAULT:function(t){console.log(t)},START:function(t){}}}),o.sm.register({key:p.StateType.BOARD,overType:"function",persistData:!0,data:{},actions:{KEY:I,ENTER:function(t){o.sm.data.panningVector=void 0,o.sm.data.selection=!1,o.selection.hide(),o.sm.data.mouseDown=!1,d.removeClass(o.svgBoard,"dragging")},LEAVE:function(t){o.bottomBarLeft.innerHTML="&nbsp;"},OUT:function(t){},OVER:function(t){if(t.it&&!o.sm.data.panningVector&&!o.sm.data.selection&&t.it)switch(t.over.type){case"node":o.sm.transition(p.StateType.EC_NODE,p.ActionType.START,t,{it:t.it,node:t.over.node});break;case"line":t.it.editMode=!0,o.sm.transition(p.StateType.WIRE_LINE,p.ActionType.START,t,{it:t.it,line:t.over.line});break;case"body":o.sm.transition(p.StateType.EC_BODY,p.ActionType.START,t,{it:t.it})}},MOVE:function(t){if(t.shiftKey)o.sm.data.panningVector&&o.updateViewBox(o.circuit.zoom,t.client.x-o.sm.data.panningVector.x,t.client.y-o.sm.data.panningVector.y);else if(o.sm.data.panningVector=void 0,o.sm.data.mouseDown)o.sm.data.selection?o.selection.calculate(t.offset):(o.sm.data.selection=!0,o.selection.show(t.offset));else if(t.it)switch(t.over.type){case"node":console.log("move: "+t.it.id+" node: "+t.over.node);break;case"line":o.sm.transition(p.StateType.WIRE_LINE,p.ActionType.START,t,{it:t.it,line:t.over.line});break;case"body":console.log("transition on BOARD.MOVE"),o.sm.transition(p.StateType.EC_BODY,p.ActionType.START,t,{it:t.it})}},DOWN:function(t){t.shiftKey?(d.addClass(o.svgBoard,"dragging"),o.sm.data.panningVector=new f.default(t.client.x-o.viewBox.x,t.client.y-o.viewBox.y)):o.sm.data.mouseDown=!0},UP:function(t){o.sm.data.mouseDown=!1,0==t.button&&T.default.$.execute(p.ActionType.UNSELECT_ALL,""),o.rightClick.setVisible(!1),o.sm.data.panningVector&&(o.sm.data.panningVector=void 0,d.removeClass(o.svgBoard,"dragging")),o.sm.data.selection&&(o.sm.data.selection=!1,o.circuit.selectRect(o.selection.rect),o.selection.hide())},START:function(){throw"BOARD.START ILLEGAL, to catch lose code"},RESUME:function(){o.sm.data.mouseDown=!1,o.sm.data.panningVector=void 0,o.sm.data.selection=!1,o.selection.hide(),o.highlight.hide(),_()}}}),o.sm.register({key:p.StateType.EC_BODY,overType:"deny",actions:{KEY:I,MOVE:function(t){if(o.sm.data.mouseDown&&0==o.sm.data.button)o.sm.transition(p.StateType.EC_DRAG,p.ActionType.START,t,{it:o.sm.data.it});else{var e=o.sm.data.it,n=e.overNode(t.offset,0);if(-1!=n)o.tooltip.setVisible(!1),o.sm.transition(p.StateType.EC_NODE,p.ActionType.START,t,{it:e,node:n});else{var i=f.default.translateBy(t.offset,o.tooltipOfs,o.tooltipOfs);o.tooltip.move(i.x,i.y)}}},OUT:function(){o.tooltip.setVisible(!1),o.sm.transition(p.StateType.BOARD,p.ActionType.RESUME)},DOWN:function(t){o.sm.data.mouseDown=!0,o.sm.data.button=t.button},UP:function(t){var e,n;o.sm.data.mouseDown=!1,o.rightClick.setVisible(!1),0==t.button&&T.default.$.execute(t.ctrlKey?p.ActionType.TOGGLE_SELECT:p.ActionType.SELECT,[null===(e=t.it)||void 0===e?void 0:e.id,null===(n=t.it)||void 0===n?void 0:n.name,"body"].join("::"))},START:function(t){O(t.offset,o.sm.data.it.id),o.sm.data.mouseDown=!1,o.sm.data.button=t.button}}}),C(),o.sm.register({key:p.StateType.EC_NODE,overType:"deny",actions:{KEY:I,MOVE:function(t){var e=o.sm.data.it.overNode(t.offset,0),n=f.default.translateBy(t.offset,o.tooltipOfs,o.tooltipOfs);-1==e?(o.tooltip.setVisible(!1),o.sm.transition(p.StateType.BOARD,p.ActionType.RESUME)):o.tooltip.move(n.x,n.y)},UP:function(t){t.ctrlKey&&(o.tooltip.setVisible(!1),o.sm.transition(p.StateType.NEW_WIRE_FROM_EC,p.ActionType.START,t,{start:{it:o.sm.data.it,node:o.sm.data.node}}))},START:function(t){var e=o.sm.data.it,n=o.sm.data.node,i=e.getNode(n),r=i.label,s=f.default.plus(e.p,e.rotation?i.rot:i).round();o.highlight.show(s.x,s.y,e.id,n),O(t.offset,n+" -"+r)}}}),o.sm.register({key:p.StateType.NEW_WIRE_FROM_EC,overType:"function",actions:{KEY:function(t){var e;"Escape"==t&&(o.sm.data.wire.editMode=!0,null===(e=o.sm.data.selectedItem)||void 0===e||e.it.select(!1),o.highlight.hide(),o.sm.transition(p.StateType.BOARD,p.ActionType.RESUME))},UP:function(t){var e=this.data.wire;if(this.data.selectedItem){var n=this.data.selectedItem.it,i=this.data.selectedItem.node;e.editMode=!0,n.select(!1),e.bond(e.last,n,i),o.highlight.hide(),o.sm.transition(p.StateType.BOARD,p.ActionType.RESUME)}else e.setNode(e.last,t.offset),e.appendNode(t.offset)},OUT:function(t){var e;"node"==t.over.type&&(null===(e=o.sm.data.selectedItem)||void 0===e||e.it.select(!1),o.sm.data.selectedItem=void 0,o.highlight.hide())},OVER:function(t){var e=-1,n=void 0,i=t.it;if(i){switch(t.over.type){case"body":n=i.getNodeRealXY(e=i.findNode(t.offset));break;case"line":n=i.getNode(e=i.findLineNode(t.offset,t.over.line))}i.id!=o.sm.data.wire.id&&n&&(i.type!=y.Type.WIRE||0!=e&&e!=i.last)&&(o.sm.data.selectedItem&&o.sm.data.selectedItem.it.id!=i.id&&o.sm.data.selectedItem.it.select(!1),(o.sm.data.selectedItem={it:i,node:e}).it.select(!0),o.highlight.show(n.x,n.y,i.id,e))}},MOVE:function(t){var e=this.data.wire.getNode(this.data.wire.last-1),n=Math.atan2(t.offset.y-e.y,t.offset.x-e.x),i=new f.default(t.offset.x-7*Math.cos(n)|0,t.offset.y-7*Math.sin(n)|0);this.data.wire.setNode(this.data.wire.last,i)},AFTER_DELETE:function(t){o.sm.data.wire.id==t&&o.sm.transition(p.StateType.BOARD,p.ActionType.RESUME)},START:function(){var t=o.sm.data.start.it,e=o.sm.data.start.node,n=o.sm.data.start.fromWire?t.getNode(e):t.getNodeRealXY(e);o.highlight.hide(),o.sm.data.wire=o.circuit.add({name:"wire",points:[n,n]}),o.addToDOM(o.sm.data.wire),o.updateCircuitLabel(),o.sm.data.wire.bond(0,t,e),T.default.$.execute(p.ActionType.UNSELECT_ALL,""),o.sm.data.selectedItem=void 0}}}),P(),o.sm.register({key:p.StateType.WIRE_NODE_DRAG,overType:"deny",actions:{KEY:function(t){},MOVE:function(t){o.sm.data.it.setNode(o.sm.data.node,t.offset),o.highlight.show(t.offset.x,t.offset.y,o.sm.data.it.id,o.sm.data.node);var e=o.sm.data.it,n=o.sm.data.node;if(!t.ctrlKey||0!=n&&n!=e.last)o.dash.matchWireNode(o.sm.data.it,o.sm.data.node);else{var i=o.sm.data.list.filter((function(e){return e.r.inside(t.offset)})).map((function(e){var n=e.it.findNode(t.offset);return{it:e.it,node:n}})).filter((function(t){return-1!=t.node&&!(t.it.type==y.Type.WIRE&&(0==t.node||t.node==t.it.last))}))[0];i?(o.sm.data.selectedItem&&o.sm.data.selectedItem.it.id!=i.it.id&&o.sm.data.selectedItem.it.select(!1),(o.sm.data.selectedItem=i).it.select(!0)):o.sm.data.selectedItem&&o.sm.data.selectedItem.it.select(!1),o.dash.hide()}},UP:function(t){d.removeClass(o.svgBoard,this.data.className),o.highlight.hide(),o.dash.hide(),o.sm.data.selectedItem?(o.sm.data.selectedItem.it.select(!1),o.sm.data.it.bond(o.sm.data.node,o.sm.data.selectedItem.it,o.sm.data.selectedItem.node)):o.dash.match&&o.dash.wire.setNode(o.dash.node,o.dash.p),o.sm.transition(p.StateType.BOARD,p.ActionType.RESUME,t)},OUT:function(){},START:function(){d.addClass(o.svgBoard,o.sm.data.className="dragging"),o.rightClick.setVisible(!1);var t=b.default.create(o.viewBox),e=o.sm.data.it.id;o.sm.data.list=o.circuit.components.filter((function(t){return t.id!=e})).map((function(e){var n=e.rect();return t.intersect(n),{it:e,r:n}})).filter((function(t){return!t.r.empty})),o.circuit.modified=!0,o.updateCircuitLabel(),o.sm.data.selectedItem=void 0,o.sm.data.it.select(!1)}}}),o.sm.register({key:p.StateType.WIRE_LINE_DRAG,overType:"deny",actions:{MOVE:function(t){var e=this.data.line;this.data.it.setNode(e-1,f.default.minus(t.offset,this.data.A)),this.data.it.setNode(e,f.default.minus(t.offset,this.data.B)),o.dash.matchWireLine(this.data.it,e)},UP:function(t){if(d.removeClass(o.svgBoard,o.sm.data.className),o.dash.hide(),o.dash.match){var e=o.sm.data.line,n=f.default.minus(o.dash.p,o.dash.wire.getNode(o.dash.node));o.dash.wire.setNode(e-1,f.default.plus(o.dash.wire.getNode(e-1),n)),o.dash.wire.setNode(e,f.default.plus(o.dash.wire.getNode(e),n))}o.sm.transition(p.StateType.BOARD,p.ActionType.RESUME,t)},OUT:function(){},START:function(t){var e=o.sm.data.it,n=o.sm.data.line;o.sm.data.A=f.default.minus(t.offset,e.getNode(n-1)),o.sm.data.B=f.default.minus(t.offset,e.getNode(n)),d.addClass(o.svgBoard,o.sm.data.className="dragging"),o.rightClick.setVisible(!1),o.circuit.modified=!0,o.updateCircuitLabel()}}}),o.sm.enabled=!0,window.tooltip=o.tooltip,window.rc=o.rightClick,window.Rect=b.default,window.MyApp=o,window.dialog=o.dialog,console.log("We are using Node.js "+process.versions.node+", Chromium "+process.versions.chrome+", and Electron "+process.versions.electron),[2]}))}))})).catch((function(t){console.log(t)}))}))})),s.ipcRenderer.on("win-resize",(function(t,e){S(e)})),s.ipcRenderer.on("check-before-exit",(function(t,e){o?o.dialog.visible||o.form.visible||o.circuitLoadingOrSaving||o.saveCircuit(!0).then((function(t){var e=!1;switch(t){case 5:case 0:case 2:case 3:e=!0}e&&s.ipcRenderer.send("app-quit","")})):s.ipcRenderer.send("app-quit","")}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(){}return t.x=function(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},t.query=function(t,e){var n=[];for(var i in t)n.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return(e&&n.length?"?":"")+n.join("&")},t.update=function(t,e){for(var n in t)e[n]=e[n]||t[n];return e},t.send=function(e,n){return new Promise((function(i,r){var o=t.x();n=t.update(t.xobj,n),o.open(n.method,e,!0),o[t.rt]=n.responseType,o.onreadystatechange=function(){if(4==o.readyState){var e=o[t.rt]&&"json"==o[t.rt];200===o.status||304===o.status?i(e?o.response:o.responseText):r({status:o.status,d:o.response,xhr:o})}},n.method==t.sPost&&o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.onerror=function(t){r(t)};try{o.send(n.data)}catch(t){r({status:o.status,statusText:o.statusText,xhr:o})}}))},t.get=function(e,n){return(n=n||{}).method=t.sGet,e+=t.query(n.data,!0),n.data=void 0,t.send(e,n)},t.post=function(e,n){return(n=n||{}).method=t.sPost,n.data=t.query(n.data,!1),t.send(e,n)},t.sGet="GET",t.sPost="POST",t.xobj={method:t.sGet,data:void 0,responseType:"text"},t.rt="responseType",t}();e.default=i},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.MyApp=void 0;var o=n(13),s=n(51),a=n(8),u=n(2),c=n(7),p=n(15),h=n(3),l=n(53),d=n(0),f=n(54),y=n(57),m=n(58),g=n(4),b=n(59),v=n(60),w=n(61),T=n(39),E=n(83),O=n(9),_=n(10),x=function(t){function e(e){var n,i=t.call(this,e)||this;i.tooltipFontSize=function(){return Math.max(10,35*i.circuit.zoom)};var r=i,o=function(t){r.highlight.hide(),r.tooltip.setVisible(!1)},s=function(t){return new h.default(t.clientX-r.board.offsetLeft,t.clientY-r.board.offsetTop)},p=function(t){return h.default.plus(new h.default(i.viewBox.x,i.viewBox.y),h.default.times(t,r.ratioX,r.ratioY).round())},O=function(t){t.preventDefault(),t.stopPropagation();var e=[],n=t.target,i=n.parentNode,o=s(t),c={type:d.attr(i,"svg-comp"),button:t.button,client:o,offset:p(o),event:t.type.replace("mouse",""),over:{type:d.attr(n,"svg-type"),svg:n},ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,altKey:t.altKey,it:r.circuit.get(i.id)};switch(c.over.type){case"node":c.over.node=0|d.attr(c.over.svg,c.over.type);break;case"line":c.over.line=0|d.attr(c.over.svg,c.over.type);break;default:c.it&&"wire"!=c.type&&(c.over.type="body")}return e.push(u.pad(c.event,5,"&nbsp;")+" "+i.id+" "+c.type+"^"+c.over.type),e.push("state: "+a.StateType[r.sm.state]),e.push(c.offset.toString()),r.bottomBarLeft.innerHTML=e.join(", "),c};return i.viewBox=c.default.empty(),i.ratio=window.screen.width/window.screen.height,i.ratioX=1,i.ratioY=1,i.tooltip=new l.default({id:"tooltip",borderRadius:4}),i.rootDir=u.basePath(),i.board=u.qS("#board"),i.svgBoard=i.board.children[0],i.bottomBarLeft=u.qS('[bar="bottom-left"]'),i.bottomBarCenter=u.qS('[bar="bottom-center"]'),i.circuitName=u.qS('footer [circuit="name"]'),i.dash=new b.default(i),i.highlight=new v.default({}),i.selection=new w.SelectionRect(i),i.dialog=new E.DialogWindow({app:i,id:"win-dialog"}),i.form=new E.FormWindow({app:i,id:"win-form"}),i.circuit=new T.Circuit({name:"new circuit",zoom:i.getUIZoom()}),i.updateCircuitLabel(),i.winProps=new f.default({id:"win-props",x:800,y:0,size:{width:250,height:300},title:"Properties",bar:"...",content:"Aaaaa...!  lorep itsum.... whatever"}),i.sm=new y.default({id:"state-machine-01",initial:a.StateType.BOARD,states:{},log:null===(n=i.prop("cons_log"))||void 0===n?void 0:n.value,ctx:{},commonActions:{ENTER:function(t){},LEAVE:function(t){o(),r.bottomBarLeft.innerHTML="&nbsp;"},KEY:function(t){"Delete"==t&&_.default.$.execute(a.ActionType.DELETE,"")},HIDE_NODE:o,FORWARD_OVER:function(t){var e=((t.it?1==t.it.type?"EC_":"WIRE_":"")+t.over.type).toUpperCase(),n=a.StateType[e];r.sm.transition(n,a.ActionType.START,t)}}}),i.rightClick=new m.default({app:i,id:"win-rc",x:50,y:50,size:{width:200,height:250},class:"no-select",list:e.list}),d.aEL(i.svgBoard,"mouseenter",(function(t){return r.sm.send(a.ActionType.ENTER,O.call(r,t))}),!1),d.aEL(i.svgBoard,"mouseleave",(function(t){return r.sm.send(a.ActionType.LEAVE,O.call(r,t))}),!1),d.aEL(i.svgBoard,"mouseover",(function(t){return r.sm.send(a.ActionType.OVER,O.call(r,t))}),!1),d.aEL(i.svgBoard,"mousemove",(function(t){return r.sm.send(a.ActionType.MOVE,O.call(r,t))}),!1),d.aEL(i.svgBoard,"mouseout",(function(t){return r.sm.send(a.ActionType.OUT,O.call(r,t))}),!1),d.aEL(i.svgBoard,"mousedown",(function(t){return r.sm.send(a.ActionType.DOWN,O.call(r,t))}),!1),d.aEL(i.svgBoard,"mouseup",(function(t){return r.sm.send(a.ActionType.UP,O.call(r,t))}),!1),d.aEL(i.svgBoard,"contextmenu",(function(t){t.stopPropagation();var e,n=t.target,i=n.parentNode,o=d.attr(i,"id"),a=d.attr(i,"svg-comp"),u=d.attr(n,"svg-type"),c=parseInt(d.attr(n,u)),h=s(t);"h-node"==a&&(o=r.highlight.selectedId,a=r.circuit.get(o).type==g.Type.WIRE?"wire":"ec",r.highlight.selectedNode),(e=r.rightClick.setTrigger(o,a,u,isNaN(c)?void 0:c))&&r.rightClick.build(e,r.sm.state,p(h)).movePoint(h).setVisible(!0)}),!1),document.addEventListener("keydown",(function(t){if(!r.dialog.visible){var e=t.code;switch(t.code){case"Enter":case"Escape":case"Space":case"Delete":case"ArrowLeft":case"ArrowUp":case"ArrowRight":case"ArrowDown":case"F1":break;case"KeyA":case"KeyU":case"KeyC":case"KeyV":case"KeyS":case"KeyL":case"KeyN":case"KeyP":case"KeyZ":case"KeyY":case"KeyH":t.ctrlKey&&(e="Ctrl"+e);break;default:return}r.sm.send(a.ActionType.KEY,e)}}),!1),i}return r(e,t),Object.defineProperty(e.prototype,"boardOffsetLeft",{get:function(){return this.board.offsetLeft},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"boardOffsetTop",{get:function(){return this.board.offsetTop},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tooltipOfs",{get:function(){return 15},enumerable:!1,configurable:!0}),e.prototype.insideBoard=function(t){return t.x>0&&t.y>0&&t.x<this.viewBox.width&&t.y<this.viewBox.height},e.prototype.getUIZoom=function(){var t=u.qS(".bar-item[data-scale].selected"),e=d.attr(t,"data-scale");return parseFloat(e)},e.prototype.setBoardZoom=function(t){u.qSA(".bar-item[data-scale].selected").forEach((function(t){d.removeClass(t,"selected")})),d.addClass(u.qS('[data-scale="'+t+'"]'),"selected"),this.updateViewBox(t)},e.prototype.updateCircuitLabel=function(){this.circuitName.innerHTML=O.Templates.nano("circuitName",{name:this.circuit.name,class:this.circuit.modified?"":"hide"})},e.prototype.updateViewBox=function(t,e,n){this.baseViewBox=new p.default(this.board.clientWidth*this.ratio|0,this.board.clientHeight*this.ratio|0),this.viewBox.width=this.baseViewBox.width*t|0,this.viewBox.height=this.baseViewBox.height*t|0,N.call(this,e,n)},e.prototype.getViewBoxRects=function(t){var e=this,n=function(n,i){return{zoom:T.Circuit.zoomFactors[i],rect:new c.default(t.x,t.y,e.baseViewBox.width*n,e.baseViewBox.height*n)}},i=T.Circuit.zoomMultipliers.map(n).filter((function(e){return e.rect.contains(t)}));return i.length?i:[n(T.Circuit.zoomMultipliers[0],0)]},e.prototype.refreshViewBoxData=function(){this.bottomBarCenter.innerHTML=O.Templates.nano("viewBox01",this.viewBox)+"&nbsp; "},e.prototype.getAspectRatio=function(t,e){var n=t/e;return Math.abs(n-4/3)<Math.abs(n-16/9)?"4:3":"16:9"},e.prototype.rotateEC=function(t){this.rotateComponentBy(t,this.circuit.ec)},e.prototype.rotateComponentBy=function(t,e){e&&e.type==g.Type.EC&&(e.rotation!=e.rotate(e.rotation+t).rotation&&(this.circuit.modified=!0,this.updateCircuitLabel()),this.refreshRotation(e))},e.prototype.refreshRotation=function(t){var e,n=t&&t.type==g.Type.EC,i=n?t.rotation:0;this.prop("rot_lbl").value=" "+i+"",n&&this.winProps.compId==(null==t?void 0:t.id)&&(null===(e=this.winProps.property("rotation"))||void 0===e||e.refresh())},e.prototype.addToDOM=function(t){switch(t.type){case g.Type.EC:this.svgBoard.insertBefore(t.g,this.tooltip.g);break;case g.Type.WIRE:this.dash.g.insertAdjacentElement("afterend",t.g);break;default:return!1}return t.afterDOMinserted(),!0},e.prototype.saveDialogIfModified=function(){var t=this;return this.circuit.modified?this.dialog.showDialog("Confirm","You have unsaved work!",["Save","Cancel","Don't Save"]).then((function(e){return 0==e?t.circuit.save():Promise.resolve(e)})):Promise.resolve(3)},e.prototype.newCircuit=function(){var t=this,e=T.Circuit.circuitProperties(),n=e.find((function(t){return"path"==t.label})),i=e.find((function(t){return"filename"==t.label}));return n&&(n.visible=!1),i&&(i.visible=!1),this.circuitLoadingOrSaving=!0,this.saveDialogIfModified().then((function(n){return t.updateCircuitLabel(),0==n||2==n||3==n?t.form.showDialog("New Circuit",e).then((function(n){if(0==n){console.log(e);var i=new T.Circuit({name:e[0].value,description:e[1].value,zoom:t.getUIZoom()});t.circuit.destroy(),t.circuit=i,t.updateViewBox(i.zoom,i.view.x,i.view.y),i.modified=!1,t.updateCircuitLabel(),n=4}return t.circuitLoadingOrSaving=!1,Promise.resolve(n)})):(t.circuitLoadingOrSaving=!1,Promise.resolve(n))})).catch((function(e){return t.circuitLoadingOrSaving=!1,t.dialog.showMessage(e.name,e.message).then((function(){return Promise.resolve(5)}))}))},e.prototype.saveCircuit=function(t){var e=this;return(t?this.saveDialogIfModified():this.circuit.save()).then((function(t){return e.updateCircuitLabel(),Promise.resolve(t)}))},e.prototype.loadCircuit=function(){var t=this;return this.circuitLoadingOrSaving=!0,this.saveDialogIfModified().then((function(e){if(t.updateCircuitLabel(),0==e||2==e||3==e){var n=o.ipcRenderer.sendSync("openFile","");if(n.error)console.log(n),e=5;else if(n.canceled)console.log(n),e=1;else if(n.data){var i=T.Circuit.load({filePath:n.filePath,data:n.data});t.circuit.destroy(),t.circuit=i,t.setBoardZoom(i.zoom),t.circuit.components.forEach((function(e){return t.addToDOM(e)})),t.updateViewBox(i.zoom,i.view.x,i.view.y),i.modified=!1,t.updateCircuitLabel(),e=4}else console.log(n),e=5}return t.circuitLoadingOrSaving=!1,Promise.resolve(e)})).catch((function(e){return t.circuitLoadingOrSaving=!1,t.dialog.showMessage(e.name,e.message).then((function(){return Promise.resolve(5)}))}))},e}(s.Application);function N(t,e){var n=!1;null!=t&&(this.viewBox.x=t,n=!0),null!=e&&(this.viewBox.y=e,n=!0),d.attr(this.svgBoard,{viewBox:this.viewBox.x+" "+this.viewBox.y+" "+this.viewBox.width+" "+this.viewBox.height}),this.ratioX=this.viewBox.width/this.svgBoard.clientWidth,this.ratioY=this.viewBox.height/this.svgBoard.clientHeight,this.center=new h.default(Math.round(this.viewBox.x+this.viewBox.width/2),Math.round(this.viewBox.y+this.viewBox.height/2)),this.refreshViewBoxData(),n&&(this.circuit.view=new h.default(this.viewBox.x,this.viewBox.y),this.circuit.modified=!0,this.updateCircuitLabel())}e.MyApp=x},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Application=void 0;var i=n(52),r=n(0),o=function(){function t(t){var e=this;this.settings=r.extend({},t),this.settings.props=new Map,Object.keys(t.props).forEach((function(n){e.add(t.props[n],n)&&t.includePropsInThis&&r.dP(e,n,{get:function(){return e.prop(n)}})}))}return t.prototype.has=function(t){return this.settings.props.has(t)},t.prototype.add=function(t,e){var n=new i.default(t);return!e&&(e=n.id),!this.has(e)&&(this.settings.props.set(e,n),!0)},t.prototype.prop=function(t){return this.settings.props.get(t)},t}();e.Application=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=n(2),o=function(){function t(e){var n=this;if(this.settings={type:"text",selected:!1,editable:!1,getter:"value",htmlSelect:!1,selectCount:1,selectMultiple:!1},!e||!(this.settings.html=i.isElement(e.tag)?e.tag:r.qS(e.tag)))throw"wrong options";switch(this.onChange=e.onChange,this.settings.toStringFn=e.toStringFn,this.html.dab=this,this.settings.tag=e.tag,this.settings.name=this.html.getAttribute("name"),this.settings.id=this.html.id||i.attr(this.html,"prop-id")||"property"+t._propId++,this.nodeName){case"input":switch(this.settings.type=this.html.type.toLowerCase(),this.settings.editable=!0,this.type){case"radio":case"checkbox":this.settings.type="boolean",this.settings.getter="checked";break;case"submit":case"button":throw"HTML input tag type invalid";case"text":case"number":break;case"password":case"hidden":default:this.settings.type="text"}break;case"textarea":this.settings.type="text",this.settings.editable=!0;break;case"select":switch(this.settings.htmlSelect=!0,this.html.type.toLowerCase()){case"select-one":this.settings.getter="selectedIndex";break;case"select-multiple":this.settings.getter="selectedOptions",this.settings.selectMultiple=!0}this.settings.type="integer";var o=-1;this.settings.selectCount=this.html.length,i.dP(this,"index",{get:function(){return o},set:function(t){t>=0&&t<this.settings.selectCount&&(-1!=o&&(this.html.options[o].selected=!1),this.html.options[o=t].selected=!0,this.selectionUiChanged())}}),i.dP(this,"selectedOption",{get:function(){return n.html.options[n.html.selectedIndex]}});break;default:if(!(t.textOnly.indexOf(this.nodeName)>=0))throw"Unsupported HTML tag: "+this.nodeName;this.settings.getter="innerText"}this.html.addEventListener("change",this.selectionUiChanged)}return Object.defineProperty(t.prototype,"id",{get:function(){return this.settings.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.settings.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.settings.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tag",{get:function(){return this.settings.tag},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"html",{get:function(){return this.settings.html},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"editable",{get:function(){return this.settings.editable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodeName",{get:function(){return this.html.nodeName.toLowerCase()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onChange",{get:function(){return this.settings.onChange},set:function(t){i.isFn(t)&&(this.settings.onChange=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){var t=this.html[this.settings.getter];if(this.settings.htmlSelect)return this.settings.selectMultiple?[].map.call(t,(function(t){return t.value})):this.html.options[t].value;switch(this.type){case"integer":return isNaN(t=parseInt(t))?0:t;case"number":return isNaN(t=parseFloat(t))?0:t}return t},set:function(t){if(this.settings.htmlSelect)if(this.settings.selectMultiple){var e=i.splat(t).map((function(t){return t+""}));[].forEach.call(this.html.options,(function(t){e.indexOf(t.value)>=0&&(t.selected=!0)}))}else i.isStr(this.value)&&(t=[].findIndex.call(this.html.options,(function(e){return e.value==t}))),this.html.selectedIndex=0|t;else{var n=i.typeOf(t);("text"==this.type&&"string"==n||"boolean"==this.type&&"boolean"==n||"integer"==this.type&&i.isInt(t)||"number"==this.type&&i.isNumeric(t))&&(this.html[this.settings.getter]=t)}this.selectionUiChanged(null)},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.settings.toStringFn?this.settings.toStringFn():this.id+": "+this.value},t.prototype.selectionUiChanged=function(e){var n=this instanceof t?this:this.dab;n&&n.onChange&&n.onChange(n.value,e?1:2,n,e)},t.textOnly="a|abbr|acronym|b|bdo|big|cite|code|dfn|em|i|kbd|label|legend|li|q|samp|small|span|strong|sub|sup|td|th|tt|var".split("|"),t._propId=1,t}();e.default=o},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(2),a=n(4),u=function(t){function e(e){var n=t.call(this,e)||this;return n.svgRect=s.tag("rect","",{x:0,y:0,rx:n.borderRadius}),n.g.insertBefore(n.svgRect,n.t),n}return r(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return a.Type.TOOLTIP},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"borderRadius",{get:function(){return this.settings.borderRadius},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var t=this.t.getBBox();return o.obj({width:Math.round(t.width)+10,height:Math.round(t.height)+this.gap})},enumerable:!1,configurable:!0}),e.prototype.setVisible=function(e){return t.prototype.setVisible.call(this,e),this.text=this.t.innerHTML="",this},e.prototype.setBorderRadius=function(t){return this.settings.borderRadius=0|t,this.build()},e.prototype.build=function(){this.gap=Math.round(this.fontSize/2)+1,o.attr(this.t,{"font-size":this.fontSize,x:Math.round(this.gap/2),y:this.fontSize});var t=this.size;return o.attr(this.svgRect,{width:t.width,height:t.height,rx:this.borderRadius}),this},e.prototype.setText=function(t){var e=o.isStr(t)?t.split(/\r?\n/):t,n=[];return this.t.innerHTML=e.map((function(t,e){var i="",r="";return o.isStr(t)?i=t:o.pojo(t)&&(i=t.text,r=s.map(s.filter(t,(function(t,e){return"text"!=e})),(function(t,e){return e+'="'+t+'"'})).join("")),n.push(i),'<tspan x="5" dy="'+e+'.1em"'+r+">"+i+"</tspan>"})).join(""),this.text=n.join("\r\n"),this.build()},e.prototype.propertyDefaults=function(){return o.extend(t.prototype.propertyDefaults.call(this),{name:"tooltip",class:"tooltip",borderRadius:4})},e}(n(35).Label);e.default=u},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(8),a=n(2),u=n(3),c=n(55),p=n(37),h=n(10),l=function(t){function e(e){var n=t.call(this,e)||this,i=n.win.querySelector("header"),r=n.win.querySelector("footer");n.titleHTML=i.children[0],n.titleButtons=i.children[1],n.settings.main=n.win.querySelector("main"),n.barTitle=r.children[0],n.barButtons=r.children[1],n.setTitle(n.settings.title),n.setText(n.settings.content),n.setBar(n.settings.bar),n.win.__win=n;var s=n;return o.aEL(n.titleButtons.querySelector("img:nth-of-type(1)"),"click",(function(t){t.stopPropagation(),o.toggleClass(s.win,"collapsed"),s.setVisible(!0)}),!1),o.aEL(n.titleButtons.querySelector("img:nth-of-type(2)"),"click",(function(t){t.stopPropagation(),s.setVisible(!1)}),!1),function(t){var e=0,n=0;function i(i){(i=i||window.event).preventDefault();var r=d(t,i.clientX-e-h.default.$.app.boardOffsetLeft,i.clientY-n-h.default.$.app.boardOffsetTop),o=r.x,s=r.y;t.move(o,s)}function r(){document.removeEventListener("mouseup",r,!1),document.removeEventListener("mousemove",i,!1),o.removeClass(t.titleHTML,"dragging")}t.titleHTML.addEventListener("mousedown",(function(s){(s=s||window.event).preventDefault(),e=s.offsetX,n=s.offsetY,document.addEventListener("mouseup",r,!1),document.addEventListener("mousemove",i,!1),o.addClass(t.titleHTML,"dragging")}),!1)}(n),n}return r(e,t),Object.defineProperty(e.prototype,"compId",{get:function(){return this.settings.compId},enumerable:!1,configurable:!0}),e.prototype.setTitle=function(e){return this.titleHTML.innerText=t.prototype.setTitle.call(this,e).title,this},Object.defineProperty(e.prototype,"main",{get:function(){return this.settings.main},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.settings.content},enumerable:!1,configurable:!0}),e.prototype.setText=function(t){return this.main.innerText=this.settings.content=t,this},e.prototype.setTextHtml=function(t){return this.main.innerHTML=t,this},Object.defineProperty(e.prototype,"bar",{get:function(){return this.settings.bar},enumerable:!1,configurable:!0}),e.prototype.setBar=function(t){return this.barTitle.innerText=this.settings.bar=t,this},e.prototype.onMouseEnter=function(t){h.default.$.transition(s.StateType.WINDOW,s.ActionType.START),this.settings.offset&&(this.settings.offset=new u.default(t.offsetX,t.offsetY))},e.prototype.onMouseLeave=function(t){h.default.$.transition(s.StateType.BOARD,s.ActionType.RESUME),this.renderBar("")},e.prototype.setVisible=function(e){if(t.prototype.setVisible.call(this,e).visible){var n=d(this,this.x,this.y),i=n.x,r=n.y;this.move(i,r)}return this},e.prototype.renderBar=function(t){this.setBar("("+this.x+", "+this.y+") "+t)},e.prototype.clear=function(){return this.setTextHtml(""),this.settings.compId="",this.settings.properties=[],this.setVisible(!1),this},e.prototype.appendStringChild=function(t){return this.main.appendChild(a.html(t)),this},e.prototype.appendHtmlChild=function(t){return t&&this.main.appendChild(t),this},e.prototype.load=function(t){var e=this;return!!t&&(this.clear(),this.settings.compId=t.id,t.properties().forEach((function(n){e.appendPropChild(new c.default(t,n,(function(t){h.default.$.app.circuit.modified=!0,h.default.$.app.updateCircuitLabel()}),!0))})),this.setVisible(!0),!0)},e.prototype.refresh=function(){this.compId&&this.settings.properties.forEach((function(t){return t.refresh()}))},e.prototype.appendPropChild=function(t){return t&&(this.main.appendChild(t.html),this.settings.properties.push(t)),this},e.prototype.property=function(t){return this.settings.properties.find((function(e){return e.name==t}))},e.prototype.propertyDefaults=function(){return o.extend(t.prototype.propertyDefaults.call(this),{class:"win props no-select",templateName:"propWin01",title:"Window",content:"",bar:"",selected:!1,properties:[],compId:""})},e}(p.default);function d(t,e,n){return{x:o.clamp(e,0,h.default.$.app.size.width-t.win.offsetWidth),y:o.clamp(n,0,h.default.$.app.contentHeight-t.win.offsetHeight)}}e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(56),r=n(2),o=n(0),s=function(){function t(t,e,n,s){var a=this;this.ec=t,this.name=e,this.onChange=n;var u=t.prop(e);if(!u)throw"invalid ec: "+t.id+", prop: "+e;(this.editable=(this.valueObject="object"==typeof u)&&!u.readonly)&&"unit"==u.valueType&&(this.unit=new i.default(u.value));var c,p=this.valueObject?u:void 0,h=this;if(this.refresh=function(){if(p&&p.value)switch(h.propValue=p.value,c.nodeName){case"INPUT":c.value=h.propValue;break;case"SPAN":c.innerText=h.propValue}else console.log("hhhmmmm")},this.editable){switch(this.propValue=p.value,p.type){case"select":var l=[].map.call(p.options,(function(t){return'<option value="'+t+'"'+(a.propValue==t?" selected":"")+">"+t+"</option>"})).join("");c=r.html('<select class="prop">'+l+"</select>");break;default:c=r.html('<input class="prop" value="'+this.value+'">')}this.onChange&&c.addEventListener("change",(function(){var t;"INPUT"==c.nodeName?h.propValue=c.value:h.propValue=c.selectedOptions[0].value,h.unit&&(h.unit=new i.default(h.propValue)),p.isProperty?!p.setValue(h.propValue)&&h.refresh():p.value=h.propValue,document.activeElement.blur(),null===(t=h.onChange)||void 0===t||t.call(h,h.value)}))}else{this.propValue=p?p.value:u;var d=["prop"];this.valueObject&&p.readonly&&d.push("readonly"),this.valueObject&&p.class&&d.push(p.class),c=r.html('<span class="'+d.join(" ")+'">'+this.propValue+"</span>")}if(this.html=document.createElement("div"),this.html.classList.add("ec-container"),s){var f=p&&p.label?p.label:e;this.html.appendChild(r.html('<span class="label">'+f+"</span>"))}if(p&&"rotation"==p.type){var y=document.createElement("div");y.classList.add("rot"),y.appendChild(r.html('<img src="../img/rot-left-16x16-p2.png" rot-angle="-45" title="Rotate left"/>')),y.appendChild(c),y.appendChild(r.html('<img src="../img/rot-right-16x16-p2.png" rot-angle="45" title="Rotate right"/>')),this.html.appendChild(y),y.querySelectorAll(".rot>img").forEach((function(t){o.aEL(t,"click",(function(t){console.log(t.target.getAttribute("rot-angle"))}),!1)}))}else this.html.appendChild(c)}return Object.defineProperty(t.prototype,"value",{get:function(){return this.unit?this.unit.toString():this.propValue},enumerable:!1,configurable:!0}),t.prototype.refresh=function(){},t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),r=function(){function t(e){var n=this;if(this.toString=function(){return""+n.value+n.prefix+n.unit},!i.isStr(e)||!(e=e.trim()))throw"number "+e+" must be a not empty string";var r=e.length-1,o=function(){return"invalid number: "+e},s=function(t,e,n){return t.indexOf(n?e.toUpperCase():e)};if(this.settings={unit:-1,prefix:-1,value:NaN},(this.settings.unit=t.unitNames.findIndex((function(t){return e.toUpperCase().endsWith(t.toUpperCase())})))>=0)r-=t.unitNames[this.settings.unit].length;else{if(!((this.settings.unit=s(t.unitSymbols,e[r],0))>=0||(this.settings.unit=s(t.unitSymbols,e[r],1))>=0))throw o();r--}if(-1==(this.settings.prefix=t.prefixSymbols.indexOf(e[r]))&&(this.settings.prefix=10,r++),isNaN(parseInt(e[r-1])))throw o();this.settings.value=parseFloat(e.substr(0,r))}return Object.defineProperty(t.prototype,"name",{get:function(){return t.unitNames[this.settings.unit]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"unit",{get:function(){return t.unitSymbols[this.settings.unit]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"prefix",{get:function(){return t.prefixSymbols[this.settings.prefix]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exponent",{get:function(){return Math.pow(10,t.prefixExponents[this.settings.prefix])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.settings.value},enumerable:!1,configurable:!0}),t.split=function(t){return t.split("|")},t.prefixSymbols=t.split("y|z|a|f|p|n||m|c|d||da|h|k|M|G|T|P|E|Z|Y"),t.prefixExponents=[-24,-21,-18,-15,-12,-9,-6,-3,-2,-1,0,1,2,3,6,9,12,15,18,21,24],t.unitNames=t.split("Ampere|Volt|Ohm|Farad|Watt|Henry|Meter"),t.unitSymbols=t.split("A|V||F|W|H|m"),t}();e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(8),r=n(2),o=n(0);function s(t,e){var n,r=this.getState(this.stateName),o=i.ActionType[t],s="  ::"+o;if(t==i.ActionType.OVER)switch(r.overType){case"deny":return this.log&&console.log(s+" -> deny"),!0;case"forward":n=this.settings.commonActions.get(o="FORWARD_OVER");break;case"function":n=r.actions[o]}else n=r.actions[o]||this.settings.commonActions.get(o)||r.actions[o="DEFAULT"];if(this.log&&s!=this.sendCmd){var a="  ::"+o;t==i.ActionType.ENTER&&console.log("["+this.stateName+"]"),console.log((this.sendCmd=s)+(s!=a?" -> "+a:"")+(n?"":" not found"))}return null==n||n.call(this,e),!!n}var a=function(){function t(t){var e=this;this.settings=o.obj({id:t.id,initial:i.StateType[t.initial],state:t.initial,enabled:!1,stateList:new Map,log:!!t.log||!1}),r.each(t.states,(function(t,n){!t.key&&(t.key=i.StateType[n]),e.register(t)})),this.settings.commonActions=new Map,r.each(t.commonActions,(function(t,n){e.settings.commonActions.set(n,t)})),this.sendCmd="",this.log&&console.log("["+this.stateName+"]"),this.transitioning=!1}return Object.defineProperty(t.prototype,"id",{get:function(){return this.settings.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"initial",{get:function(){return this.settings.initial},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this.settings.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stateName",{get:function(){return i.StateType[this.state]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"enabled",{get:function(){return this.settings.enabled},set:function(t){this.settings.enabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){var t=this.getState(this.stateName);return t?t.data:void 0},set:function(t){var e=this.getState(this.stateName);e&&(e.data=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"log",{get:function(){return this.settings.log},set:function(t){(this.settings.log=!!t)&&console.log("["+this.stateName+"]")},enumerable:!1,configurable:!0}),t.prototype.getState=function(t){return this.settings.stateList.get(t)},t.prototype.send=function(t,e){return this.transitioning&&console.log("action: "+i.ActionType[t]+" discarded while transitioning to a new state"),s.call(this,t,e)},t.prototype.transition=function(t,e,n,r){this.transitioning=!0;var o=i.StateType[t],a=this.getState(o);if(this.log&&console.log("["+o+"]"+(a?"":" not found!")+(this.state==t?" same state":"")),!a||!this.enabled)return!1;this.settings.state=t,null==r?!a.persistData&&null!=this.data&&(this.data=void 0):this.data=r;var u=s.call(this,e,n);return this.transitioning=!1,u},t.prototype.register=function(t){var e=i.StateType[null==t?void 0:t.key];return!(!t||this.getState(e))&&(!t.data&&(t.data=void 0),this.settings.stateList.set(e,t),!0)},t}();e.default=a},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(8),s=n(2),a=n(0),u=n(3),c=n(37),p=n(9),h=n(10),l=function(t){function e(e){var n=t.call(this,e)||this;n.settings.list=new Map,s.each(e.list,(function(t,e){t.forEach((function(t){t.action=o.ActionType[t.name],t.enabled&&(t.enabled=t.enabled.map((function(t){return o.StateType[t]})))})),n.settings.list.set(e,t)})),n.settings.current="board",n.settings.offset=u.default.origin;var i=n;return a.aEL(n.win,"click",(function(t){var e=a.getParentAttr(t.target,"data-action"),n=0|a.attr(e,"data-action"),r=a.attr(e,"data-data"),o=e.hasAttribute("disabled"),s=a.attr(e.parentElement,"data-trigger");e&&!o&&(i.setVisible(!1),r&&(s+="::"+r),h.default.$.execute(n,s))}),!1),n}return r(e,t),Object.defineProperty(e.prototype,"offset",{get:function(){return this.settings.offset},enumerable:!1,configurable:!0}),e.prototype.onMouseEnter=function(t){},e.prototype.onMouseLeave=function(t){h.default.$.transition(o.StateType.BOARD,o.ActionType.RESUME)},e.prototype.setVisible=function(e){return!t.prototype.setVisible.call(this,e).visible&&this.win.setAttribute("data-trigger",""),this},e.prototype.setTrigger=function(t,e,n,i){var r;switch(n){case"node":r=("wire"==e?"wire-":"ec-")+n;break;case"board":r=n;break;case"body":r="ec-"+n;break;case"line":r="wire-"+n;break;default:if(!t||!e)return;r="ec-"+(n="body")}return this.win.setAttribute("data-trigger",""+[t,e,n,i].join("::")),r},e.prototype.build=function(t,e,n){var i=this.settings.list.get(t);return i?(this.settings.current=t,this.clear(),this.win.innerHTML=i.map((function(t){var n=a.clone(t);return t.enabled&&!t.enabled.some((function(t){return t==e}))&&(n.disabled="disabled"),p.Templates.nano("ctxItem01",n)})).join(""),this.settings.offset=n):this.settings.offset=u.default.origin,this},e.prototype.propertyDefaults=function(){return a.extend(t.prototype.propertyDefaults.call(this),{class:"win ctx",ignoreHeight:!0,templateName:"ctxWin01"})},e}(c.default);e.default=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(3),r=n(2),o=n(0),s=function(){function t(t){this.app=t;var e=function(t){return r.tag("line",t,{class:"dash hide",x1:0,y1:0,x2:0,y2:0,"stroke-dasharray":"3, 3"})};this.g=r.tag("g","",{}),this.g.appendChild(this.line0=e("line0")),this.g.appendChild(this.line1=e("line1"))}return t.prototype.hide=function(){o.addClass(this.line0,"hide"),o.addClass(this.line1,"hide")},t.prototype.calculate=function(t,e,n){if(!n)return 0;var r=i.default.minus(n,e);return Math.abs(r.x)<3?(o.attr(t,{x1:e.x=n.x,y1:0,x2:e.x,y2:this.app.viewBox.height}),1):Math.abs(r.y)<3?(o.attr(t,{x1:0,y1:e.y=n.y,x2:this.app.viewBox.width,y2:e.y}),-1):0},t.prototype.matchWireLine=function(t,e){return this.hide(),this.p=i.default.create(t.getNode(this.node=e)),!(!this.calculate(this.line0,this.p,t.getNode(e+1))&&(this.p=i.default.create(t.getNode(this.node=--e)),!this.calculate(this.line0,this.p,t.getNode(--e))))&&(this.wire=t,o.removeClass(this.line0,"hide"),this.match=!0)},t.prototype.matchWireNode=function(t,e){this.hide(),this.p=i.default.create(t.getNode(e));var n=this.calculate(this.line0,this.p,t.getNode(e-1)),r=this.calculate(this.line1,this.p,t.getNode(e+1));return n|r?(this.wire=t,this.node=e,n&&o.removeClass(this.line0,"hide"),r&&o.removeClass(this.line1,"hide"),this.match=!0):this.match=!1},t}();e.default=s},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(16),s=n(4),a=n(0),u=n(2),c=function(t){function e(e){var n=this;return e.selectedNode=-1,e.selectedId="",e.id="highlighNode",(n=t.call(this,e)||this).g.setAttribute("svg-comp","h-node"),n.mainNode=u.tag("circle","",{"svg-type":"node",r:n.radius}),n.g.append(n.mainNode),n}return r(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return s.Type.HIGHLIGHT},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this.settings.radius},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedId",{get:function(){return this.settings.selectedId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectedNode",{get:function(){return this.settings.selectedNode},enumerable:!1,configurable:!0}),e.prototype.setRadius=function(t){return this.mainNode.setAttribute("r",this.settings.radius=t<=0?5:t),this},e.prototype.hide=function(){return this.g.classList.add("hide"),this.mainNode.classList.remove("hide"),this.g.innerHTML="",this.g.append(this.mainNode),this},e.prototype.show=function(t,e,n,i){return this.move(t,e),a.attr(this.mainNode,{cx:this.x,cy:this.y,node:this.settings.selectedNode=i}),this.settings.selectedId=n,this.g.classList.remove("hide"),this},e.prototype.showConnections=function(t){var e=this;return this.mainNode.classList.add("hide"),this.g.classList.remove("hide"),t.forEach((function(t){var n=u.tag("circle","",{cx:t.x,cy:t.y,r:e.radius,class:"node"});e.g.append(n)})),this},e.prototype.propertyDefaults=function(){return a.extend(t.prototype.propertyDefaults.call(this),{name:"h-node",class:"h-node",visible:!1,radius:5})},e}(o.default);e.default=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SelectionRect=void 0;var i=n(3),r=n(7),o=n(2),s=n(0),a=function(){function t(t){this.app=t,this.g=o.tag("rect","selection-rect",{class:"dash",x:0,y:0,width:0,height:0,"stroke-dasharray":"3, 3"}),this.hide()}return t.prototype.show=function(t){return this.start=t,this.rect=new r.default(t.x,t.y,0,0),this.g.classList.remove("hide"),this},t.prototype.hide=function(){return this.start=new i.default(0,0),this.rect=new r.default(0,0,0,0),this.g.classList.add("hide"),this.refresh()},t.prototype.refresh=function(){return s.attr(this.g,{x:this.rect.x,y:this.rect.y,width:this.rect.width,height:this.rect.height}),this},t.prototype.calculate=function(t){var e=Math.min(this.start.x,t.x),n=Math.min(this.start.y,t.y),i=Math.max(this.start.x,t.x),r=Math.max(this.start.y,t.y);return this.rect.x=e,this.rect.y=n,this.rect.width=i-e,this.rect.height=r-n,this.refresh()},t}();e.SelectionRect=a},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(2),a=n(4),u=n(3),c=n(63),p=n(35),h=function(t){function e(e,n){var i=t.call(this,e,n)||this;i.g.innerHTML=i.base.data;var r=function(t,e){var n=s.tag("text","",t);return n.innerHTML=e,n};if(i.base.meta.label&&o.aCld(i.g,r({x:i.base.meta.label.x,y:i.base.meta.label.y,class:i.base.meta.label.class},i.base.meta.label.text)),i.base.meta.nodes.createLabels)for(var a=i.count/2,u=55,c=7,h=0,l=20;u>0;u-=44,c+=l=-l)for(var d=0;d<a;d++,h++,c+=l)o.aCld(i.g,r({x:c,y:u},h+""));return i.base.meta.labelId&&(i.labelSVG=new p.Label({fontSize:15,x:i.base.meta.labelId.x,y:i.base.meta.labelId.y}),i.labelSVG.setText(i.label)),i.refresh(),i.onProp&&i.onProp({id:"#"+i.id,args:{id:i.id,name:i.name,x:i.x,y:i.y,rotation:i.rotation},method:"create",where:1}),i}return r(e,t),Object.defineProperty(e.prototype,"last",{get:function(){return this.base.meta.nodes.list.length-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return a.Type.EC},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this.base.meta.nodes.list.length},enumerable:!1,configurable:!0}),e.prototype.rotate=function(e){return t.prototype.rotate.call(this,e),this.refresh()},e.prototype.move=function(e,n){return t.prototype.move.call(this,e,n),this.refresh()},e.prototype.refresh=function(){var t=this,e={transform:"translate("+this.x+" "+this.y+")"},n=this.origin;if(this.rotation&&(e.transform+=" rotate("+this.rotation+" "+n.x+" "+n.y+")"),o.attr(this.g,e),s.each(this.bonds,(function(e,n){t.nodeRefresh(n)})),this.labelSVG){var i=u.default.plus(this.p,this.labelSVG.p);e={transform:"translate("+i.x+" "+i.y+")"},this.rotation&&(n=u.default.minus(u.default.plus(this.p,n),i),e.transform+=" rotate("+this.rotation+" "+n.x+" "+n.y+")"),o.attr(this.labelSVG.g,e)}return this},e.prototype.nodeRefresh=function(t){var e=this,n=this.nodeBonds(t),i=this.getNode(t);return i&&n&&n.to.forEach((function(t){var n=e.circuit.get(t.id),r=u.default.plus(e.p,e.rotation?i.rot:i).round();n&&n.setNode(t.ndx,r)})),this},e.prototype.getNode=function(t){var e=this.base.meta.nodes.list[t];return e?(e.rot=function(t,e,n){if(!e)return t;var i=t.rotateBy(n.x,n.y,-e);return new u.default(i.x,i.y)}(new u.default(e.x,e.y),this.rotation,this.origin),o.obj(e)):null},e.prototype.getNodeRealXY=function(t){var e=this.getNode(t);return e?u.default.plus(this.p,this.rotation?e.rot:e).round():null},e.prototype.overNode=function(t,e){for(var n=0,i=this.count;n<i;n++){var r=this.getNode(n);if(this.rotation&&(r.x=Math.round(r.rot.x),r.y=Math.round(r.rot.y)),Math.pow(t.x-this.x-r.x,2)+Math.pow(t.y-this.y-r.y,2)<=81)return n}return-1},e.prototype.findNode=function(t){for(var e=t.x-this.x,n=t.y-this.y,i=-this.rotation,r=this.origin,o=0,s=this.base.meta.nodes.list,a=s[o],c=s.length;o<c;a=s[++o]){var p=this.rotation?u.default.prototype.rotateBy.call(a,r.x,r.y,i):a;if(Math.pow(e-p.x,2)+Math.pow(n-p.y,2)<=81)return o}return-1},e.prototype.setNode=function(t,e){throw"somebody called me, not good!"},e.prototype.valid=function(t){return!!this.getNode(t)},e.prototype.nodeHighlightable=function(t){return this.valid(t)},e.prototype.setVisible=function(e){return t.prototype.setVisible.call(this,e),this.labelSVG&&this.labelSVG.setVisible(e),this},e.prototype.remove=function(){var e;this.labelSVG&&(null===(e=this.g.parentNode)||void 0===e||e.removeChild(this.labelSVG.g)),t.prototype.remove.call(this)},e.prototype.afterDOMinserted=function(){this.labelSVG&&(this.g.insertAdjacentElement("afterend",this.labelSVG.g),this.labelSVG.setVisible(!0))},e.prototype.propertyDefaults=function(){return o.extend(t.prototype.propertyDefaults.call(this),{class:"ec"})},e}(c.ItemSolid);e.default=h},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.ItemSolid=e.RotationInjector=void 0;var o=n(17),s=n(7),a=n(15),u=n(3),c=function(t){function e(e,n){return t.call(this,e,n,!0)||this}return r(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return"rotation"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.ec[this.name]+""},enumerable:!1,configurable:!0}),e.prototype.setValue=function(t){return!1},e}(o.PropertyInjector);e.RotationInjector=c;var p=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.settings.rotation=u.default.validateRotation(n.rotation),i}return r(e,t),e.prototype.windowProperties=function(){return t.prototype.windowProperties.call(this).concat(["rotation"])},e.prototype.prop=function(e){switch(e){case"rotation":return new c(this,e)}return t.prototype.prop.call(this,e)},Object.defineProperty(e.prototype,"rotation",{get:function(){return this.settings.rotation},enumerable:!1,configurable:!0}),e.prototype.rotate=function(t){return this.settings.rotation!=(t=u.default.validateRotation(t))&&(this.settings.rotation=t,this.onProp&&this.onProp({id:"#"+this.id,value:this.rotation,prop:"rotate",where:1})),this},e.prototype.rect=function(){var t=a.default.create(this.box),e=this.p;if(this.rotation){var n=this.origin,i=-this.rotation,r=[[0,0],[t.width,0],[0,t.height],[t.width,t.height]].map((function(t){return new u.default(t[0],t[1]).rotateBy(n.x,n.y,i)})),o=Math.min.apply(Math,r.map((function(t){return t.x}))),c=Math.min.apply(Math,r.map((function(t){return t.y}))),p=Math.max.apply(Math,r.map((function(t){return t.x}))),h=Math.max.apply(Math,r.map((function(t){return t.y})));return new s.default(Math.round(e.x+o),Math.round(e.y+c),Math.round(p-o),Math.round(h-c))}return new s.default(e.x,e.y,t.width,t.height)},e}(o.ItemBoard);e.ItemSolid=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Bond=void 0;var i=n(4),r=n(0),o=function(){function t(t,e,n,i){var r=this;if(this.toString=function(){var t=function(t){return"#"+t.id+" ["+t.ndx+"]"},e=r.to.map((function(e){return t(e)})).join(", ");return"from "+t(r.from)+" to "+e},!t||!e)throw"empty bond";this.from=this.create(t,i),this.to=[],this.add(e,n)}return Object.defineProperty(t.prototype,"type",{get:function(){return i.Type.BOND},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this.to.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"link",{get:function(){return this.from.ndx+">"+this.to.map((function(t){return t.id+"("+t.ndx+")"})).join("&")},enumerable:!1,configurable:!0}),t.prototype.has=function(t){return this.to.some((function(e){return t==e.id}))},t.prototype.get=function(t){return this.to.find((function(e){return t==e.id}))},t.prototype.add=function(t,e){if(t&&!this.has(t.id)){var n=this.create(t,e);if(n.type==i.Type.EC||n.type==i.Type.WIRE)return this.to.push(n),!0}return!1},t.prototype.create=function(t,e){return r.obj({id:t.id,type:t.type,ndx:e})},t.prototype.remove=function(t){var e=this.to.findIndex((function(e){return e.id==t})),n=-1==e?null:this.to[e];return null!=n&&this.to.splice(e,1),n},t.display=function(t){return t.map((function(t){return t.toString()}))},t}();e.Bond=o},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),s=n(2),a=n(4),u=n(17),c=n(3),p=n(7),h=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.settings.polyline=s.tag("polyline","",{"svg-type":"line",line:"0",points:""}),i.g.append(i.settings.polyline),i.setPoints(n.points),l.call(i),i.onProp&&i.onProp({id:"#"+i.id,args:{id:i.id,name:i.name,x:i.x,y:i.y,points:i.settings.points,bonds:"["+i.bonds.map((function(t){return t.link})).join(", ")+"]"},method:"create",where:1}),i}return r(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return a.Type.WIRE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){return this.settings.points.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){return this.settings.points.length-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastLine",{get:function(){return this.editMode?this.settings.lines.length:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isOpen",{get:function(){return!this.nodeBonds(0)||!this.nodeBonds(this.last)},enumerable:!1,configurable:!0}),e.prototype.rect=function(){return p.default.create(this.box)},Object.defineProperty(e.prototype,"points",{get:function(){return Array.from(this.settings.points)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"editMode",{get:function(){return this.settings.edit},set:function(t){var e=this;if(this.editMode!=t){if(this.editMode)this.settings.lines=this.settings.lines.filter((function(t){return e.g.removeChild(t),!1})),this.refresh(),o.removeClass(this.settings.polyline,"hide");else{o.addClass(this.settings.polyline,"hide");for(var n=0,i=this.settings.points[0],r=this.last;n<r;n++){var a=this.settings.points[n+1],u=s.tag("line","",{"svg-type":"line",line:n+1,x1:i.x,y1:i.y,x2:a.x,y2:a.y});this.settings.lines.push(u),this.g.insertBefore(u,this.settings.polyline),i=a}}this.settings.edit=t}},enumerable:!1,configurable:!0}),e.prototype.refresh=function(){return o.attr(this.settings.polyline,{points:this.settings.points.map((function(t){return t.x+", "+t.y})).join(" ")}),this},e.prototype.nodeRefresh=function(t){var e=this;if(this.editMode){var n=void 0,i=this.settings.points[t];(n=this.settings.lines[t-1])&&o.attr(n,{x2:i.x,y2:i.y}),(n=this.settings.lines[t])&&o.attr(n,{x1:i.x,y1:i.y})}else this.refresh();if(0!=t&&t!=this.last){var r=this.nodeBonds(t),s=this.settings.points[t];r&&r.to.forEach((function(t){var n;null===(n=e.circuit.get(t.id))||void 0===n||n.setNode(t.ndx,s)}))}return this},e.prototype.translate=function(e,n){t.prototype.translate.call(this,e,n);var i=this.editMode;this.editMode=!1;for(var r=0,o=this.settings.points[r],s=this.last;r<=s;o=this.settings.points[++r])(r>0&&r<s||(0==r||r==s)&&!this.nodeBonds(r))&&this.setNode(r,c.default.translateBy(o,e,n));return this.editMode=i,this},e.prototype.valid=function(t){return t>=-1&&t<=this.last},e.prototype.getNode=function(t){var e=this.settings.points[t];return e&&{x:e.x,y:e.y}},e.prototype.getNodeRealXY=function(t){var e=this.getNode(t);return e&&c.default.create(e)},e.prototype.appendNode=function(t){return!this.editMode&&(this.settings.points.push(t),this.refresh(),!0)},e.prototype.setNode=function(t,e){return this.settings.points[t].x=0|e.x,this.settings.points[t].y=0|e.y,l.call(this),this.nodeRefresh(t)},e.prototype.nodeHighlightable=function(t){return this.valid(t)&&!(this.nodeBonds(t)&&(0==t||t==this.last))},e.prototype.setPoints=function(t){if(!o.isArr(t)||t.length<2)throw"Poliwire min 2 points";return this.editMode||(this.settings.points=t.map((function(t){return new c.default(0|t.x,0|t.y)})),l.call(this),this.settings.lines=[],this.refresh()),this},e.prototype.overNode=function(t,e){var n=this,i=e,r=this.settings.lines.length,o=function(t,e,i){return e>=t.x-n.settings.pad&&e<=t.x+n.settings.pad&&i>=t.y-n.settings.pad&&i<=t.y+n.settings.pad};return!this.editMode&&(e=1,i=this.last,r=1),function(t){return t&&t<=r}(e)?o(this.settings.points[e-1],t.x,t.y)?e-1:o(this.settings.points[i],t.x,t.y)?i:-1:-1},e.prototype.findLineNode=function(t,e){var n=function(e){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)<=25};return(e<=0||e>=this.last)&&(e=this.findNode(t),1)||n(this.settings.points[e])||n(this.settings.points[--e])||(e=-1),e},e.prototype.findNode=function(t){for(var e=0,n=this.settings.points[e],i=this.settings.points.length;e<i;n=this.settings.points[++e])if(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)<=25)return e;return-1},e.prototype.deleteLine=function(t){if(t<=1||t>=this.last)return!1;var e=this.editMode;return this.editMode=!1,d.call(this,t),d.call(this,t-1),l.call(this),this.editMode=e,!0},e.prototype.deleteNode=function(t){var e,n=this.editMode;return this.editMode=!1,e=d.call(this,t),l.call(this),this.editMode=n,e},e.prototype.insertNode=function(t,e){if(t<=0||t>this.last||isNaN(t))return!1;var n=this.editMode;this.editMode=!1;for(var i=this.last;i>=t;i--)f.call(this,i,i+1);return this.settings.points.splice(t,0,e),this.editMode=n,!0},e.prototype.standarizeNode=function(t){return this.valid(t)?-1==t?this.last:t:-1},e.prototype.windowProperties=function(){return["id","bonds"]},e.prototype.prop=function(e){if("p"!=e)return t.prototype.prop.call(this,e)},e.prototype.propertyDefaults=function(){return o.extend(t.prototype.propertyDefaults.call(this),{name:"wire",class:"wire",pad:5,edit:!1})},e}(u.ItemBoard);function l(){this.move(this.settings.points[0].x,this.settings.points[0].y)}function d(t){var e=this.last;if(!(t<=0||t>=e||isNaN(t)))return this.unbondNode(t),f.call(this,e,e-1),this.settings.points.splice(t,1)[0]}function f(t,e){var n=this,i=this.nodeBonds(t);return!!i&&(i.from.ndx=e,i.to.forEach((function(t){var i=n.circuit.get(t.id),r=null==i?void 0:i.nodeBonds(t.ndx);null==r||r.to.filter((function(t){return t.id==n.id})).forEach((function(t){t.ndx=e}))})),delete this.settings.bonds[t],this.settings.bonds[e]=i,!0)}e.default=h},function(t,e,n){(function(){"use strict";var t,i,r,o,s={}.hasOwnProperty;i=n(18),t=n(67),r=n(76),o=n(46),e.defaults=i.defaults,e.processors=o,e.ValidationError=function(t){function e(t){this.message=t}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(e,Error),e}(),e.Builder=t.Builder,e.Parser=r.Parser,e.parseString=r.parseString,e.parseStringPromise=r.parseStringPromise}).call(this)},function(t,e,n){(function(){"use strict";var t,i,r,o,s,a={}.hasOwnProperty;t=n(68),i=n(18).defaults,o=function(t){return"string"==typeof t&&(t.indexOf("&")>=0||t.indexOf(">")>=0||t.indexOf("<")>=0)},s=function(t){return"<![CDATA["+r(t)+"]]>"},r=function(t){return t.replace("]]>","]]]]><![CDATA[>")},e.Builder=function(){function e(t){var e,n,r;for(e in this.options={},n=i[.2])a.call(n,e)&&(r=n[e],this.options[e]=r);for(e in t)a.call(t,e)&&(r=t[e],this.options[e]=r)}return e.prototype.buildObject=function(e){var n,r,u,c,p,h;return n=this.options.attrkey,r=this.options.charkey,1===Object.keys(e).length&&this.options.rootName===i[.2].rootName?e=e[p=Object.keys(e)[0]]:p=this.options.rootName,h=this,u=function(t,e){var i,c,p,l,d,f;if("object"!=typeof e)h.options.cdata&&o(e)?t.raw(s(e)):t.txt(e);else if(Array.isArray(e)){for(l in e)if(a.call(e,l))for(d in c=e[l])p=c[d],t=u(t.ele(d),p).up()}else for(d in e)if(a.call(e,d))if(c=e[d],d===n){if("object"==typeof c)for(i in c)f=c[i],t=t.att(i,f)}else if(d===r)t=h.options.cdata&&o(c)?t.raw(s(c)):t.txt(c);else if(Array.isArray(c))for(l in c)a.call(c,l)&&(t="string"==typeof(p=c[l])?h.options.cdata&&o(p)?t.ele(d).raw(s(p)).up():t.ele(d,p).up():u(t.ele(d),p).up());else"object"==typeof c?t=u(t.ele(d),c).up():"string"==typeof c&&h.options.cdata&&o(c)?t=t.ele(d).raw(s(c)).up():(null==c&&(c=""),t=t.ele(d,c.toString()).up());return t},c=t.create(p,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),u(c,e).end(this.options.renderOpts)},e}()}).call(this)},function(t,e,n){(function(){var e,i,r,o,s,a,u,c,p,h;h=n(6),c=h.assign,p=h.isFunction,r=n(40),o=n(41),s=n(74),u=n(32),a=n(75),e=n(1),i=n(12),t.exports.create=function(t,e,n,i){var r,s;if(null==t)throw new Error("Root element needs a name.");return i=c({},e,n,i),s=(r=new o(i)).element(t),i.headless||(r.declaration(i),null==i.pubID&&null==i.sysID||r.dtd(i)),s},t.exports.begin=function(t,e,n){var i;return p(t)&&(e=(i=[t,e])[0],n=i[1],t={}),e?new s(t,e,n):new o(t)},t.exports.stringWriter=function(t){return new u(t)},t.exports.streamWriter=function(t,e){return new a(t,e)},t.exports.implementation=new r,t.exports.nodeType=e,t.exports.writerState=i}).call(this)},function(t,e,n){(function(){var e,i;e=n(70),i=n(71),t.exports=function(){function t(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new e,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(t.prototype,"parameterNames",{get:function(){return new i(Object.keys(this.defaultParams))}}),t.prototype.getParameter=function(t){return this.params.hasOwnProperty(t)?this.params[t]:null},t.prototype.canSetParameter=function(t,e){return!0},t.prototype.setParameter=function(t,e){return null!=e?this.params[t]=e:delete this.params[t]},t}()}).call(this)},function(t,e){(function(){t.exports=function(){function t(){}return t.prototype.handleError=function(t){throw new Error(t)},t}()}).call(this)},function(t,e){(function(){t.exports=function(){function t(t){this.arr=t||[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t.prototype.item=function(t){return this.arr[t]||null},t.prototype.contains=function(t){return-1!==this.arr.indexOf(t)},t}()}).call(this)},function(t,e){(function(){t.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.item=function(t){return this.nodes[t]||null},t}()}).call(this)},function(t,e){(function(){t.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},function(t,e,n){(function(){var e,i,r,o,s,a,u,c,p,h,l,d,f,y,m,g,b,v,w,T,E,O,_,x={}.hasOwnProperty;_=n(6),E=_.isObject,T=_.isFunction,O=_.isPlainObject,w=_.getValue,e=n(1),d=n(41),f=n(19),o=n(21),s=n(22),m=n(29),v=n(30),y=n(31),h=n(23),l=n(24),a=n(25),c=n(26),u=n(27),p=n(28),r=n(42),b=n(44),g=n(32),i=n(12),t.exports=function(){function t(t,n,i){var r;this.name="?xml",this.type=e.Document,t||(t={}),r={},t.writer?O(t.writer)&&(r=t.writer,t.writer=new g):t.writer=new g,this.options=t,this.writer=t.writer,this.writerOptions=this.writer.filterOptions(r),this.stringify=new b(t),this.onDataCallback=n||function(){},this.onEndCallback=i||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return t.prototype.createChildNode=function(t){var n,i,r,o,s,a,u,c;switch(t.type){case e.CData:this.cdata(t.value);break;case e.Comment:this.comment(t.value);break;case e.Element:for(i in r={},u=t.attribs)x.call(u,i)&&(n=u[i],r[i]=n.value);this.node(t.name,r);break;case e.Dummy:this.dummy();break;case e.Raw:this.raw(t.value);break;case e.Text:this.text(t.value);break;case e.ProcessingInstruction:this.instruction(t.target,t.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+t.constructor.name)}for(s=0,a=(c=t.children).length;s<a;s++)o=c[s],this.createChildNode(o),o.type===e.Element&&this.up();return this},t.prototype.dummy=function(){return this},t.prototype.node=function(t,e,n){var i;if(null==t)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(t));return this.openCurrent(),t=w(t),null==e&&(e={}),e=w(e),E(e)||(n=(i=[e,n])[0],e=i[1]),this.currentNode=new f(this,t,e),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=n&&this.text(n),this},t.prototype.element=function(t,n,i){var r,o,s,a,u,c;if(this.currentNode&&this.currentNode.type===e.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(t)||E(t)||T(t))for(a=this.options.noValidation,this.options.noValidation=!0,(c=new d(this.options).element("TEMP_ROOT")).element(t),this.options.noValidation=a,o=0,s=(u=c.children).length;o<s;o++)r=u[o],this.createChildNode(r),r.type===e.Element&&this.up();else this.node(t,n,i);return this},t.prototype.attribute=function(t,e){var n,i;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(t));if(null!=t&&(t=w(t)),E(t))for(n in t)x.call(t,n)&&(i=t[n],this.attribute(n,i));else T(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.currentNode.attribs[t]=new r(this,t,""):null!=e&&(this.currentNode.attribs[t]=new r(this,t,e));return this},t.prototype.text=function(t){var e;return this.openCurrent(),e=new v(this,t),this.onData(this.writer.text(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.cdata=function(t){var e;return this.openCurrent(),e=new o(this,t),this.onData(this.writer.cdata(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.comment=function(t){var e;return this.openCurrent(),e=new s(this,t),this.onData(this.writer.comment(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.raw=function(t){var e;return this.openCurrent(),e=new m(this,t),this.onData(this.writer.raw(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.instruction=function(t,e){var n,i,r,o,s;if(this.openCurrent(),null!=t&&(t=w(t)),null!=e&&(e=w(e)),Array.isArray(t))for(n=0,o=t.length;n<o;n++)i=t[n],this.instruction(i);else if(E(t))for(i in t)x.call(t,i)&&(r=t[i],this.instruction(i,r));else T(e)&&(e=e.apply()),s=new y(this,t,e),this.onData(this.writer.processingInstruction(s,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},t.prototype.declaration=function(t,e,n){var i;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return i=new h(this,t,e,n),this.onData(this.writer.declaration(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.doctype=function(t,e,n){if(this.openCurrent(),null==t)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new l(this,e,n),this.currentNode.rootNodeName=t,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},t.prototype.dtdElement=function(t,e){var n;return this.openCurrent(),n=new u(this,t,e),this.onData(this.writer.dtdElement(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.attList=function(t,e,n,i,r){var o;return this.openCurrent(),o=new a(this,t,e,n,i,r),this.onData(this.writer.dtdAttList(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.entity=function(t,e){var n;return this.openCurrent(),n=new c(this,!1,t,e),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.pEntity=function(t,e){var n;return this.openCurrent(),n=new c(this,!0,t,e),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.notation=function(t,e){var n;return this.openCurrent(),n=new p(this,t,e),this.onData(this.writer.dtdNotation(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},t.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},t.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},t.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},t.prototype.openNode=function(t){var n,r,o,s;if(!t.isOpen){if(this.root||0!==this.currentLevel||t.type!==e.Element||(this.root=t),r="",t.type===e.Element){for(o in this.writerOptions.state=i.OpenTag,r=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<"+t.name,s=t.attribs)x.call(s,o)&&(n=s[o],r+=this.writer.attribute(n,this.writerOptions,this.currentLevel));r+=(t.children?">":"/>")+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=i.InsideTag}else this.writerOptions.state=i.OpenTag,r=this.writer.indent(t,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+t.rootNodeName,t.pubID&&t.sysID?r+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(r+=' SYSTEM "'+t.sysID+'"'),t.children?(r+=" [",this.writerOptions.state=i.InsideTag):(this.writerOptions.state=i.CloseTag,r+=">"),r+=this.writer.endline(t,this.writerOptions,this.currentLevel);return this.onData(r,this.currentLevel),t.isOpen=!0}},t.prototype.closeNode=function(t){var n;if(!t.isClosed)return n="",this.writerOptions.state=i.CloseTag,n=t.type===e.Element?this.writer.indent(t,this.writerOptions,this.currentLevel)+"</"+t.name+">"+this.writer.endline(t,this.writerOptions,this.currentLevel):this.writer.indent(t,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(t,this.writerOptions,this.currentLevel),this.writerOptions.state=i.None,this.onData(n,this.currentLevel),t.isClosed=!0},t.prototype.onData=function(t,e){return this.documentStarted=!0,this.onDataCallback(t,e+1)},t.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},t.prototype.debugInfo=function(t){return null==t?"":"node: <"+t+">"},t.prototype.ele=function(){return this.element.apply(this,arguments)},t.prototype.nod=function(t,e,n){return this.node(t,e,n)},t.prototype.txt=function(t){return this.text(t)},t.prototype.dat=function(t){return this.cdata(t)},t.prototype.com=function(t){return this.comment(t)},t.prototype.ins=function(t,e){return this.instruction(t,e)},t.prototype.dec=function(t,e,n){return this.declaration(t,e,n)},t.prototype.dtd=function(t,e,n){return this.doctype(t,e,n)},t.prototype.e=function(t,e,n){return this.element(t,e,n)},t.prototype.n=function(t,e,n){return this.node(t,e,n)},t.prototype.t=function(t){return this.text(t)},t.prototype.d=function(t){return this.cdata(t)},t.prototype.c=function(t){return this.comment(t)},t.prototype.r=function(t){return this.raw(t)},t.prototype.i=function(t,e){return this.instruction(t,e)},t.prototype.att=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.a=function(){return this.currentNode&&this.currentNode.type===e.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},t.prototype.ent=function(t,e){return this.entity(t,e)},t.prototype.pent=function(t,e){return this.pEntity(t,e)},t.prototype.not=function(t,e){return this.notation(t,e)},t}()}).call(this)},function(t,e,n){(function(){var e,i,r,o={}.hasOwnProperty;e=n(1),r=n(45),i=n(12),t.exports=function(t){function n(t,e){this.stream=t,n.__super__.constructor.call(this,e)}return function(t,e){for(var n in e)o.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,t),n.prototype.endline=function(t,e,r){return t.isLastRootNode&&e.state===i.CloseTag?"":n.__super__.endline.call(this,t,e,r)},n.prototype.document=function(t,e){var n,i,r,o,s,a,u,c,p;for(i=r=0,s=(u=t.children).length;r<s;i=++r)(n=u[i]).isLastRootNode=i===t.children.length-1;for(e=this.filterOptions(e),p=[],o=0,a=(c=t.children).length;o<a;o++)n=c[o],p.push(this.writeChildNode(n,e,0));return p},n.prototype.attribute=function(t,e,i){return this.stream.write(n.__super__.attribute.call(this,t,e,i))},n.prototype.cdata=function(t,e,i){return this.stream.write(n.__super__.cdata.call(this,t,e,i))},n.prototype.comment=function(t,e,i){return this.stream.write(n.__super__.comment.call(this,t,e,i))},n.prototype.declaration=function(t,e,i){return this.stream.write(n.__super__.declaration.call(this,t,e,i))},n.prototype.docType=function(t,e,n){var r,o,s,a;if(n||(n=0),this.openNode(t,e,n),e.state=i.OpenTag,this.stream.write(this.indent(t,e,n)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,e,n)),e.state=i.InsideTag,o=0,s=(a=t.children).length;o<s;o++)r=a[o],this.writeChildNode(r,e,n+1);e.state=i.CloseTag,this.stream.write("]")}return e.state=i.CloseTag,this.stream.write(e.spaceBeforeSlash+">"),this.stream.write(this.endline(t,e,n)),e.state=i.None,this.closeNode(t,e,n)},n.prototype.element=function(t,n,r){var s,a,u,c,p,h,l,d,f;for(l in r||(r=0),this.openNode(t,n,r),n.state=i.OpenTag,this.stream.write(this.indent(t,n,r)+"<"+t.name),d=t.attribs)o.call(d,l)&&(s=d[l],this.attribute(s,n,r));if(c=0===(u=t.children.length)?null:t.children[0],0===u||t.children.every((function(t){return(t.type===e.Text||t.type===e.Raw)&&""===t.value})))n.allowEmpty?(this.stream.write(">"),n.state=i.CloseTag,this.stream.write("</"+t.name+">")):(n.state=i.CloseTag,this.stream.write(n.spaceBeforeSlash+"/>"));else if(!n.pretty||1!==u||c.type!==e.Text&&c.type!==e.Raw||null==c.value){for(this.stream.write(">"+this.endline(t,n,r)),n.state=i.InsideTag,p=0,h=(f=t.children).length;p<h;p++)a=f[p],this.writeChildNode(a,n,r+1);n.state=i.CloseTag,this.stream.write(this.indent(t,n,r)+"</"+t.name+">")}else this.stream.write(">"),n.state=i.InsideTag,n.suppressPrettyCount++,!0,this.writeChildNode(c,n,r+1),n.suppressPrettyCount--,!1,n.state=i.CloseTag,this.stream.write("</"+t.name+">");return this.stream.write(this.endline(t,n,r)),n.state=i.None,this.closeNode(t,n,r)},n.prototype.processingInstruction=function(t,e,i){return this.stream.write(n.__super__.processingInstruction.call(this,t,e,i))},n.prototype.raw=function(t,e,i){return this.stream.write(n.__super__.raw.call(this,t,e,i))},n.prototype.text=function(t,e,i){return this.stream.write(n.__super__.text.call(this,t,e,i))},n.prototype.dtdAttList=function(t,e,i){return this.stream.write(n.__super__.dtdAttList.call(this,t,e,i))},n.prototype.dtdElement=function(t,e,i){return this.stream.write(n.__super__.dtdElement.call(this,t,e,i))},n.prototype.dtdEntity=function(t,e,i){return this.stream.write(n.__super__.dtdEntity.call(this,t,e,i))},n.prototype.dtdNotation=function(t,e,i){return this.stream.write(n.__super__.dtdNotation.call(this,t,e,i))},n}(r)}).call(this)},function(t,e,n){(function(){"use strict";var t,i,r,o,s,a,u,c,p=function(t,e){return function(){return t.apply(e,arguments)}},h={}.hasOwnProperty;u=n(77),r=n(80),t=n(81),a=n(46),c=n(82).setImmediate,i=n(18).defaults,o=function(t){return"object"==typeof t&&null!=t&&0===Object.keys(t).length},s=function(t,e,n){var i,r;for(i=0,r=t.length;i<r;i++)e=(0,t[i])(e,n);return e},e.Parser=function(n){function r(t){var n,r,o;if(this.parseStringPromise=p(this.parseStringPromise,this),this.parseString=p(this.parseString,this),this.reset=p(this.reset,this),this.assignOrPush=p(this.assignOrPush,this),this.processAsync=p(this.processAsync,this),!(this instanceof e.Parser))return new e.Parser(t);for(n in this.options={},r=i[.2])h.call(r,n)&&(o=r[n],this.options[n]=o);for(n in t)h.call(t,n)&&(o=t[n],this.options[n]=o);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(a.normalize)),this.reset()}return function(t,e){for(var n in e)h.call(e,n)&&(t[n]=e[n]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,n),r.prototype.processAsync=function(){var t,e;try{return this.remaining.length<=this.options.chunkSize?(t=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(t),this.saxParser.close()):(t=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(t),c(this.processAsync))}catch(t){if(e=t,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(e)}},r.prototype.assignOrPush=function(t,e,n){return e in t?(t[e]instanceof Array||(t[e]=[t[e]]),t[e].push(n)):this.options.explicitArray?t[e]=[n]:t[e]=n},r.prototype.reset=function(){var t,e,n,i,r;return this.removeAllListeners(),this.saxParser=u.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(r=this,function(t){if(r.saxParser.resume(),!r.saxParser.errThrown)return r.saxParser.errThrown=!0,r.emit("error",t)}),this.saxParser.onend=function(t){return function(){if(!t.saxParser.ended)return t.saxParser.ended=!0,t.emit("end",t.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,i=[],t=this.options.attrkey,e=this.options.charkey,this.saxParser.onopentag=function(n){return function(r){var o,a,u,c,p;if((u={})[e]="",!n.options.ignoreAttrs)for(o in p=r.attributes)h.call(p,o)&&(t in u||n.options.mergeAttrs||(u[t]={}),a=n.options.attrValueProcessors?s(n.options.attrValueProcessors,r.attributes[o],o):r.attributes[o],c=n.options.attrNameProcessors?s(n.options.attrNameProcessors,o):o,n.options.mergeAttrs?n.assignOrPush(u,c,a):u[t][c]=a);return u["#name"]=n.options.tagNameProcessors?s(n.options.tagNameProcessors,r.name):r.name,n.options.xmlns&&(u[n.options.xmlnskey]={uri:r.uri,local:r.local}),i.push(u)}}(this),this.saxParser.onclosetag=function(t){return function(){var n,r,a,u,c,p,l,d,f,y;if(p=i.pop(),c=p["#name"],t.options.explicitChildren&&t.options.preserveChildrenOrder||delete p["#name"],!0===p.cdata&&(n=p.cdata,delete p.cdata),f=i[i.length-1],p[e].match(/^\s*$/)&&!n?(r=p[e],delete p[e]):(t.options.trim&&(p[e]=p[e].trim()),t.options.normalize&&(p[e]=p[e].replace(/\s{2,}/g," ").trim()),p[e]=t.options.valueProcessors?s(t.options.valueProcessors,p[e],c):p[e],1===Object.keys(p).length&&e in p&&!t.EXPLICIT_CHARKEY&&(p=p[e])),o(p)&&(p=""!==t.options.emptyTag?t.options.emptyTag:r),null!=t.options.validator&&(y="/"+function(){var t,e,n;for(n=[],t=0,e=i.length;t<e;t++)u=i[t],n.push(u["#name"]);return n}().concat(c).join("/"),function(){var e;try{p=t.options.validator(y,f&&f[c],p)}catch(n){return e=n,t.emit("error",e)}}()),t.options.explicitChildren&&!t.options.mergeAttrs&&"object"==typeof p)if(t.options.preserveChildrenOrder){if(f){for(a in f[t.options.childkey]=f[t.options.childkey]||[],l={},p)h.call(p,a)&&(l[a]=p[a]);f[t.options.childkey].push(l),delete p["#name"],1===Object.keys(p).length&&e in p&&!t.EXPLICIT_CHARKEY&&(p=p[e])}}else u={},t.options.attrkey in p&&(u[t.options.attrkey]=p[t.options.attrkey],delete p[t.options.attrkey]),!t.options.charsAsChildren&&t.options.charkey in p&&(u[t.options.charkey]=p[t.options.charkey],delete p[t.options.charkey]),Object.getOwnPropertyNames(p).length>0&&(u[t.options.childkey]=p),p=u;return i.length>0?t.assignOrPush(f,c,p):(t.options.explicitRoot&&(d=p,(p={})[c]=d),t.resultObject=p,t.saxParser.ended=!0,t.emit("end",t.resultObject))}}(this),n=function(t){return function(n){var r,o;if(o=i[i.length-1])return o[e]+=n,t.options.explicitChildren&&t.options.preserveChildrenOrder&&t.options.charsAsChildren&&(t.options.includeWhiteChars||""!==n.replace(/\\n/g,"").trim())&&(o[t.options.childkey]=o[t.options.childkey]||[],(r={"#name":"__text__"})[e]=n,t.options.normalize&&(r[e]=r[e].replace(/\s{2,}/g," ").trim()),o[t.options.childkey].push(r)),o}}(this),this.saxParser.ontext=n,this.saxParser.oncdata=function(t){var e;if(e=n(t))return e.cdata=!0}},r.prototype.parseString=function(e,n){var i;null!=n&&"function"==typeof n&&(this.on("end",(function(t){return this.reset(),n(null,t)})),this.on("error",(function(t){return this.reset(),n(t)})));try{return""===(e=e.toString()).trim()?(this.emit("end",null),!0):(e=t.stripBOM(e),this.options.async?(this.remaining=e,c(this.processAsync),this.saxParser):this.saxParser.write(e).close())}catch(t){if(i=t,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",i),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw i}},r.prototype.parseStringPromise=function(t){return new Promise((e=this,function(n,i){return e.parseString(t,(function(t,e){return t?i(t):n(e)}))}));var e},r}(r),e.parseString=function(t,n,i){var r,o;return null!=i?("function"==typeof i&&(r=i),"object"==typeof n&&(o=n)):("function"==typeof n&&(r=n),o={}),new e.Parser(o).parseString(t,r)},e.parseStringPromise=function(t,n){var i;return"object"==typeof n&&(i=n),new e.Parser(i).parseStringPromise(t)}}).call(this)},function(t,e,n){!function(t){t.parser=function(t,e){return new r(t,e)},t.SAXParser=r,t.SAXStream=s,t.createStream=function(t,e){return new s(t,e)},t.MAX_BUFFER_LENGTH=65536;var e,i=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function r(e,n){if(!(this instanceof r))return new r(e,n);!function(t){for(var e=0,n=i.length;e<n;e++)t[i[e]]=""}(this),this.q=this.c="",this.bufferCheckPosition=t.MAX_BUFFER_LENGTH,this.opt=n||{},this.opt.lowercase=this.opt.lowercase||this.opt.lowercasetags,this.looseCase=this.opt.lowercase?"toLowerCase":"toUpperCase",this.tags=[],this.closed=this.closedRoot=this.sawRoot=!1,this.tag=this.error=null,this.strict=!!e,this.noscript=!(!e&&!this.opt.noscript),this.state=T.BEGIN,this.strictEntities=this.opt.strictEntities,this.ENTITIES=this.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),this.attribList=[],this.opt.xmlns&&(this.ns=Object.create(u)),this.trackPosition=!1!==this.opt.position,this.trackPosition&&(this.position=this.line=this.column=0),O(this,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e}),r.prototype={end:function(){I(this)},write:function(e){if(this.error)throw this.error;if(this.closed)return D(this,"Cannot write after close. Assign an onready handler.");if(null===e)return I(this);"object"==typeof e&&(e=e.toString());var n=0,r="";for(;r=B(e,n++),this.c=r,r;)switch(this.trackPosition&&(this.position++,"\n"===r?(this.line++,this.column=0):this.column++),this.state){case T.BEGIN:if(this.state=T.BEGIN_WHITESPACE,"\ufeff"===r)continue;R(this,r);continue;case T.BEGIN_WHITESPACE:R(this,r);continue;case T.TEXT:if(this.sawRoot&&!this.closedRoot){for(var o=n-1;r&&"<"!==r&&"&"!==r;)(r=B(e,n++))&&this.trackPosition&&(this.position++,"\n"===r?(this.line++,this.column=0):this.column++);this.textNode+=e.substring(o,n-1)}"<"!==r||this.sawRoot&&this.closedRoot&&!this.strict?(d(r)||this.sawRoot&&!this.closedRoot||C(this,"Text data outside of root node."),"&"===r?this.state=T.TEXT_ENTITY:this.textNode+=r):(this.state=T.OPEN_WAKA,this.startTagPosition=this.position);continue;case T.SCRIPT:"<"===r?this.state=T.SCRIPT_ENDING:this.script+=r;continue;case T.SCRIPT_ENDING:"/"===r?this.state=T.CLOSE_TAG:(this.script+="<"+r,this.state=T.SCRIPT);continue;case T.OPEN_WAKA:if("!"===r)this.state=T.SGML_DECL,this.sgmlDecl="";else if(d(r));else if(m(c,r))this.state=T.OPEN_TAG,this.tagName=r;else if("/"===r)this.state=T.CLOSE_TAG,this.tagName="";else if("?"===r)this.state=T.PROC_INST,this.procInstName=this.procInstBody="";else{if(C(this,"Unencoded <"),this.startTagPosition+1<this.position){var s=this.position-this.startTagPosition;r=new Array(s).join(" ")+r}this.textNode+="<"+r,this.state=T.TEXT}continue;case T.SGML_DECL:"[CDATA["===(this.sgmlDecl+r).toUpperCase()?(_(this,"onopencdata"),this.state=T.CDATA,this.sgmlDecl="",this.cdata=""):this.sgmlDecl+r==="--"?(this.state=T.COMMENT,this.comment="",this.sgmlDecl=""):"DOCTYPE"===(this.sgmlDecl+r).toUpperCase()?(this.state=T.DOCTYPE,(this.doctype||this.sawRoot)&&C(this,"Inappropriately located doctype declaration"),this.doctype="",this.sgmlDecl=""):">"===r?(_(this,"onsgmldeclaration",this.sgmlDecl),this.sgmlDecl="",this.state=T.TEXT):f(r)?(this.state=T.SGML_DECL_QUOTED,this.sgmlDecl+=r):this.sgmlDecl+=r;continue;case T.SGML_DECL_QUOTED:r===this.q&&(this.state=T.SGML_DECL,this.q=""),this.sgmlDecl+=r;continue;case T.DOCTYPE:">"===r?(this.state=T.TEXT,_(this,"ondoctype",this.doctype),this.doctype=!0):(this.doctype+=r,"["===r?this.state=T.DOCTYPE_DTD:f(r)&&(this.state=T.DOCTYPE_QUOTED,this.q=r));continue;case T.DOCTYPE_QUOTED:this.doctype+=r,r===this.q&&(this.q="",this.state=T.DOCTYPE);continue;case T.DOCTYPE_DTD:this.doctype+=r,"]"===r?this.state=T.DOCTYPE:f(r)&&(this.state=T.DOCTYPE_DTD_QUOTED,this.q=r);continue;case T.DOCTYPE_DTD_QUOTED:this.doctype+=r,r===this.q&&(this.state=T.DOCTYPE_DTD,this.q="");continue;case T.COMMENT:"-"===r?this.state=T.COMMENT_ENDING:this.comment+=r;continue;case T.COMMENT_ENDING:"-"===r?(this.state=T.COMMENT_ENDED,this.comment=N(this.opt,this.comment),this.comment&&_(this,"oncomment",this.comment),this.comment=""):(this.comment+="-"+r,this.state=T.COMMENT);continue;case T.COMMENT_ENDED:">"!==r?(C(this,"Malformed comment"),this.comment+="--"+r,this.state=T.COMMENT):this.state=T.TEXT;continue;case T.CDATA:"]"===r?this.state=T.CDATA_ENDING:this.cdata+=r;continue;case T.CDATA_ENDING:"]"===r?this.state=T.CDATA_ENDING_2:(this.cdata+="]"+r,this.state=T.CDATA);continue;case T.CDATA_ENDING_2:">"===r?(this.cdata&&_(this,"oncdata",this.cdata),_(this,"onclosecdata"),this.cdata="",this.state=T.TEXT):"]"===r?this.cdata+="]":(this.cdata+="]]"+r,this.state=T.CDATA);continue;case T.PROC_INST:"?"===r?this.state=T.PROC_INST_ENDING:d(r)?this.state=T.PROC_INST_BODY:this.procInstName+=r;continue;case T.PROC_INST_BODY:if(!this.procInstBody&&d(r))continue;"?"===r?this.state=T.PROC_INST_ENDING:this.procInstBody+=r;continue;case T.PROC_INST_ENDING:">"===r?(_(this,"onprocessinginstruction",{name:this.procInstName,body:this.procInstBody}),this.procInstName=this.procInstBody="",this.state=T.TEXT):(this.procInstBody+="?"+r,this.state=T.PROC_INST_BODY);continue;case T.OPEN_TAG:m(p,r)?this.tagName+=r:(P(this),">"===r?L(this):"/"===r?this.state=T.OPEN_TAG_SLASH:(d(r)||C(this,"Invalid character in tag name"),this.state=T.ATTRIB));continue;case T.OPEN_TAG_SLASH:">"===r?(L(this,!0),M(this)):(C(this,"Forward-slash in opening tag not followed by >"),this.state=T.ATTRIB);continue;case T.ATTRIB:if(d(r))continue;">"===r?L(this):"/"===r?this.state=T.OPEN_TAG_SLASH:m(c,r)?(this.attribName=r,this.attribValue="",this.state=T.ATTRIB_NAME):C(this,"Invalid attribute name");continue;case T.ATTRIB_NAME:"="===r?this.state=T.ATTRIB_VALUE:">"===r?(C(this,"Attribute without value"),this.attribValue=this.attribName,S(this),L(this)):d(r)?this.state=T.ATTRIB_NAME_SAW_WHITE:m(p,r)?this.attribName+=r:C(this,"Invalid attribute name");continue;case T.ATTRIB_NAME_SAW_WHITE:if("="===r)this.state=T.ATTRIB_VALUE;else{if(d(r))continue;C(this,"Attribute without value"),this.tag.attributes[this.attribName]="",this.attribValue="",_(this,"onattribute",{name:this.attribName,value:""}),this.attribName="",">"===r?L(this):m(c,r)?(this.attribName=r,this.state=T.ATTRIB_NAME):(C(this,"Invalid attribute name"),this.state=T.ATTRIB)}continue;case T.ATTRIB_VALUE:if(d(r))continue;f(r)?(this.q=r,this.state=T.ATTRIB_VALUE_QUOTED):(C(this,"Unquoted attribute value"),this.state=T.ATTRIB_VALUE_UNQUOTED,this.attribValue=r);continue;case T.ATTRIB_VALUE_QUOTED:if(r!==this.q){"&"===r?this.state=T.ATTRIB_VALUE_ENTITY_Q:this.attribValue+=r;continue}S(this),this.q="",this.state=T.ATTRIB_VALUE_CLOSED;continue;case T.ATTRIB_VALUE_CLOSED:d(r)?this.state=T.ATTRIB:">"===r?L(this):"/"===r?this.state=T.OPEN_TAG_SLASH:m(c,r)?(C(this,"No whitespace between attributes"),this.attribName=r,this.attribValue="",this.state=T.ATTRIB_NAME):C(this,"Invalid attribute name");continue;case T.ATTRIB_VALUE_UNQUOTED:if(!y(r)){"&"===r?this.state=T.ATTRIB_VALUE_ENTITY_U:this.attribValue+=r;continue}S(this),">"===r?L(this):this.state=T.ATTRIB;continue;case T.CLOSE_TAG:if(this.tagName)">"===r?M(this):m(p,r)?this.tagName+=r:this.script?(this.script+="</"+this.tagName,this.tagName="",this.state=T.SCRIPT):(d(r)||C(this,"Invalid tagname in closing tag"),this.state=T.CLOSE_TAG_SAW_WHITE);else{if(d(r))continue;g(c,r)?this.script?(this.script+="</"+r,this.state=T.SCRIPT):C(this,"Invalid tagname in closing tag."):this.tagName=r}continue;case T.CLOSE_TAG_SAW_WHITE:if(d(r))continue;">"===r?M(this):C(this,"Invalid characters in closing tag");continue;case T.TEXT_ENTITY:case T.ATTRIB_VALUE_ENTITY_Q:case T.ATTRIB_VALUE_ENTITY_U:var a,u;switch(this.state){case T.TEXT_ENTITY:a=T.TEXT,u="textNode";break;case T.ATTRIB_VALUE_ENTITY_Q:a=T.ATTRIB_VALUE_QUOTED,u="attribValue";break;case T.ATTRIB_VALUE_ENTITY_U:a=T.ATTRIB_VALUE_UNQUOTED,u="attribValue"}";"===r?(this[u]+=j(this),this.entity="",this.state=a):m(this.entity.length?l:h,r)?this.entity+=r:(C(this,"Invalid character in entity name"),this[u]+="&"+this.entity+r,this.entity="",this.state=a);continue;default:throw new Error(this,"Unknown state: "+this.state)}this.position>=this.bufferCheckPosition&&function(e){for(var n=Math.max(t.MAX_BUFFER_LENGTH,10),r=0,o=0,s=i.length;o<s;o++){var a=e[i[o]].length;if(a>n)switch(i[o]){case"textNode":x(e);break;case"cdata":_(e,"oncdata",e.cdata),e.cdata="";break;case"script":_(e,"onscript",e.script),e.script="";break;default:D(e,"Max buffer length exceeded: "+i[o])}r=Math.max(r,a)}var u=t.MAX_BUFFER_LENGTH-r;e.bufferCheckPosition=u+e.position}(this);return this}
/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var t;x(t=this),""!==t.cdata&&(_(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(_(t,"onscript",t.script),t.script="")}};try{e=n(78).Stream}catch(t){e=function(){}}var o=t.EVENTS.filter((function(t){return"error"!==t&&"end"!==t}));function s(t,n){if(!(this instanceof s))return new s(t,n);e.apply(this),this._parser=new r(t,n),this.writable=!0,this.readable=!0;var i=this;this._parser.onend=function(){i.emit("end")},this._parser.onerror=function(t){i.emit("error",t),i._parser.error=null},this._decoder=null,o.forEach((function(t){Object.defineProperty(i,"on"+t,{get:function(){return i._parser["on"+t]},set:function(e){if(!e)return i.removeAllListeners(t),i._parser["on"+t]=e,e;i.on(t,e)},enumerable:!0,configurable:!1})}))}s.prototype=Object.create(e.prototype,{constructor:{value:s}}),s.prototype.write=function(t){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(t)){if(!this._decoder){var e=n(79).StringDecoder;this._decoder=new e("utf8")}t=this._decoder.write(t)}return this._parser.write(t.toString()),this.emit("data",t),!0},s.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},s.prototype.on=function(t,n){var i=this;return i._parser["on"+t]||-1===o.indexOf(t)||(i._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),i.emit.apply(i,e)}),e.prototype.on.call(i,t,n)};var a="http://www.w3.org/XML/1998/namespace",u={xml:a,xmlns:"http://www.w3.org/2000/xmlns/"},c=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,h=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,l=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function d(t){return" "===t||"\n"===t||"\r"===t||"\t"===t}function f(t){return'"'===t||"'"===t}function y(t){return">"===t||d(t)}function m(t,e){return t.test(e)}function g(t,e){return!m(t,e)}var b,v,w,T=0;for(var E in t.STATE={BEGIN:T++,BEGIN_WHITESPACE:T++,TEXT:T++,TEXT_ENTITY:T++,OPEN_WAKA:T++,SGML_DECL:T++,SGML_DECL_QUOTED:T++,DOCTYPE:T++,DOCTYPE_QUOTED:T++,DOCTYPE_DTD:T++,DOCTYPE_DTD_QUOTED:T++,COMMENT_STARTING:T++,COMMENT:T++,COMMENT_ENDING:T++,COMMENT_ENDED:T++,CDATA:T++,CDATA_ENDING:T++,CDATA_ENDING_2:T++,PROC_INST:T++,PROC_INST_BODY:T++,PROC_INST_ENDING:T++,OPEN_TAG:T++,OPEN_TAG_SLASH:T++,ATTRIB:T++,ATTRIB_NAME:T++,ATTRIB_NAME_SAW_WHITE:T++,ATTRIB_VALUE:T++,ATTRIB_VALUE_QUOTED:T++,ATTRIB_VALUE_CLOSED:T++,ATTRIB_VALUE_UNQUOTED:T++,ATTRIB_VALUE_ENTITY_Q:T++,ATTRIB_VALUE_ENTITY_U:T++,CLOSE_TAG:T++,CLOSE_TAG_SAW_WHITE:T++,SCRIPT:T++,SCRIPT_ENDING:T++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach((function(e){var n=t.ENTITIES[e],i="number"==typeof n?String.fromCharCode(n):n;t.ENTITIES[e]=i})),t.STATE)t.STATE[t.STATE[E]]=E;function O(t,e,n){t[e]&&t[e](n)}function _(t,e,n){t.textNode&&x(t),O(t,e,n)}function x(t){t.textNode=N(t.opt,t.textNode),t.textNode&&O(t,"ontext",t.textNode),t.textNode=""}function N(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function D(t,e){return x(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,O(t,"onerror",e),t}function I(t){return t.sawRoot&&!t.closedRoot&&C(t,"Unclosed root tag"),t.state!==T.BEGIN&&t.state!==T.BEGIN_WHITESPACE&&t.state!==T.TEXT&&D(t,"Unexpected end"),x(t),t.c="",t.closed=!0,O(t,"onend"),r.call(t,t.strict,t.opt),t}function C(t,e){if("object"!=typeof t||!(t instanceof r))throw new Error("bad call to strictFail");t.strict&&D(t,e)}function P(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,n=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(n.ns=e.ns),t.attribList.length=0,_(t,"onopentagstart",n)}function A(t,e){var n=t.indexOf(":")<0?["",t]:t.split(":"),i=n[0],r=n[1];return e&&"xmlns"===t&&(i="xmlns",r=""),{prefix:i,local:r}}function S(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var e=A(t.attribName,!0),n=e.prefix,i=e.local;if("xmlns"===n)if("xml"===i&&t.attribValue!==a)C(t,"xml: prefix must be bound to "+a+"\nActual: "+t.attribValue);else if("xmlns"===i&&"http://www.w3.org/2000/xmlns/"!==t.attribValue)C(t,"xmlns: prefix must be bound to http://www.w3.org/2000/xmlns/\nActual: "+t.attribValue);else{var r=t.tag,o=t.tags[t.tags.length-1]||t;r.ns===o.ns&&(r.ns=Object.create(o.ns)),r.ns[i]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,_(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function L(t,e){if(t.opt.xmlns){var n=t.tag,i=A(t.tagName);n.prefix=i.prefix,n.local=i.local,n.uri=n.ns[i.prefix]||"",n.prefix&&!n.uri&&(C(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),n.uri=i.prefix);var r=t.tags[t.tags.length-1]||t;n.ns&&r.ns!==n.ns&&Object.keys(n.ns).forEach((function(e){_(t,"onopennamespace",{prefix:e,uri:n.ns[e]})}));for(var o=0,s=t.attribList.length;o<s;o++){var a=t.attribList[o],u=a[0],c=a[1],p=A(u,!0),h=p.prefix,l=p.local,d=""===h?"":n.ns[h]||"",f={name:u,value:c,prefix:h,local:l,uri:d};h&&"xmlns"!==h&&!d&&(C(t,"Unbound namespace prefix: "+JSON.stringify(h)),f.uri=h),t.tag.attributes[u]=f,_(t,"onattribute",f)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),_(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=T.TEXT:t.state=T.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function M(t){if(!t.tagName)return C(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=T.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=T.SCRIPT);_(t,"onscript",t.script),t.script=""}var e=t.tags.length,n=t.tagName;t.strict||(n=n[t.looseCase]());for(var i=n;e--;){if(t.tags[e].name===i)break;C(t,"Unexpected close tag")}if(e<0)return C(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=T.TEXT);t.tagName=n;for(var r=t.tags.length;r-- >e;){var o=t.tag=t.tags.pop();t.tagName=t.tag.name,_(t,"onclosetag",t.tagName);var s={};for(var a in o.ns)s[a]=o.ns[a];var u=t.tags[t.tags.length-1]||t;t.opt.xmlns&&o.ns!==u.ns&&Object.keys(o.ns).forEach((function(e){var n=o.ns[e];_(t,"onclosenamespace",{prefix:e,uri:n})}))}0===e&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=T.TEXT}function j(t){var e,n=t.entity,i=n.toLowerCase(),r="";return t.ENTITIES[n]?t.ENTITIES[n]:t.ENTITIES[i]?t.ENTITIES[i]:("#"===(n=i).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),r=(e=parseInt(n,16)).toString(16)):(n=n.slice(1),r=(e=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),isNaN(e)||r.toLowerCase()!==n?(C(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(e))}function R(t,e){"<"===e?(t.state=T.OPEN_WAKA,t.startTagPosition=t.position):d(e)||(C(t,"Non-whitespace before first tag."),t.textNode=e,t.state=T.TEXT)}function B(t,e){var n="";return e<t.length&&(n=t.charAt(e)),n}T=t.STATE,String.fromCodePoint||(b=String.fromCharCode,v=Math.floor,w=function(){var t,e,n=16384,i=[],r=-1,o=arguments.length;if(!o)return"";for(var s="";++r<o;){var a=Number(arguments[r]);if(!isFinite(a)||a<0||a>1114111||v(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?i.push(a):(t=55296+((a-=65536)>>10),e=a%1024+56320,i.push(t,e)),(r+1===o||i.length>n)&&(s+=b.apply(null,i),i.length=0)}return s},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:w,configurable:!0,writable:!0}):String.fromCodePoint=w)}(e)},function(t,e){t.exports=require("stream")},function(t,e){t.exports=require("string_decoder")},function(t,e){t.exports=require("events")},function(t,e){(function(){"use strict";e.stripBOM=function(t){return"\ufeff"===t[0]?t.substring(1):t}}).call(this)},function(t,e){t.exports=require("timers")},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.FormWindow=e.DialogWindow=void 0;var o=n(0),s=n(84),a=n(9),u=function(t){function e(e){var n=t.call(this,e)||this;return n.contentHTML=n.win.querySelector("div>h5"),n}return r(e,t),e.prototype.showDialog=function(t,e,n){return this.promise(t,(function(){this.contentHTML.innerText=e}),n)},e.prototype.showMessage=function(t,e){return this.showDialog(t,e,["OK"]).then((function(t){return Promise.resolve()})).catch((function(t){return Promise.resolve()}))},e.prototype.propertyDefaults=function(){return o.extend(t.prototype.propertyDefaults.call(this),{class:"win dialog box no-select hide",templateName:"dialogWin01"})},e}(s.default);e.DialogWindow=u;var c=function(t){function e(e){var n=t.call(this,e)||this;return n.contentHTML=n.win.querySelector("div>form>fieldset"),n}return r(e,t),e.prototype.showDialog=function(t,e){return this.promise(t,(function(){this.contentHTML.innerHTML=e.map((function(t,e){var n=o.clone(t);return!n.placeHolder&&(n.placeHolder=n.label),n.index=e,n.class=t.visible?"":"hide",a.Templates.nano(t.readonly?"formFieldWinSpan":"formFieldWinInput",n)})).join("")}),["Save","Cancel"],(function(t){return 0!=t||!Array.from(this.contentHTML.querySelectorAll("div>input")).filter((function(t){var n,i,r=parseInt(t.getAttribute("index")),s=e[r];if(s&&!s.readonly&&(n=s.value=t.value,i=r,o.empty(n)&&e[i].required))return t.nextElementSibling.innerText="required",o.removeClass(t.nextElementSibling,"hide"),!0;t.nextElementSibling.innerText="*",o.addClass(t.nextElementSibling,"hide")})).length}))},e.prototype.propertyDefaults=function(){return o.extend(t.prototype.propertyDefaults.call(this),{class:"win dialog form no-select hide",templateName:"formWin01"})},e}(s.default);e.FormWindow=c},function(t,e,n){"use strict";var i,r=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(38),s=n(0),a=function(t){function e(e){var n=t.call(this,e)||this;return n.titleHTML=n.win.querySelector("div>h4"),n.buttonsHTML=n.win.querySelector("div>div>div"),n}return r(e,t),e.prototype.promise=function(t,e,n,i){var r=this;return new Promise((function(o,a){var u=-1,c=function(){document.removeEventListener("keydown",h,!1),s.rEL(r.buttonsHTML,"click",p,!1),r.setVisible(!1),s.addClass(r.win,"hide")},p=function(t){var e=parseInt(t.target.getAttribute("dialog-option"));isNaN(e)||i&&!i.call(r,e)||(c(),o(e))},h=function(t){"Escape"==t.code&&(c(),o(u))};r.titleHTML.innerText=t,e.call(r),r.buttonsHTML.innerHTML=n.map((function(t,e){return"CANCEL"==t.toUpperCase()&&(u=e),'<button dialog-option="'+e+'">'+t+"</button>"})).join(""),document.addEventListener("keydown",h,!1),s.aEL(r.buttonsHTML,"click",p,!1),r.setVisible(!0),s.removeClass(r.win,"hide")}))},e}(o.default);e.default=a},function(t,e,n){},function(t,e,n){},function(t,e,n){}]);